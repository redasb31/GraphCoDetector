

<h1>Problem G: Sports Days</h1>
<p>
会津大学附属小学校（会津大小）は日本有数の競技プログラマー養成校として有名である。
もちろん、運動会に参加しているときでさえアルゴリズムの修行を欠かせない。
</p>
<p>
競技プログラミング部部長のあなたはもちろんこの大会でも勝利したい。
今回はある競技に注目する。
</p>
<p>
ある競技とは会津大小で行われている伝統的な競技だ。
校庭にコーンがn個置いてある。
コーンは4色用意されている。
コーンのいくつかのペアは白線で描かれた矢印で結ばれている。
矢印は片側だけについており、整数が併記されている。
</p>
<p>
競技者はk人1チームとして行動する。
あるスタート地点のコーンからゴール地点のコーンまで矢印の上をその向きに移動する。
ただし、k人それぞれがゴール地点までの経路は異なる必要がある。
</p>
<p>
経路1と経路2が異なるというのは、
</p>
<ul>
<li>条件1　経路1と経路2で経由する矢印の本数が等しい場合、経路1でi番目に経由する矢印と経路2でi番目に経由する矢印が異なるようなiが存在すること。</li>
<li>条件2　経路1と経路2で経由する矢印の本数が異なっていること。</li>
</ul>
<p>
のいずれかを満たせば経路が異なっていると言える。
</p>
<p>
さらに、コーンの辿り方には禁止された色のパターンがあり、スタート地点からゴール地点までの経路でそのパターンを含んでしまった選手はリタイアとなる。
ただし、それ以外の経路はどのような経路を辿ってもよく、何度も同じコーン（スタート地点やゴール地点のコーンを含む）を通って良い。
また、矢印に併記された数字がスコアとして加算されていく。
この競技はより多くのチームメイトがより小さな合計スコアでゴール地点のコーンに辿りつけたチームが勝利となる。
</p>
<p>
部長のあなたはもちろんプログラミングでこの問題を解決できるはずだ。
ゴールまで移動可能な最大の人数を求めよ。
また、最大人数で辿り着いた時の最小スコアを求めよ。
</p>
<p>
ただし、いくらでもスコアを小さく出来る場合は -1 を出力せよ。
</p>
<h2>Input</h2>
<p>
入力は複数のテストケースから成り立っている。
テストケースの数は20ケースを超えない。
</p>
<pre>
n
col<sub>1</sub>
col<sub>2</sub>
...
col<sub>n</sub>
m
a<sub>1</sub> b<sub>1</sub> c<sub>1</sub>
a<sub>2</sub> b<sub>2</sub> c<sub>2</sub>
...
a<sub>m</sub> b<sub>m</sub> c<sub>m</sub>
k
pattern
</pre>
<p>
n( 2 &le; n &le; 100)はコーンの数を表す。
col<sub>i</sub>(1 &le; col<sub>i</sub> &le; 4)はi番目のコーンの色を示す。
m(0 &le; m &le; 1,000) は矢印の数を表す。
a<sub>i</sub> は矢印の始点のコーンの番号, b<sub>i</sub>は終点のコーンの番号を表し、c<sub>i</sub>はその矢印のスコアを表す.
また、ひとつのコーンから伸びる矢印は10本までである。
(1 &le; a<sub>i</sub>, b<sub>i</sub> &le; n, -1,000 &le; c<sub>i</sub> &le; 1,000)
kは競技を行うチームの人数を示す。
(1 &le; k &le; 10)
pattern
は長さが10以下の1~4までの数字からなる文字列で、
移動が禁止されているパターンを示す。
スタート地点のコーンは1番目のコーンであり、
n番目のコーンがゴールである。
入力で与えられる数(n, col, m, a, b, c, k)はすべて整数である。
入力の終わりは0を含む1行で示される。
</p>

<h2>Output</h2>
<p>
出力は空白で区切られた二つの整数からなる。
1つ目は到達できる人数で、2つ目はその最小コストである。
もし、いくらでもスコアを小さく出来る場合は-1のみを含む１行を出力せよ。
一人も到達できない場合は0 0を出力せよ。
</p>

<h2>Sample Input</h2>
<pre>
2
1
1
2
1 2 1
2 1 1
1
1111
2
1
1
2
1 2 1
2 1 1
1
11
2
1
1
2
1 2 1
2 1 1
10
1111
2
1
1
2
1 2 1
2 1 1
10
111111
2
1
1
2
1 2 -1
2 1 0
10
11
2
1
1
2
1 2 -1
2 1 0
10
1111
2
1
1
2
1 2 -1
2 1 0
10
12
2
1
1
2
1 2 -1
2 1 0
10
1111111111
0
</pre>

<h2>Sample Output</h2>
<pre>
1 1
0 0
1 1
2 4
0 0
1 -1
-1
4 -10
</pre>