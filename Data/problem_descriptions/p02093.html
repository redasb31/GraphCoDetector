
<h2>F: Invariant Tree</h2>

<h3>Problem Statement</h3>
<p>You have a permutation <var>p_1, p_2, ... , p_N</var> of integers from <var>1</var> to <var>N</var>. You also have vertices numbered <var>1</var> through <var>N</var>. Find the number of trees while satisfying the following condition. Here, two trees <var>T</var> and <var>T'</var> are different if and only if there is a pair of vertices where <var>T</var> has an edge between them but <var>Tâ€™</var> does not have an edge between them.</p>

<ul>
<li> For all integer pairs <var>i, j</var> (<var>1\leq i &lt; j \leq N</var>), if there is an edge between vertices <var>i</var> and <var>j</var>, there is an edge between vertices <var>p_i</var> and <var>p_j</var> as well.</li>
</ul>

<p>Since this number can be extremely large, output the number modulo <var>998244353</var>.</p>

<h3>Input</h3>
<pre>
<var>N</var>
<var>p_1</var> <var>p_2</var> <var>...</var> <var>p_N</var> 
</pre>

<h3>Constraints</h3>
<ul>
<li> <var>1\leq N \leq 3 \times 10^5</var></li>
<li> <var>p_1, p_2, ... , p_N</var> is a permutation of integers <var>1</var> through <var>N</var>.</li>
</ul>

<h3>Output</h3>
<p>Output the number in a single line.</p>

<h3>Sample Input 1</h3>
<pre>
4
2 1 4 3
</pre>

<h3>Output for Sample Input 1</h3>
<pre>4</pre>

<p>Let <var>(u, v)</var> denote that there is an edge between <var>u</var> and <var>v</var>. The following <var>4</var> ways can make a tree satisfying the condition.</p>
<ul>
<li> (<var>1, 2</var>), (<var>1, 3</var>), (<var>2, 4</var>)</li>
<li> (<var>1, 2</var>), (<var>1, 4</var>), (<var>2, 3</var>)</li>
<li> (<var>1, 3</var>), (<var>2, 4</var>), (<var>3, 4</var>)</li>
<li> (<var>1, 4</var>), (<var>2, 3</var>), (<var>3, 4</var>)</li>
</ul>

<h3>Sample Input 2</h3>
<pre>
3
1 2 3
</pre>

<h3>Output for Sample Input 2</h3>
<pre>3</pre>

<h3>Sample Input 3</h3>
<pre>
3
2 3 1
</pre>

<h3>Output for Sample Input 3</h3>
<pre>0</pre>

<h3>Sample Input 4</h3>
<pre>
20
9 2 15 16 5 13 11 18 1 10 7 3 6 14 12 4 20 19 8 17
</pre>

<h3>Output for Sample Input 4</h3>
<pre>98344960</pre>
