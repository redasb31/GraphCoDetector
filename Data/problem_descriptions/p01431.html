

<script type="text/javascript" src="./varmath.js" charset="UTF-8"></script>
<h2>問題文</h2>
<p>
落書きの魔女 ALBERTINE は <var>W</var> 列 <var>H</var> 行の正方形のセルからなる長方形の結界の入り口に落書きをしている．この世界では落書きは必ずセルを白色か黒色で塗ることによって成り立つ．
</p>
<p>
すでに使い魔 ANJA の手によって落書きの一部が描かれているのだが，落書きの魔女は残りすべてのセルを塗り落書きを完成させたい．落書きの魔女にはあるこだわりがある．そのこだわりとは次のようなものである．
</p>
<ul>
<li><var>2</var> つの異なるセルが辺を共有するとき，<var>2</var> つのセルは隣接していると呼ぶことにする．完成された落書きにおいては，任意の <var>2</var> つの黒いセルについて，片方からもう片方への隣接した黒いセルをたどるパスがちょうど <var>1</var> つだけ存在していなければならない．</li>
<li>どの <var>2</var> つの白色のセルも隣接してはならない．</li>
</ul>
<p>
また，落書きの魔女は黒色が好きなので，こだわりを満たした状態でなおかつ最も黒色のセルが多い落書きを完成させたい．果たして落書きの魔女は最大で何個のセルが黒色に塗られたこだわりの落書きを描くことができるだろうか．
</p>
<h2>入力形式</h2>
<p>
入力は以下の形式で与えられる．
</p>
<pre><var>
H\ W\\
c_{11} c_{12} ... c_{1W}\\
c_{21} c_{22} ... c_{2W}\\
...\\
c_{H1} c_{H2} ... c_{HW}\\
</var></pre>
<p>
<var>H</var> は結界の入り口の縦幅，<var>W</var> は結界の入り口の横幅を表す．
<p>
<var>c_{ij}</var> は各セルの状態を表す文字であり，上から <var>i</var> 行目，左から <var>j</var> 列目のセルの状態を表す．セルに黒色が塗られている場合は <var>c_{ij}</var> は <code>'#'</code> となり，白色が塗られている場合は <code>'.'</code>，まだ色が塗られていない場合はそうでない場合は <code>'?'</code> となる．
</p>
<h2>出力形式</h2>
<p>
魔女のこだわりを満たした状態でとりうる黒色のセルの個数の最大値を <var>1</var> 行で出力せよ．
</p>
<p>
もしどのように塗っても魔女のこだわりを満たすように出来ない場合，<code>-1</code> と出力せよ．
</p>
<h2>制約</h2>
<ul>
<li><var>1 &le; H &le; 11</var></li>
<li><var>1 &le; W &le; 11</var></li>
<li><var>c_{ij}</var> は <code>'#'</code>, <code>'.'</code>, <code>'?'</code> のいずれかである．</li>
</ul>

<h2>入出力例</h2>
<h3>入力例 1</h3>
<pre>3 4
.##.
#??#
.#?#</pre>

<h3>出力例1</h3>
<pre>8</pre>

<h3>入力例 2</h3>
<pre>5 5
##?##
#???#
?????
#???#
##?##</pre>

<h3>出力例 2</h3>
<pre>19</pre>

<h3>入力例 3</h3>
<pre>9 2
##
..
??
??
??
??
??
??
??</pre>

<h3>出力例 3</h3>
<pre>-1</pre>

<h3>入力例 4</h3>
<pre>7 9
??#####??
?#?????#?
?#?????#?
?#??#??#?
?#???#?#?
??#####??
???????#?</pre>

<h3>出力例 4</h3>
<pre>44</pre>

<h3>入力例 5</h3>
<pre>11 11
???????????
???####????
???#???#???
???#???#???
???#???#???
???####????
???#???#???
???#???#???
???#???#???
???####????
???????????</pre>

<h3>出力例 5</h3>
<pre>86</pre>

<hr>
<address>Problem Setter: Flat35</address>