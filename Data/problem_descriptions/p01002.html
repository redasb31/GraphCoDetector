


<h1>Problem D: Smartphone Game</h1>
<h2>Problem</h2>

<p>
人気のスマフォゲームの一機能を実装してみよう。ゲームは以下の仕様に基づく。
</p>

<ul>
<li>5*5のマスに、5種類のブロックが設置されている。</li>
<li>それぞれの種類のブロックには得点が設定されている。</li>
<li>得点には、ブロックの得点の他に、ボーナス得点が設定されている。最初のボーナス得点は1である。</li>
<li>ブロックを任意に1つだけ決めて、最大で<var> n </var>回まで上下左右に移動できる。移動先のブロックは移動元のブロックのあった場所に移動する。つまり、隣接したブロックを交換する事になる。</li>
<li>移動した後、同じ種類のブロックが縦3個以上又は横3個以上に並んだ場合、並んだブロックは全て消える。</li>
<li>消えるべきブロックが全て消えた後、あるブロックの下に別のブロックが存在しない場合、そのブロックは落下する。落下とは、あるブロックの１つ上に辿り着くまで下に移動する事をいう。ブロックが下に存在しない場合は一番下に移動する。</li>
<li>全てのブロックの落下後にボーナス得点が1だけ加算される。</li>
<li>その後にブロックが並んだ場合、さらに消え、落下する。</li>
<li>ブロックが消える時に、ブロック１つにつき「ブロックの得点*ボーナス得点」が自分の得点に加算される。</li>
</ul>
<p>１回のプレイで得られる最大の点数を求めよ。</p>


<h2>Input</h2>
<p>
入力は複数のデータセットからなる。<br>
各データセットは以下で表される。<br>
</p>

<pre>
<var>n</var>
<var>a<sub>11</sub></var> .. <var>a<sub>15</sub></var>
.
.
<var>a<sub>51</sub></var> .. <var>a<sub>55</sub></var>
<var>score<sub>1</sub></var> .. <var>score<sub>5</sub></var>
</pre>

<p>
<var>a<sub>ij</sub></var>は1から5までの数字で、ブロックの種類を表す。<br>
<var>score<sub>i</sub></var>は<var> i </var>種類目のブロック１つ分の得点を表す。<br>
<var>n</var> = -1 の時、入力が終了する。<br>
</p>


<h2>Constraints</h2>
<p>入力は以下の条件を満たす。</p>
<ul>
<li>0 &le; <var>n</var> &le; 5</li>
<li>1 &le; <var>a<sub>ij</sub></var> &le; 5</li>
<li>0 &le; <var>score<sub>i</sub></var> &le; 100</li>
<li>テストケースの数は 10 を超えない。</li>
<li>入力に含まれる値は全て整数である。</li>
</ul>

<h2>Output</h2>
<p>各データセット毎に、答えを一行に出力しなさい。</p>


<h2>Sample Input</h2>
<pre>
0
1 1 1 5 5
5 5 5 5 5
5 5 1 5 5
5 1 1 1 5
5 5 5 5 5
0 0 0 0 1
2
1 2 3 4 5
2 3 4 5 5
2 3 4 5 5
3 4 5 5 1
5 4 3 2 1
100 99 98 97 96
5
1 2 3 4 5
2 3 4 5 1
1 2 3 4 5
5 4 3 2 1
1 2 3 4 5
99 79 31 23 56
-1
</pre>

<h2>Sample Output</h2>
<pre>
17
2040
926
</pre>