



<h1>Problem B: Independent Research</h1>
<h2>Problem</h2>
<!--
<p>
長期休暇の課題とは、長期休暇を使ってこれまでの勉強の復習をさせる<del>ことを建て前に、計画倒れがいかにして発生するかを生徒に体験させる</del>ため、長期休暇に課される試練のことである。
その中でも、自由研究とは、長期休暇の課題の中でも最も過酷な課題である。
「自由研究」と言う名に反して強制である場合が多く、研究しないという選択肢は存在しない。
絵、工作、生き物観察など、様々な分野の課題があり、とりあえず僕は、生き物観察を自由研究のテーマとした。
</p>
-->

<p>
僕は夏休みの自由研究のテーマとして、生き物観察を選択し、生き物観察キットを購入した。
</p>

<p>
この生き物は3次元グリッド状の空間を好んで生息する。
各セルには最大1匹までしか入れない。
周囲の環境に合わせ1日が経過するごとに誕生と死滅を繰り返す。
<!--誕生と死滅の条件は飼育箱によって異なるらしいが、それはセルに隣接する生き物の数に依存する。-->
誕生と死滅の条件は、セルに隣接する生き物の数に依存する。
ここで、あるセルに生き物が隣接するとは、あるセルと生き物が生息しているもう一つのセルが面、辺、または点を共有していることを言う。
誕生と死滅のルールは次のようになる。
</p>

<ul>

<li>
生き物が生息していないセルにおいて、隣接する生き物の数が
<var> a<sub>i</sub> </var>(1 &le;<var> i </var>&le;<var> M<sub>1</sub> </var>) 匹であるような
<var> i </var>がある場合、そのセルに生き物が誕生する。
</li>

<li>
生き物が生息しているセルにおいて、隣接する生き物の数が
<var> b<sub>j</sub> </var>(1 &le;<var> j </var>&le;<var> M<sub>2</sub> </var>) 匹であるような
<var> j </var>がない場合、そのセルの生き物は死滅する。
</li>

</ul>

<p>
今回購入した飼育箱はセルの数が5*5*5である立方体の飼育箱だ。
この飼育箱ではこの生き物はどのような振る舞いをするのだろうか…？　とても楽しみである。
</p>

<p>
〜数日後〜
</p>

<p>
とりあえず、飼育してみたが…　

毎日観察するなんて時間がかかるし、僕にはめんどくさくてやる気がおきない。

そうだ、コンピューターとプログラムを使ってシミュレートしよう。
</p>

<h2>Input</h2>
<p>
入力は複数のデータセットからなる。
各データセットは以下のフォーマットで与えられる。
</p>

<pre>
<var>N</var>
(<var>z</var> = 0 の飼育箱の状態)
(空行)
(<var>z</var> = 1 の飼育箱の状態)
(空行)
(<var>z</var> = 2 の飼育箱の状態)
(空行)
(<var>z</var> = 3 の飼育箱の状態)
(空行)
(<var>z</var> = 4 の飼育箱の状態)
(空行)
<var>M<sub>1</sub></var> <var>a<sub>1</sub></var> <var>a<sub>2</sub></var> …　<var>a<sub>M<sub>1</sub></sub></var>
<var>M<sub>2</sub></var> <var>b<sub>1</sub></var> <var>b<sub>2</sub></var> …　<var>b<sub>M<sub>2</sub></sub></var>
</pre>
<p>
最初にシミュレートする日数<var> N </var>が与えられる。</br>
</br>
次に飼育箱の初期状態の情報が与えられる。これは5つの5*5の2次元グリッドで与えられる。</br>
各2次元グリッドは0と1から成り立ち、1は生き物がいることを示し、0は何もいないことを示す。</br>
例えば、<var> z </var> = 0のセルの状態の2次元グリッドの4行2列目の値が1だった場合、飼育箱の座標(1, 3, 0)の位置に生き物がいることを表す。<br>
</br>
次に、整数<var> M<sub>1</sub> </var>が与えられ、そのあとに<var> M<sub>1</sub> </var>個の数字<var> a<sub>i</sub> </var>が与えられる。<br>
次に、整数<var> M<sub>2</sub> </var>が与えられ、そのあとに<var> M<sub>2</sub> </var>個の数字<var> b<sub>j</sub> </var>が与えられる。<br>
<br>
入力の終わりは<var> N </var>= 0で表される。</br>
</p>


<h2>Constraints</h2>
<p>入力は以下の条件を満たす。</p>
<ul>
<li>1 &le;<var> N </var> &le; 100</li>
<!--
<li>1 &le;<var> x,y,z </var> &le; 5</li>
<li>0 &le;<var> grid(x,y,z) </var> &le; 1</li>
-->
<li>0 &le;<var> M<sub>1</sub> </var>,<var> M<sub>2</sub> </var> &le; 27</li>
<li>0 &le;<var> a<sub>i</sub> </var>,<var> b<sub>j</sub> </var> &le; 26 
(1 &le;<var> i </var>&le;<var> M<sub>1</sub> </var>, 1 &le;<var> j </var>&le;<var> M<sub>2</sub> </var>)</li>
<li>任意の<var> i </var>,<var> j </var>(1 &le;<var> i </var>&lt;<var> j </var>&le;<var> M<sub>1</sub> </var>) 
において、<var> a<sub>i</sub> </var>&ne;<var> a<sub>j</sub> </var></li>
<li>任意の<var> i </var>,<var> j </var>(1 &le;<var> i </var>&lt;<var> j </var>&le;<var> M<sub>2</sub> </var>) 
において、<var> b<sub>i</sub> </var>&ne;<var> b<sub>j</sub> </var></li>

</ul>


<h2>Output</h2>
<p>
各データセットに対し、<var> N </var>日経過後の状態を出力せよ。<br>
出力は以下のフォーマットに従う。
</p>
<pre>
Case (テストケースの番号):
(<var>z</var> = 0 の飼育箱の状態)
(空行)
(<var>z</var> = 1 の飼育箱の状態)
(空行)
(<var>z</var> = 2 の飼育箱の状態)
(空行)
(<var>z</var> = 3 の飼育箱の状態)
(空行)
(<var>z</var> = 4 の飼育箱の状態)
</pre>
<p>
1行目にテストケース番号を出力し、次の行から<var> N </var>日経過後の状態として、5*5の2次元グリッドを5つ出力せよ。</br>
各テストケースの出力間には空行を出力しなさい。</br>
</p>

<h2>Sample Input</h2>
<pre>
5
00000
01010
00000
00100
00000

00000
01010
00000
01010
00000

00000
00100
00000
01010
00000

00000
01010
00000
00100
00000

00000
00000
00100
00000
00000

1 2
2 3 4
4
01110
00100
00100
00100
01110

01110
10001
10000
10001
01110

11111
10001
11111
10000
10000

01110
10001
10000
10001
01110

00000
00000
00000
00000
00000

2 3 4
1 2
100
00100
01010
01110
10001
10001

01110
00100
00100
00100
01110

00000
00000
00000
00000
00000

11111
00010
00100
01000
11111

10001
10001
10001
10001
01110

5 1 3 5 7 9
5 0 2 4 6 8
0
</pre>
<h2>Sample Output</h2>
<pre>
Case 1:
00000
00000
01010
01110
10101

00000
10001
00000
00000
00000

00000
00000
11111
10001
00000

00000
00000
00000
00000
01010

00000
00000
01110
00100
11111

Case 2:
00010
10110
00000
11000
10000

00001
00000
10101
00010
00100

10001
00000
00000
00000
00010

01110
10001
00000
00001
10000

00000
00000
00111
01001
01000

Case 3:
00000
00000
00000
00000
00000

00000
00000
00000
00000
00000

00000
00000
00000
00000
00000

00000
00000
00000
00000
00000

00000
00000
00000
00000
00000
</pre>