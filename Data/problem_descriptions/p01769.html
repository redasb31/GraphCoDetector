


<h1 id="d-hopping-hearts-こころぴょんぴょん">D : Hopping Hearts / こころぴょんぴょん</h1>
<h2 id="問題文">問題文</h2>
<p><var>N</var> 羽のうさぎが長さ <var>L&minus;1</var> の平均台の上にいる。 <var>i</var> 番目のうさぎの初期位置は整数 <var>x_i</var>であり、 <var>0 &le; x_{i} \lt x_{i+1} &le; L&minus;1</var> を満たす。座標は右に進むほど大きくなる。任意の <var>i</var> 番目のうさぎは、任意の回数だけ、ちょうど距離 <var>a_i</var> だけ右方向にジャンプ(すなわち、<var>x_i</var> から <var>x_i+a_i</var> へ移動)することができる。ただし別のうさぎを飛び越えること、<var>&minus;1</var> 以下または <var>L</var> 以上の位置に入ることはできない。また、同時にジャンプしていられるのは高々 <var>1</var> 羽であり、ある座標に存在できるうさぎの数も高々 </var>1</var> 羽である。</p>
<p>初期状態から始めてジャンプを任意の回数繰り返したあとの <var>x_{0}, …, x_{N&minus;1}</var> の状態として、あり得るものは何通りあるか。<var>1\,000\,000\,007</var> で割った余りで求めよ。</p>
<h2 id="入力">入力</h2>
<p>入力は以下の形式で与えられる。</p>
<pre><var>N</var> <var>L</var>
<var>x_{0}</var> <var>…</var> <var>x_{N&minus;1}</var>
<var>a_{0}</var> <var>…</var> <var>a_{N&minus;1}</var>
</pre>

<h2 id="制約">制約</h2>
<ul>
<li>入力はすべて整数である</li>
<li><var>1 \&le; N \&le; 5\,000</var></li>
<li><var>N \&le; L \&le; 5\,000</var></li>
<li><var>0 \&le; x_{i} \lt x_{i+1} \&le; L&minus;1</var></li>
<li><var>0 \&le; a_{i} \&le; L&minus;1</var></li>
</ul>
<h2 id="出力">出力</h2>
<p>答えを1行で出力せよ。</p>
<h2 id="サンプル">サンプル</h2>
<h3 id="サンプル入力1">サンプル入力1</h3>
<pre>1 3
0
1
</pre>

<h3 id="サンプル出力1">サンプル出力1</h3>
<pre>3
</pre>

<p>1/0でうさぎがいる/いないを表現すれば、100, 010, 001 の <var>3</var> 通りである。</p>
<h3 id="サンプル入力2">サンプル入力2</h3>
<pre>2 4
0 1
1 2
</pre>

<h3 id="サンプル出力2">サンプル出力2</h3>
<pre>4
</pre>

<p>1100, 1001, 0101, 0011 の <var>4</var> 通りである。</p>
<h3 id="サンプル入力3">サンプル入力3</h3>
<pre>10 50
0 1 2 3 4 5 6 7 8 9
1 1 1 1 1 1 1 1 1 1
</pre>

<h3 id="サンプル出力3">サンプル出力3</h3>
<pre>272278100
</pre>

<p>二項係数 <var>C(50,10) = 10\,272\,278\,170</var> であり、それを <var>1\,000\,000\,007</var> で割ったあまりは <var>272\,278\,100</var> である。</p>
