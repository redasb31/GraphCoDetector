<h1>毒蛇の脱走(Snake Escaping)</h1>

<p>
  JOI 研究所では<var>2^L</var> 匹の毒蛇を飼っており，それぞれ<var>0, 1, ..., 2^L - 1</var> の番号が付けられている．すべての毒蛇は頭から順に<var>L</var> 個の部分に分かれており，それぞれの部分は青または赤である．毒蛇<var>i</var> に対し，<var>i</var> を2進表記して<var>i =</var> $\sum_{k=1}^{L}$<var> c_k2^{L-k} (0 \leq c_k \leq 1)</var> とおいたとき，
</p>
<ul>
<li> <var>c_k = 0</var> であれば，毒蛇<var>i</var> の頭から数えて<var>k</var> 番目の部分は青であり，</li>
<li> <var>c_k = 1</var> であれば，毒蛇<var>i</var> の頭から数えて<var>k</var> 番目の部分は赤である．</li>
</ul>
<p>
各毒蛇には毒性と呼ばれる0 以上9 以下の整数値が定まっている．<span>0</span>, <span>1</span>, <span>2</span>, <span>3</span>, <span>4</span>, <span>5</span>, <span>6</span>, <span>7</span>, <span>8</span>, <span>9</span> からなる長さ<var>2^L</var> の文字列<var>S</var> が与えられ，その<var>i</var> 文字目(<var>1 \leq i \leq 2^L</var>) は毒蛇<var>i - 1</var> の毒性を表す．
</p>

<p>
  毒蛇たちの動きは素早いので，JOI 研究所からは，よく毒蛇たちが脱走してしまう．JOI 研究所には脱走した毒蛇を目撃した周辺住民から苦情が寄せられる．
</p>

<p>
  あなたには，<var>Q</var> 日間にわたる苦情の情報が与えられる．<var>d</var> 日目(<var>1 \leq d \leq Q</var>) に寄せられた苦情は， <span>0</span>, <span>1</span>, <span>?</span>からなる長さ<var>L</var> の文字列<var>T_d</var> として表され，
</p>

<ul>
<li> <var>T_d</var> の<var>j</var> 文字目(<var>1 \leq j \leq L</var>) が<span>0</span> の場合は，<var>d</var> 日目に脱走したすべての毒蛇の頭から数えて<var>j</var> 番目の部分が青であることを表し，</li>
<li> <var>T_d</var> の<var>j</var> 文字目(<var>1 \leq j \leq L</var>) が<span>1</span> の場合は，<var>d</var> 日目に脱走したすべての毒蛇の頭から数えて<var>j</var> 番目の部分が赤であることを表し，</li>
<li> <var>T_d</var> の<var>j</var> 文字目(<var>1 \leq j \leq L</var>) が<span>?</span> の場合は，<var>d</var> 日目に脱走した毒蛇の頭から数えて<var>j</var> 番目の部分については，周辺住民からは情報が与えられなかったことを表す．</li>
</ul>

<p>
  苦情はすべて正確な情報である．脱走した毒蛇はJOI 研究所の職員がその日のうちに捕獲する．捕獲された毒蛇が，翌日以降に再び脱走することはあり得る．
</p>

<p>
  毒蛇の脱走によるリスクを見積もるために，JOI 研究所のK 理事長は脱走した可能性のある毒蛇の毒性の合計を知りたい．あなたの仕事は，<var>Q</var> 日間にわたる苦情の情報から，それぞれの日ごとに，その日に脱走した可能性のある毒蛇の毒性の合計を求めるプログラムを作成することである．
</p>


<h3>課題</h3>

<p>
  毒蛇の毒性を表す文字列<var>S</var> と，<var>Q</var> 日間の苦情の情報が与えられるので，それぞれの日ごとに，その日に脱走した可能性のある毒蛇の毒性の合計を求めるプログラムを作成せよ．
</p>
<p>
  メモリ制限が小さいことに注意すること．
</p>


<h3>入力</h3>

<p>
  標準入力から以下の入力を読み込め．
</p>

<ul>
  <li> 1 行目には，整数<var>L, Q</var> が空白を区切りとして書かれている．これらは順に，毒蛇の部分の個数と，苦情の寄せられる日数を表す．
    </li>
  <li> 2 行目には，長さ<var>2^L</var> の文字列<var>S</var> が書かれている．この文字列は毒蛇の毒性を表す．</li>
  <li> 続く<var>Q</var> 行のうちの<var>d</var> 行目(<var>1 \leq d \leq Q</var>) には，長さ<var>L</var> の文字列<var>T_d</var> が書かれている．この文字列は<var>d</var> 日目の苦情を表す．</li>
  </ul>
    
<h3>出力</h3>
<p>
  標準出力に<var>Q</var> 行で出力せよ．<var>d</var> 行目には，<var>d</var> 日目に脱走した可能性のある毒蛇の毒性の合計を表す整数を出力せよ．
</p>


<h3>制限</h3>
<p>
  すべての入力データは以下の条件を満たす．
</p>
<ul>
<li><var> 1 \leq L \leq 20</var>．</li>
<li><var> 1 \leq Q \leq 1 000 000</var>．</li>
<li><var>S</var> は長さ<var>2^L</var> の文字列である．</li>
<li> 文字列<var>S</var> は<span>0</span>, <span>1</span>, <span>2</span>, <span>3</span>, <span>4</span>, <span>5</span>, <span>6</span>, <span>7</span>, <span>8</span>, <span>9</span> からなる．</li>
<li> <var>T_d</var> は長さ<var>L</var> の文字列である(<var>1 \leq d \leq Q</var>)．</li>
<li> 文字列<var>T_d</var> は<span>0</span>, <span>1</span>, <span>?</span> からなる(<var>1 \leq d \leq Q</var>)．</li>
</ul>

<!--
小課題
小課題1 [5 点]
以下の条件を満たす．
 L ≦ 10．
 Q ≦ 1 000．
小課題2 [7 点]
 L ≦ 10 を満たす．
小課題3 [10 点]
 L ≦ 13 を満たす．
小課題4 [53 点]
 Q ≦ 50 000 を満たす．
小課題5 [25 点]
 追加の制限はない．
  -->


<h3>入出力例</h3>
<h3>入力例1 </h3>
<pre>
3 5
12345678
000
0??
1?0
?11
???
</pre>
<h3>出力例1</h3>
<pre>
1
10
12
12
36
</pre>

<p>
  この入力例では，<var>L = 3</var> である．3 つの部分に分かれた毒蛇が，全部で<var>2^3 = 8</var> 匹いる．苦情は5 日間にわたって寄せられる．
</p>

<ul>
<li> 1 日目に脱走した可能性のある毒蛇は，毒蛇0 のみである．毒性の合計は1 である．</li>
<li> 2 日目に脱走した可能性のある毒蛇は，毒蛇0, 1, 2, 3 である．毒性の合計は10 である．</li>
<li> 3 日目に脱走した可能性のある毒蛇は，毒蛇4, 6 である．毒性の合計は12 である．</li>
<li> 4 日目に脱走した可能性のある毒蛇は，毒蛇3, 7 である．毒性の合計は12 である．</li>
<li> 5 日目に脱走した可能性のある毒蛇は，毒蛇0, 1, 2, 3, 4, 5, 6, 7 である．毒性の合計は36 である．</li>
</ul>


<h3>入力例2</h3>
<pre>
4 8
3141592653589793
0101
?01?
??1?
?0??
1?00
01?1
??10
????
</pre>
<h3>出力例2</h3>
<pre>
9
18
38
30
14
15
20
80
</pre>


<br/>
<p>
  <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/"><img alt="クリエイティブ・コモンズ・ライセンス" style="border-width:0" src="https://i.creativecommons.org/l/by-sa/4.0/80x15.png"/></a>
  <br/>
  
  <a href="https://www.ioi-jp.org/joi/2017/2018-ho/index.html">情報オリンピック日本委員会作 『第17 回日本情報オリンピック(JOI 2017/2018) 本選』</a>
</p>

