


<h1>Lucky Number</h1>

<h2>Problem</h2>
<p>
0 から <var>N</var>-1 までの数字があります。 <var>M</var>+1日間のラッキーナンバーを以下の方法で選びたいと思います。 最初の日にラッキーナンバーをランダムに決めます。 <var>i</var>日後のラッキーナンバーを <var>A</var> 、（<var>i</var>+1）日後のラッキーナンバーを <var>B</var> とすると、
</p>

<pre>
<var>B</var> = ( <var>A</var> + <var>j</var> ) % <var>N</var>
（ただし <var>j</var> は 0 &le; <var>j</var> &lt; <var>N</var> かつ （<var>j</var> / <var>K</var>） が偶数となる全ての整数である )
</pre>

<p>
で求められる<var>B</var>のうちのいずれかからランダムに決めます。ただし、<var>a</var> / <var>b</var> の結果は小数点以下を切り捨てた整数とし、<var>a</var>%<var>b</var>は<var>a</var>を<var>b</var>で割った余りとします。
また <var>K</var> は <var>N</var> / <var>K</var> が割り切れて、<var>N</var> / <var>K</var> が偶数となる数字であることが保証されます。
<p>
例えば 0,1,2,3 と数字があり、 <var>K</var> = 1 のとき
</p>
<ul>
<li>0 の次のラッキーナンバーは 0 or 2</li>
<li>1 の次のラッキーナンバーは 1 or 3</li>
<li>2 の次のラッキーナンバーは 0 or 2</li>
<li>3 の次のラッキーナンバーは 1 or 3</li>
</ul>
<p>
となります。
</p>

<p>
次に<var>Q</var>個の質問が与えられます。 各質問の内容は以下のとおりです。
</p>

<p>
最初の日のラッキーナンバーが <var>a</var> のとき <var>b</var> 日後のラッキーナンバーが <var>c</var> になるような <var>b</var> 日後までのラッキーナンバーの選び方は何通りでしょうか？
選び方は膨大な数になると思われるので 1,000,000,007 で割った余りを求めてください。
</p>

<p>
例えば、<var>N</var>=4 <var>K</var>=1 で、最初のラッキーナンバーが 0 で　3 日後のラッキーナンバーが 2 になるような組み合わせは
</p>
<ul>
<li>0 &rarr; 0 &rarr; 0 &rarr; 2</li>
<li>0 &rarr; 0 &rarr; 2 &rarr; 2</li>
<li>0 &rarr; 2 &rarr; 0 &rarr; 2</li>
<li>0 &rarr; 2 &rarr; 2 &rarr; 2</li>
</ul>
<p>
の４通りです。
</p>

<h2>Input</h2>
<p>
入力は以下の形式で与えられる。
</p>

<pre>
<var>N</var> <var>M</var> <var>K</var> <var>Q</var>
<var>a<sub>1</sub></var> <var>b<sub>1</sub></var> <var>c<sub>1</sub></var>
<var>a<sub>2</sub></var> <var>b<sub>2</sub></var> <var>c<sub>2</sub></var>
.
.
.
<var>a<sub>Q</sub></var> <var>b<sub>Q</sub></var> <var>c<sub>Q</sub></var>
</pre>

<h2>Constraints</h2>

<ul>
<li>1 &le; <var>N</var> &le; 5000</li>
<li>1 &le; <var>M</var> &le; 5000</li>
<li>1 &le; <var>K</var> &le; 5000</li>
<li><var>N</var> / <var>K</var> が割り切れる</li>
<li><var>N</var> / <var>K</var> は偶数</li>
<li>1 &le; <var>Q</var> &le; 100000</li>
<li>0 &le; <var>a<sub>i</sub></var> &lt; <var>N</var> ( 1 &le; <var>i</var> &le; <var>Q</var> )</li>
<li>0 &le; <var>b<sub>i</sub></var> &le; <var>M</var> ( 1 &le; <var>i</var> &le; <var>Q</var> )</li>
<li>0 &le; <var>c<sub>i</sub></var> &lt; <var>N</var> ( 1 &le; <var>i</var> &le; <var>Q</var> )</li>
</ul>

<h2>Output</h2>
<p>
各質問に対し、答えを求め 1,000,000,007 で割った余りを一行ずつ順番に出力してください。
</p>

<h2>Sample Input1</h2>
<pre>
6 3 1 10
0 1 0
0 2 0
0 3 0
1 3 3
0 2 1
2 2 2
2 3 2
2 2 0
1 1 1
2 2 1
</pre>

<h2>Sample Output1</h2>
<pre>
1
3
9
9
0
3
9
3
1
0
</pre>
