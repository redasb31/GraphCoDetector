<span class="lang">
<span class="lang-ja">
<h1>K: トーナメント</h1>

<div class="part">
<section>
<h3>問題文</h3><p>京都大学クスノキ前にて、$2$ 人用対戦ゲームのトーナメントが行われようとしています。</p>
<p>このトーナメントの参加者は $2^N$ 人いて、 $1$ から $2^N$ までの番号がついています。</p>
<p>参加者のうちの $2$ 人が戦った時の勝敗は、$0$ と $1$ からなる長さ $2^N-1$ の文字列 $S$ によって表されます。</p>
<p>人 $x$ と人 $y$ $(1 \le x &lt; y \le 2^N)$ が戦ったとき、</p>
<ul>
<li>$S_{y-x} = 0$ のとき、人 $x$ が勝ち、 </li>
<li>$S_{y-x} = 1$ のとき、人 $y$ が勝つ</li>
</ul>
<p>ことが分かっています。</p>
<p>トーナメントは参加者が一列に並ぶことで始まり、以下の通りに進行します。</p>
<ol>
<li>列の先頭から $2$ 人ずつペアを作る。すべてのペアについて、ペア内の $2$ 人が戦う。</li>
<li>1 の対戦で勝った人は列に残り、負けた人は列から抜ける。</li>
<li>残っている人が $2$ 人以上いるときは、列を詰めて 1 に戻る。</li>
<li>残っている人が $1$ 人となったら、その人が優勝者となる。</li>
</ol>
<p>いま、参加者は初期状態として、先頭から $i$ 番目 $(1 \le i \le 2^N)$ が人 $P_i$ となるように並んでいます。</p>
<p>$0 \le k \le 2^N-1$ を満たすすべての整数 $k$ について、以下の問題を解いてください。</p>
<ul>
<li>初期状態から先頭 $k$ 人が、その順番を変えずに列の末尾に移動する。<ul>
<li>つまり、移動後の列における参加者の番号を先頭から挙げていくと、 $P_{k+1}, P_{k+2}, ..., P_{2^N}, P_1, P_2, ..., P_k$ となる。</li>
</ul>
</li>
<li>移動後の列からトーナメントを始めたときの、優勝者の番号を求めよ。</li>
</ul>
</section>
</div>

<div class="part">
<section>
<h3>制約</h3><ul>
<li>$1 \leq N \leq 18$</li>
<li>$N$ は整数である。</li>
<li>$S$ は $0$ と $1$ からなる長さ $2^N-1$ の文字列である。</li>
<li>$P$ は $1$ から $2^N$ までの整数を並べ替えた順列である。</li>
</ul>
</section>
</div>

<hr />
<div class="io-style">
<div class="part">
<section>
<h3>入力</h3><p>入力は以下の形式で標準入力から与えられる。</p>
<pre>$N$
$S_1S_2 \ldots S_{2^N-1}$
$P_1$ $P_2$ $\ldots$ $P_{2^N}$
</pre>

</section>
</div>

<div class="part">
<section>
<h3>出力</h3><p>$2^N$ 行出力せよ。</p>
<p>$i$ 行目 $(1 \le i \le 2^N)$ には、$k = i-1$ としたときの上記の問題の答えを出力せよ。</p>
</section>
</div>
</div>

<hr />
<div class="part">
<section>
<h3>入力例1</h3><pre>2
100
1 4 2 3
</pre>

</section>
</div>

<div class="part">
<section>
<h3>出力例1</h3><pre>1
2
1
2
</pre>

<p>例えば $k = 2$ としたとき、移動後の列における参加者の番号を先頭から挙げていくと、 $2, 3, 1, 4$ となります。</p>
<p>人 $2$ と 人 $3$ が戦うと、 $S_1 = 1$ より人 $3$ が勝ちます。</p>
<p>人 $1$ と 人 $4$ が戦うと、 $S_3 = 0$ より人 $1$ が勝ちます。</p>
<p>人 $3$ と 人 $1$ が戦うと、 $S_2 = 0$ より人 $1$ が勝ちます。</p>
<p>したがって、 $k = 2$ の場合の優勝者は、人 $1$ となります。</p>
</section>
</div>

<hr />
<div class="part">
<section>
<h3>入力例2</h3><pre>4
101011100101000
8 15 2 9 12 5 1 7 14 10 11 3 4 6 16 13
</pre>

</section>
</div>

<div class="part">
<section>
<h3>出力例2</h3><pre>16
1
16
2
16
12
10
14
16
1
16
2
16
12
10
14
</pre>

</section>
</div>

<hr />
<div class="part">
<section>
<h3>入力例3</h3><pre>1
0
1 2
</pre>

</section>
</div>

<div class="part">
<section>
<h3>出力例3</h3><pre>1
1
</pre></section>
</div>
</span>
</span>
