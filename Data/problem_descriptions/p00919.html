
<H1><font color="#000">Problem F: </font>Directional Resemblance</H1>

<p>
Vectors have their directions and two vectors make an angle between them. Given a set of three-dimensional vectors, your task is to find the pair among them that makes the smallest angle.
</p>

<H2>Input</H2>

<p>
The input is a sequence of datasets. A dataset specifies a set of three-dimensional vectors, some of which are directly given in the dataset and the others are generated by the procedure described below.
</p>

<p>
Each dataset is formatted as follows.
</p>

<pre>
<var>m</var> <var>n</var> <var>S</var> <var>W</var>
<var>x<sub>1</sub></var> <var>y<sub>1</sub></var> <var>z<sub>1</sub></var>
<var>x<sub>2</sub></var> <var>y<sub>2</sub></var> <var>z<sub>2</sub></var>
:
<var>x<sub>m</sub></var> <var>y<sub>m</sub></var> <var>z<sub>m</sub></var>
</pre>

<p>
The first line contains four integers <var>m</var>, <var>n</var>, <var>S</var>, and <var>W</var>.
</p>

<p>
The integer <var>m</var> is the number of vectors whose three components are directly specified in the
dataset. Starting from the second line, <var>m</var> lines have the three components of <var>m</var> vectors. The <var>i</var>-th line of which indicates the vector <var>v<sub>i</sub></var> = (<var>x<sub>i</sub></var>, <var>y<sub>i</sub></var>, <var>z<sub>i</sub></var>). All the vector components are positive integers less than or equal to 100.
</p>

<p>
The integer <var>n</var> is the number of vectors generated by the following procedure.
</p>

<pre>
int g = S;
for(int i=m+1; i<=m+n; i++) {
  x[i] = (g/7)    %100 + 1;
  y[i] = (g/700)  %100 + 1;
  z[i] = (g/70000)%100 + 1;
  if( g%2 == 0 ) { g = (g/2); }
  else           { g = (g/2) ^ W; }
}
</pre>

<p>
For <var>i = m + 1, . . . , m + n</var>, the <var>i</var>-th vector <var>v<sub>i</sub></var> of the set has three components <span>x[i]</span>, <span>y[i]</span>, and <span>z[i]</span> generated by this procedure.
</p>

<p>
Here, values of <span>S</span> and <span>W</span> are the parameters <var>S</var> and <var>W</var> given in the first line of the dataset. You may assume 1 &le; <var>S</var> &le; 10<sup>9</sup> and 1 &le; <var>W</var> &le; 10<sup>9</sup>.
</p>

<p>
The total number of vectors satisfies 2 &le; <var>m + n</var> &le; 12 &times; 10<sup>4</sup>. Note that exactly the same vector may be specified twice or more in a single dataset.
</p>

<p>
A line containing four zeros indicates the end of the input. The total of <var>m+n</var> for all the datasets in the input never exceeds 16 &times; 10<sup>5</sup>.
</p>


<H2>Output</H2>

<p>
For each dataset, output the pair of vectors among the specified set with the smallest non-zero angle in between. It is assured that there are at least two vectors having different directions.
</p>

<p>
Vectors should be indicated by their three components. The output for a pair of vectors <var>v<sub>a</sub></var> and <var>v<sub>b</sub></var> should be formatted in a line as follows.
</p>

<pre>
<var>x<sub>a</sub></var> <var>y<sub>a</sub></var> <var>z<sub>a</sub></var> <var>x<sub>b</sub></var> <var>y<sub>b</sub></var> <var>z<sub>b</sub></var>
</pre>

<p>
Two vectors (<var>x<sub>a</sub></var>, <var>y<sub>a</sub></var>, <var>z<sub>a</sub></var>) and (<var>x<sub>b</sub></var>, <var>y<sub>b</sub></var>, <var>z<sub>b</sub></var>) are ordered in the dictionary order, that is, <var>v<sub>a</sub></var> &lt; <var>v<sub>b</sub></var> if <var>x<sub>a</sub></var> &lt; <var>x<sub>b</sub></var>, or if <var>x<sub>a</sub> = x<sub>b</sub></var> and <var>y<sub>a</sub></var> &lt; <var>y<sub>b</sub></var>, or if <var>x<sub>a</sub> = x<sub>b</sub></var>, <var>y<sub>a</sub> = y<sub>b</sub></var> and <var>z<sub>a</sub></var> &lt; <var>z<sub>b</sub></var>. When a vector pair is output, the smaller vector in this order should be output first.
</p>

<p>
If more than one pair makes the equal smallest angle, the pair that is the smallest among them in the dictionary order between vector pairs should be output. The pair (<var>v<sub>i</sub></var>, <var>v<sub>j</sub></var>) is smaller than the pair (<var>v<sub>k</sub></var>, <var>v<sub>l</sub></var>) if <var>v<sub>i</sub></var> &lt; <var>v<sub>k</sub></var>, or if <var>v<sub>i</sub> = v<sub>k</sub></var> and <var>v<sub>j</sub></var> &lt; <var>v<sub>l</sub></var>.
</p>

<H2>Sample Input</H2>
<pre>
4 0 2013 1124
1 1 1
2 2 2
2 1 1
1 2 1
2 100 131832453 129800231
42 40 46
42 40 46
0 100000 7004674 484521438
0 0 0 0
</pre>

<H2>Output for the Sample Input</H2>
<pre>
1 1 1 1 2 1
42 40 46 83 79 91
92 92 79 99 99 85
</pre>