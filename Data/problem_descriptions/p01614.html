


    <h1>B: VOCAL ANDROID</h1>


    <p>ボーカルアンドロイド (VOCAL ANDROID) とは，メロディと歌詞を入力して音声を合成する作曲ツールである． 2013年3月9日に和歌山県で開催された，ボーカルアンドロイドのライブに行ったあなたは，音楽の素晴らしさに感動した． そこで，あなたは新作ボーカルアンドロイド「立音リプロ (CV.立命太郎)」を購入し，作曲を始めることにした． ところが，メロディは完成したものの作詞で詰まってしまった．</p>

    <p>使いたいフレーズはいくつか断片的に用意しており，それらを組み合わせて各メロディにあてはめる． 各メロディは，長さが決まっており，必ずこの長さぴったりになるようにフレーズをあてはめる必要がある． また，各フレーズには，そのフレーズを使うと得られるノリの良さを表す得点と，下限の長さと上限の長さが決まっている． フレーズは，長さが整数であれば，下限から上限まで自由に調整できる． ただし，長さを変更しても，得られる点数は変わらない． 図1は，サンプルの1番目の例である．</p>

    <div align="center">
      <img src="https://judgeapi.u-aizu.ac.jp/resources/images/IMAGE3_Rits_Camp13_Day3_B_B_fig" alt="メロディに対するフレーズの割り当て"  />

      <p><strong>図1:</strong> メロディに対するフレーズの割り当て</p>
    </div>

    <p>あなたの仕事はメロディの長さぴったりにフレーズを組み合わせて，できるだけ得点の総和が高い曲を作ることである． 同じフレーズは何度も使用してよいものとする．</p>

    <div>
      <h1>Input</h1>

      <p>入力は以下の形式で与えられる．</p>

      <div>
        <em>n</em><br />
        <em>s</em><sub>1</sub> <em>l</em><sub>1</sub> <em>p</em><sub>1</sub><br />
        …<br />
        <em>s</em><sub>n</sub> <em>l</em><sub>n</sub> <em>p</em><sub>n</sub><br />
        <em>m</em><br />
        <em>w</em><sub>1</sub><br />
        …<br />
        <em>w</em><sub>m</sub><br />
      </div>

<br/>

      <p>1行目には <em>n</em> ( 1 ≦ <em>n</em> ≦ 393 ) が与えられ， その後 <em>n</em> 行には歌詞に使うフレーズの情報が与えられる． <em>s</em><sub>i</sub>, <em>l</em><sub>i</sub> ( 1 ≦ <em>s</em><sub>i</sub> &lt; <em>l</em><sub>i</sub> ≦ 393 ) は， そのフレーズの長さの下限と上限であり， <em>p</em><sub>i</sub> ( 1 ≦ <em>p</em><sub>i</sub> ≦ 393 ) は，そのフレーズの得点を表す．</p>

      <p><em>m</em> ( 1 ≦ <em>m</em> ≦ 393 ) は，メロディの数を表し， その後 <em>m</em> 行にメロディの長さ <em>w</em><sub>i</sub> ( 1 ≦ <em>w</em><sub>i</sub> ≦ 393 ) が与えられる．</p>
    </div>

    <div>
      <h1>Output</h1>

      <p>以下のような形式で各メロディの得点を出力せよ．</p>

      <div>
        <em>1</em> 行目 メロディ 1 の最大得点<br />
        …<br />
        <em>m</em> 行目 メロディ <em>m</em> の最大得点<br />
      </div>

<br/>

      <p>ただし，1つでもフレーズをぴったり当てはめられないメロディが存在する場合には，-1のみを出力せよ．</p>
    </div>

    <div>
      <h1>Sample Input 1</h1>
      <pre>
3
4 5 15
2 3 4
7 8 39
2
6
8
</pre>
    </div>

    <div>
      <h1>Sample Output 1</h1>
      <pre>
19
39
</pre>
    </div>

    <div>
      <h1>Sample Input 2</h1>
      <pre>
1
2 3 10
2
3
1
</pre>
    </div>

    <div>
      <h1>Sample Output 2</h1>
      <pre>
-1
</pre>
    </div>