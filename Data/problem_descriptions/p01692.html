

<h2>F - Dangerous Delivery / 危険な輸送</h2>

<h3>Story</h3>
<p>Dのひとは重大な使命を背負っていた。それはDAtaCoDer社長のDhokudai氏へ、次のDAtaCoDer Regular Contest(DARC)のD問題を届けることだ。Dのひとのアジトがある都市<var>1</var>からDAtaCoDer本社がある都市<var>N</var>までは<var>N</var>個の都市が一直線に並んでいる。この移動の間、不正を企む緑の三角形の集団がD問題を狙っており、その魔の手からD問題を守らねばならない。</p>
<p>幸い、Dのひとは次元(ディメンジョン)の壁を超えて移動する能力を持っているため、簡単に捕まるようなことはない。しかしこの移動法にはいくつかの欠点がある。第一に、移動を開始する際には隙ができてしまい、またその瞬間が見つかると、移動先までバレてしまう。緑の三角形達はそれぞれが複数の都市を見渡せるように監視し続けている。しかもDのひとの移動を読み、少しずつ都市<var>N</var>の方向へ移動しているようだ。よって、多くの緑の三角形達に監視されている都市からの移動や、長い距離の移動は発見のリスクが高まってしまう。また第二の欠点として、次元の壁を超える移動は体への負担がかかるため、<var>1</var>日に<var>1</var>度しか使えない。次のDARCが開催される<var>D</var>日後までに間に合わせるよう、ペース配分を考える必要もある。緑の三角形ごときにDのひとが捕捉されることなどまずありえないが、慎重派であるDのひとは、<var>D</var>日後までに都市<var>1</var>から都市<var>N</var>に移動するためのリスクを最小化しようと考えた。</p>
<h3>Problem</h3>
<p>二次元平面上に<var>N</var>個の都市がある。都市<var>1</var>から<var>N</var>は左から右へ一直線上に並んでおり、都市<var>i</var>は位置<var>(p_i,0)</var>にある。<var>p_i&lt;p_{i+1}</var> (<var>1 \leq i &lt; N</var>)を満たす。</p>
<p>また、この二次元平面上には<var>M</var>人の敵がおり、敵<var>j</var>は当初、位置<var>(a_j,b_j)</var>にいる。敵<var>j</var>は左方向について、上下<var>45</var>°の範囲を見張っている。すなわち、直線 <var>y=x-a_j+b_j</var> 以上で、かつ、直線<var>y=-x+a_j+b_j</var> 以下の領域に含まれる全ての都市が視界に入っている。また、すべての敵は<var>1</var>日ごとにちょうど<var>X</var>だけ右方向に移動する。すなわち、<var>d</var>日目の敵<var>j</var>の位置は<var>(a_j+X(d-1),b_j)</var>である。</p>
<p>ここで、<var>d</var>日目における都市<var>i</var>の監視度<var>w_{d,i}</var>は、<var>d</var>日目において都市<var>i</var>を視界に入れている敵の総数により定義される。このとき、<var>d</var>日目の都市<var>i</var>から都市<var>k</var>への移動は、<var>w_{d,i} \times |p_i-p_k|</var>のリスクを負う。<var>1</var>日に<var>1</var>度しか移動できないとするとき、<var>D</var>日後までに都市<var>1</var>から都市<var>N</var>まで移動する際のリスクの総和を最小化せよ。</p>
<h3>Input</h3>
<p>入力は以下の形式からなる。</p>
<pre><var>N</var> <var>M</var> <var>D</var> <var>X</var>
<var>p_1</var> <var>p_2</var> <var>...</var> <var>p_N</var>
<var>a_1</var> <var>b_1</var>
<var>...</var>
<var>a_M</var> <var>b_M</var></pre>
<p><var>1</var>行目は<var>4</var>つの整数からなり、都市の数<var>N</var>、敵の数<var>M</var>、移動にかけてよい日数の上限<var>D</var>、<var>1</var>日ごとの敵の移動距離<var>X</var>がそれぞれ空白<var>1</var>文字区切りで与えられる。 <var>2</var>行目は<var>N</var>個の整数からなり、<var>i</var>番目の整数は都市<var>i</var>の位置の<var>x</var>座標<var>p_i</var>が空白<var>1</var>文字区切りで与えられる。 続く<var>M</var>行は敵の位置情報が与えられる。 <var>j+2</var>行目(<var>1 \leq j \leq M</var>)は<var>2</var>つの整数からなり、敵<var>j</var>の<var>1</var>日目の位置の<var>x</var>座標<var>a_j</var>、<var>y</var>座標<var>b_j</var>が空白<var>1</var>文字区切りで与えられる。</p>

<p>制約:</p>

<ul>
<li><var>1 \leq N \leq 10^4</var></li>
<li><var>1 \leq M \leq 10^4</var></li>
<li><var>1 \leq D \leq 10^2</var></li>
<li><var> 1 \leq X \leq 10^6</var></li>
<li><var>0 \leq p_i, a_j \leq 10^6, -10^6 \leq b_j \leq 10^6</var></li>
<li><var>p_i&lt;p_{i+1}</var></li>
</ul>

<h3>Output</h3>
<p><var>D</var>日目までに都市<var>N</var>にいるためのリスクの総和の最小値を<var>1</var>行に出力せよ。行の最後では必ず改行を行うこと。</p>
<h3>Sample Input 1</h3>
<pre>3 2 2 1
0 3 6
1 1
3 -2</pre>
<h3>Sample Output 1</h3>
<pre>6</pre>
<img src="https://judgeapi.u-aizu.ac.jp/resources/images/IMAGE2_HUPC2014_DangerousDelivery_sample1-1" alt="DangerousDelivery_sample1-1.png" />
<img src="https://judgeapi.u-aizu.ac.jp/resources/images/IMAGE2_HUPC2014_DangerousDelivery_sample1-2" alt="DangerousDelivery_sample1-2.png" />
<p>1日目、都市1は2人、都市2は0人、都市3は0人に監視されている。 2日目も同様に、都市1は2人、都市2は0人、都市3は0人に監視されている。 よって、1日目に都市1から都市2に移動してリスクが<var>2 \times |3-0|=6</var>、2日目に都市2から都市3へ移動してリスクが<var>0 \times |6-3|=0</var>の合計6が最小である。</p>
<h3>Sample Input 2</h3>
<pre>3 2 2 1
0 3 6
2 1
3 -1</pre>
<h3>Sample Output 2</h3>
<pre>9</pre>
<img src="https://judgeapi.u-aizu.ac.jp/resources/images/IMAGE2_HUPC2014_DangerousDelivery_sample2-1" alt="DangerousDelivery_sample2-1.png" />
<img src="https://judgeapi.u-aizu.ac.jp/resources/images/IMAGE2_HUPC2014_DangerousDelivery_sample2-2" alt="DangerousDelivery_sample2-2.png" />
<p>移動の仕方は1つ目のサンプルと同じだが、2日目は敵の移動により都市2の監視人数が1人増えるため、コストが<var>1 \times |6-3|=3</var>に変化する。 よって、最小リスクは9である。</p>
<h3>Sample Input 3</h3>
<pre>10 8 5 3
0 8 10 13 17 20 21 29 30 45
18 2
50 -20
17 1
38 21
40 -11
0 0
0 0
22 -1</pre>
<h3>Sample Output 3</h3>
<pre>222</pre>