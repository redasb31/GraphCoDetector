

<h1>H - 植林</h1>

  <h2>問題文</h2>
<p>
  とある大学の魔法学部の生徒であるK君は広大な屋敷に住んでいる．
  屋敷の裏には林が広がっていたが，所々木が生えていない箇所があった．
  このままでは屋敷からの見た目が悪いと感じたので，K君は木が生えていない箇所に木を植えることに決めた．
  魔法使いの卵であるK君は使い魔を召喚することが出来るので，植林の作業を使い魔にやらせようと考えた．
</p>
<p>
  林は <var>H &times; W</var> 個のセルを持つ長方形領域とみなすことが出来る．
  各セルは木が1本生えているか1本も生えていないかのどちらかである．
  K君はこの <var>H &times; W</var> 個のセルのどれか 1 つを指定し，そこに使い魔を召喚する．
  しかしK君はまだ未熟者なので，魔力を調節することが出来ず，使い魔を召喚するときは必ず 5 匹召喚してしまう．
  さらに悪いことに，K君が召喚する使い魔はひねくれもので，訪れたセルに木が生えていない場合はそこに木を植えるが，訪れたセルに既に木が生えている場合はそのセルの木を消してしまう．
  召喚された使い魔のうちの 4 匹は，指定されたセルを始点として東西南北に散らばり1直線上を進み，1つ1つセルを訪れていく．これらの使い魔は林の外に出ると消える．
  残りの使い魔は指定されたセルのみを訪問し，その後直ちに消える．
</p>
<p>
  より正確に言えば，K君がセル <var>(i, j)</var> に使い魔を召喚すると，<var>i</var> 行目か或いは
  <var>j</var> 列目にある <var>H+W-1</var> 個のセルに対し，
  木が生えていなければ木が植えられ，木が生えていれば木が消されるという操作が行われる．
</p>
<p>
  召喚には多くの魔力を必要とするので，出来るだけ少ない召喚回数で林を木で覆いつくしたい．
  K君はどのセルに使い魔を召喚すれば最小の召喚回数で林を木で覆いつくすことが出来るだろうか．
</p>


<h2>入力形式</h2>
<p>
入力は以下の形式で与えられる．
</p>
<pre><var>H</var> <var>W</var>
<var>a<sub>1,1</sub></var> ... <var>a<sub>1,W</sub></var>
...
<var>a<sub>H,1</sub></var> ... <var>a<sub>H,W</sub></var>
</pre>
<p>
  <var>a<sub>i,j</sub></var> が <var>1</var> ならセル <var>(i,j)</var> に木が生えていることを意味し,
  <var>0</var>なら生えていないことを意味する．
</p>

<h2>出力形式</h2>
<p>
もし林を木で覆いつくすことが不可能なら，1行に <code>Impossible</code> を出力せよ．
そうでなければ，召喚回数を最小にするような召喚手順を以下の形式で <var>H</var> 行に出力せよ．
</p>
<pre><var>
b<sub>1,1</sub> ... b<sub>1,W</sub>
...
b<sub>H,1</sub> ... b<sub>H,W</sub>
</var>
</pre>
<p>
  <var>b<sub>i,j</sub></var> は <var>0</var> もしくは <var>1</var> でなければならず,
  <var>1</var> ならセル <var>(i,j)</var> に使い魔を召喚する事を意味し，<var>0</var> なら召喚しない事を意味する．
</p>
<p>
  2回同じ場所に使い魔を召喚しても意味が無いことに注意せよ．召喚回数を最小にするような召喚手順が複数ある場合はどれを出力しても良い．
</p>
<h2>制約</h2>
<ul>
<li><var>2 &le; H，W &le; 1000</var></li>
<li><var>H，W</var> は偶数</li>
<li><var>a<sub>i,j</sub> &isin; {0, 1}</var></li>
</ul>
<p>
この問題の判定には，3 点分のテストケースのグループが設定されている． このグループに含まれるテストケースは上記の制約に加えて下記の制約も満たす．
</p>
<ul>
<li><var>H &times; W &le; 20</var></li>
</ul>

<h2>入出力例</h2>
<h3>入力例 1</h3>
<pre>
4 4
0 0 0 1
0 1 1 0
0 1 1 0
1 0 0 0
</pre>

<h3>出力例 1</h3>
<pre>
1 0 0 0
0 0 0 0
0 0 0 0
0 0 0 1
</pre>

<p>
  セル <var>(1,1)</var> とセル <var>(4,4)</var> に使い魔を召喚することで林を木で覆いつくすことが出来る．
</p>

<hr>
<address>Writer: 田村和範</address>
<address>Tester: 花田裕一朗</address>