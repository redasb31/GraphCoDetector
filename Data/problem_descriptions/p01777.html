



<h2>F: Disordered Data Detection / 異常検知</h2>

<h3>物語</h3>
<p>宮守あかねは武蔵野ソフトウェアに務めるエンジニアである．今日は顧客から受けた不具合報告に頭を悩ませている．「変な話，この前作ってもらったソフトの挙動がぷるんぷるんしてるんでぇ，そちらでチェックしてもらえますか？保守するのもおたくらの仕事でしょ？」いつも無理難題ばかり押し付けてくるこの顧客だが，今回ばかりはこちらに非がある．なぜなら，いつも適当な仕事ばかりのジローがテストに通っていないコードをそのまま放置して製品に組み込んだことを告白したからである．普通の人間ならジローに殴りかかりそうなものだが，もはやいつものことだ，あかねは怒りを通り越し，すでに悟りを開きつつある．なにはともあれ，バグを取り除かなければならない．まずはデータログを解析し，異常が出ている箇所を検知することでバグの原因を探ろう．</p>

<p>今，<var>D</var> 日分のログがあり，各データは1つの整数である．<var>l</var> 日目から <var>r</var> 日目までのデータについて，<var>l</var> 日目のデータと <var>r</var> 日目のデータの間に収まらず，大きくかけ離れたデータは異常の可能性が高いと考えられる．よって，指定された期間を入力とし，上記のような外れ値を検知するコードを書くことにした．</p>

<p>顧客が提示したデバッグ期限は3時間後．万策尽きたかのような状況だが，あかねは何度もこのような状況を乗り越えてきた．お気に入りのドーナツを頬張り気合を入れて，どんどんデバッグ，どーんと行こう！</p>

<h3>問題</h3>
<p>長さ <var>D</var> の整数列 <var>x_1, . . . ,  x_D</var> がある．この数列に対し <var>Q</var> 回のクエリが与えられる．<var>i</var> 番目のクエリは3つの整数 <var>l_i</var>, <var>r_i</var>, <var>e_i</var> からなる．<var>i</var> 番目のクエリに対し，<var>a_i = min\{x_{l_i},x_{r_i}\}</var>, <var>b_i = max\{x_{l_i},x_{r_i}\}</var> としたとき，<var>x_j &lt; a_i &minus; e_i</var> もしくは <var>b_i+e_i &lt; x_j</var> を満たすような <var>l_i &le; j &le; r_i</var> の個数を答えよ．</p>


<h3>入力形式</h3>
<p>入力は以下の形式からなる．</p>

<pre>
 <var>D</var>
 <var>x_1</var> <var>x_2</var> <var> . . . </var> <var>x_D</var>
 <var>Q</var>
 <var>l_1</var> <var>r_1</var> <var>e_1</var>
 <var> . . . </var>
 <var>l_Q</var> <var>r_Q</var> <var>e_Q</var>
</pre>

<p>入力の1行目は数列の長さを表す1つの整数 <var>D</var> (<var>1 &le; D &le; 100{,}000</var>) からなる．2行目では，数列 <var>X</var> を表す <var>D</var> 個の整数がそれぞれ空白1つを区切りとして与えられる．<var>i</var> 番目の整数 <var>x_i</var> は <var>&minus;10^8 &le; x_i &le; 10^8</var> を満たす．</p>

<p>3行目はクエリの個数を表す1つの整数 <var>Q</var> (<var>1&le; Q &le; 100{,}000</var>) からなる．続く <var>Q</var> 行のうち <var>j</var> 番目の行では，<var>j</var> 番目のクエリを表す3つの整数 <var>l_j</var>, <var>r_j</var>, <var>e_j</var> が空白1つを区切りとして与えられる．<var>j</var> 番目のクエリについて，<var>1 &le; l_j &le; r_j &le; D</var>, <var>0 &le; e_j &le; 10^8</var> を満たす．</p>

<h3>出力形式</h3>
<p><var>Q</var> 個のクエリに対する答えを，クエリが与えられた順にそれぞれ1行ごとに出力せよ．</p>

<h3>入力例1</h3>
<pre>
7
4 1 10 5 7 7 3
5
2 5 0
3 6 1
3 6 2
1 7 2
1 7 5
</pre>

<h3>出力例1</h3>
<pre>
1
1
0
3
1
</pre>

<h3>入力例2</h3>
<pre>
9
8 3 0 2 5 2 5 2 1
3
1 3 5
2 5 0
3 9 0
</pre>

<h3>出力例2</h3>
<pre>
0
2
5
</pre>

<h3>入力例3</h3>
<pre>
9
10 10 10 7 2 10 10 1 5
13
3 3 6
3 4 5
3 5 4
3 6 3
3 7 2
3 8 1
3 9 0
4 9 1
5 9 2
6 9 3
7 9 4
8 9 5
9 9 6
</pre>

<h3>出力例3</h3>
<pre>
0
0
0
1
2
0
2
4
2
1
0
0
0
</pre>