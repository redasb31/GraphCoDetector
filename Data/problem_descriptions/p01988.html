<h3>NINJA GAME</h3>

<!-- begin ja only -->

<p>新作ゲーム "NIN<strong><em>JA G</em></strong>AME" がついに発売となった．このゲームではプレイヤーは二次元マップ上の忍者を操作して移動を行う．二次元マップは <i>x</i> 軸，または <i>y</i> 軸のどちらか一方に平行な辺のみからなる，自己交差のない多角形で表される．いま，多角形の内部に存在するスタート地点からゴール地点へと移動する必要がある．</p>
<p>移動は上下左右と斜め45°の8方向が可能で，いずれかの対応するコマンドを入力すると，指定した方向に自動で進み続ける．この自動移動の最中の任意のタイミングで別のコマンドを入力した場合，即座に移動方向の転換が可能である．あなたの目標は，このゲームでの実績を解除するため，最小のコマンド入力回数でスタート地点からゴール地点に移動することである．</p>
<p>ここで気を付ける必要があるのは，キャラが忍者であるので，壁伝いの移動が可能であるということだ．ここで壁伝いの移動するとは，多角形の辺上を移動することである．ただし，もちろん多角形の外部に出ることはできない．壁伝いの移動中にその壁に対し垂直方向に移動しようとする場合はそれ以上移動できずに止まるのだが，一方で壁伝いの移動中に斜め方向に移動しようとする場合，壁と平行な方向への壁伝いの自動移動が続き，壁がなくなったところで元の斜め方向にまた自動移動を続ける．例えば下図のように <i>y</i> 軸に平行な壁に <i>x</i> 軸正方向と <i>y</i> 軸負方向からなる斜め方向からぶつかった場合，ぶつかった後は壁に沿って <i>y</i> 軸負方向に進み，壁がなくなったところでまた <i>x</i> 軸正方向と <i>y</i> 軸負方向からなる斜め方向へと進み始める．</p>
<p><center><img src="https://judgeapi.u-aizu.ac.jp/resources/images/IMAGE2_JAGDomestic2018_H1.png"></center></p>
<p>ここで，斜め方向に移動しながら角にぶつかったときの挙動は以下のようになる．(a) のように両方向に壁が囲まれている場合はそこで止まり，方向転換をしなければ動けない．(b) や (c) のように角を通り過ぎてそのまま進める場合は，斜め方向に自動移動を続ける．(d) のように両方向に進める場合，好きな方向を選んで進めるものとしてよい．図では移動を表す矢印で壁が隠れるため少し内部側に寄せて図示しているが，これも実際には辺上を移動することを表す図である．</p>
<p><center><img src="https://judgeapi.u-aizu.ac.jp/resources/images/IMAGE2_JAGDomestic2018_H2.png"></center></p>
<p>また，上下左右方向の移動中に角にぶつかったときの挙動は以下のようになる．(e), (f), (g) のような場合はそのままの方向に自動移動を続ける．(h) のように壁に垂直にぶつかった場合はそこで止まり，方向転換をしなければ動けない．ただし，同様に移動を表す矢印を壁から少し内部側に寄せているが，実際には辺上を移動することを表す図である．</p>
<p><center><img src="https://judgeapi.u-aizu.ac.jp/resources/images/IMAGE2_JAGDomestic2018_H3.png"></center></p>
<p>上記の移動に関する挙動に従った上で，スタート地点からゴール地点に到達するために入力する必要があるコマンドの数の最小値を求めるプログラムを作成してほしい．例えば下図における最小のコマンド入力回数は，図中に示すように2である．これは3つ目のサンプル入力に対応している．</p>
<p><center><img src="https://judgeapi.u-aizu.ac.jp/resources/images/IMAGE2_JAGDomestic2018_H4.png"></center></p>
<!-- end ja only -->

<h3>Input</h3>

<!-- begin ja only -->

<p>入力は複数のデータセットからなる．
データセットの数は最大で 100 である．
各データセットは，次の形式で表される．</p>
<blockquote><i>N</i>
<i>sx</i> <i>sy</i> <i>gx</i> <i>gy</i>
<i>x<sub>1</sub></i> <i>y<sub>1</sub></i>
<i>...</i>
<i>x<sub>N</sub></i> <i>y<sub>N</sub></i></blockquote>
<p>データセットの 1 行目はマップを表す多角形の頂点数を表す1つの整数 <i>N</i> (<i>4 &le; N &le; 100</i>) からなる．2行目は4つの整数 <i>sx</i>, <i>sy</i>, <i>gx</i>, <i>gy</i> (<i>-10,000 &le; sx, sy, gx, gy &le; 10,000</i>) からなり，スタート地点の座標が <i>(sx, sy)</i>，ゴール地点の座標が <i>(gx, gy)</i> であることを表している．続く <i>N</i> 行では多角形の各頂点が反時計回り順に与えられる．このうち <i>i</i> 行目は2つの整数 <i>x<sub>i</sub></i>, <i>y<sub>i</sub></i> (<i>-10,000 &le; x<sub>i</sub>, y<sub>i</sub> &le; 10,000</i>) からなり，<i>i</i> 番目の頂点の座標が <i>(x<sub>i</sub>, y<sub>i</sub>)</i> であることを表す．ここで，与えられるスタート地点，ゴール地点，多角形は以下の制約を満たす．</p>
<ul>
<li>全ての辺は <i>x</i> 軸か <i>y</i> 軸のいずれか一方に対して平行である．</li>
<li>与えられる多角形は自己交差を持たない．すなわち，各辺は端点以外で他の辺と交差せず，異なる <i>i, j</i> について <i>(x<sub>i</sub>, y<sub>i</sub>) &ne; (x<sub>j</sub>, y<sub>j</sub>)</i> である．</li>
<li><i>(sx, sy)</i> と <i>(gx, gy)</i> はともにこの多角形の内部 (辺上を含まない) にあることが保証される．</li>
<li>スタートとゴールは異なる，すなわち <i>(sx, sy) &ne; (gx, gy)</i> であることが保証される．</li>
</ul>
<p>入力の終わりは 1 つのゼロからなる行で表される．</p>
<!-- end ja only -->

<h3>Output</h3>

<!-- begin ja only -->

<p>各データセットに対し，スタート地点からゴール地点に辿り着くために必要な最小のコマンド入力の回数を 1 行で出力せよ．</p>

<!-- end ja only -->

<h3>Sample Input</h3><pre>8
1 1 2 2
0 2
0 0
2 0
2 1
3 1
3 3
1 3
1 2
12
-9 5 9 -9
0 0
0 -13
3 -13
3 -10
10 -10
10 10
-1 10
-1 13
-4 13
-4 10
-10 10
-10 0
12
3 57 53 2
0 0
64 0
64 18
47 18
47 39
64 39
64 60
0 60
0 44
33 44
33 30
0 30
0
</pre><h3>Output for the Sample Input</h3><pre>1
1
2
</pre>

<p>
  1つ目の入力は下図 (1)，2つ目の入力は下図 (2) に対応する．
  </p>

<center><img src="https://judgeapi.u-aizu.ac.jp/resources/images/IMAGE2_JAGDomestic2018_H5.png"></center>
