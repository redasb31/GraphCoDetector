
<H1><font color="#000">Problem G: </font>Longest Chain</H1>

<p>
Let us compare two triples <var>a = (x<sub>a</sub>, y<sub>a</sub>, z<sub>a</sub>)</var> and <var>b = (x<sub>b</sub>, y<sub>b</sub>, z<sub>b</sub>)</var> by a partial order &ang; defined as follows.
<br/>
<center>
<var>a</var> &ang; <var>b</var> &hArr; <var>x<sub>a</sub></var> &lt; <var>x<sub>b</sub></var> and <var>y<sub>a</sub></var> &lt; <var>y<sub>b</sub></var> and <var>z<sub>a</sub></var> &lt; <var>z<sub>b</sub></var>
<br/>
</center>
<br/>
<p>
Your mission is to find, in the given set of triples, the longest ascending series <var>a<sub>1</sub></var> &ang; <var>a<sub>2</sub></var> &ang; ...  &ang; <var>a<sub>k</sub></var>.
</p>

<H2>Input</H2>

<p>
The input is a sequence of datasets, each specifying a set of triples formatted as follows.
</p>

<pre>
<var>m</var> <var>n</var> <var>A</var> <var>B</var>
<var>x<sub>1</sub></var> <var>y<sub>1</sub></var> <var>z<sub>1</sub></var>
<var>x<sub>2</sub></var> <var>y<sub>2</sub></var> <var>z<sub>2</sub></var>
...
<var>x<sub>m</sub></var> <var>y<sub>m</sub></var> <var>z<sub>m</sub></var>
</pre>

<p>
Here, <var>m</var>, <var>n</var>, <var>A</var> and <var>B</var> in the first line, and all of <var>x<sub>i</sub></var>, <var>y<sub>i</sub></var> and <var>z<sub>i</sub></var> (<var>i</var> = 1, . . . , <var>m</var>) in the following lines are non-negative integers.
</p>

<p>
Each dataset specifies a set of <var>m + n</var> triples. The triples <var>p<sub>1</sub></var> through <var>p<sub>m</sub></var> are explicitly specified in the dataset, the <var>i</var>-th triple <var>p<sub>i</sub></var> being (<var>x<sub>i</sub>, y<sub>i</sub>, z<sub>i</sub>)</var>. The remaining <var>n</var> triples are specified by parameters <var>A</var> and <var>B</var> given to the following generator routine.
</p>

<pre>
int a = A, b = B, C = ~(1<<31), M = (1<<16)-1;
int r() {
  a = 36969 * (a & M) + (a >> 16);
  b = 18000 * (b & M) + (b >> 16);
  return (C & ((a << 16) + b)) % 1000000;
}
</pre>

<p>
Repeated 3<var>n</var> calls of <span>r()</span> defined as above yield values of <var>x<sub>m+1</sub></var>, <var>y<sub>m+1</sub></var>, <var>z<sub>m+1</sub></var>, <var>x<sub>m+2</sub></var>, <var>y<sub>m+2</sub></var>, <var>z<sub>m+2</sub></var>, ..., <var>x<sub>m+n</sub></var>, <var>y<sub>m+n</sub></var>, and <var>z<sub>m+n</sub></var>, in this order.
</p>

<p>
You can assume that 1 &le; <var>m + n</var> &le; 3 &times; 10<sup>5</sup>, 1 &le; <var>A,B</var> &le; 2<sup>16</sup>, and 0 &le; <var>x<sub>k</sub>, y<sub>k</sub>, z<sub>k</sub></var> &lt; 10<sup>6</sup> for 1 &le; <var>k</var> &le; <var>m + n</var>.
</p>

<p>
The input ends with a line containing four zeros. The total of <var>m + n</var> for all the datasets does not exceed 2 &times; 10<sup>6</sup>.
</p>

<H2>Output</H2>

<p>
For each dataset, output the length of the longest ascending series of triples in the specified set. If <var>p<sub>i<sub>1</sub></sub></var> &ang; <var>p<sub>i<sub>2</sub></sub></var> &ang; ... &ang; <var>p<sub>i<sub>k</sub></sub></var> is the longest, the answer should be <var>k</var>.
</p>

<H2>Sample Input</H2>
<pre>
6 0 1 1
0 0 0
0 2 2
1 1 1
2 0 2
2 2 0
2 2 2
5 0 1 1
0 0 0
1 1 1
2 2 2
3 3 3
4 4 4
10 0 1 1
3 0 0
2 1 0
2 0 1
1 2 0
1 1 1
1 0 2
0 3 0
0 2 1
0 1 2
0 0 3
0 10 1 1
0 0 0 0
</pre>

<H2>Output for the Sample Input</H2>
<pre>
3
5
1
3
</pre>