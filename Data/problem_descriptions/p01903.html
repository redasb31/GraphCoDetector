


<link rel="stylesheet" href="css/description.css" type="text/css" />
<script language="JavaScript" type="text/javascript" src="js/varmath.js" charset="UTF-8"></script>


<h2>F: 風呂がオーバーフロー - Overflow of Furo -</h2>

<h3>物語</h3>
<p>
温泉宿・パロは自慢の温泉に全ての情熱を注いでおり、風呂のプロフェッショナルを集めている。
風呂のプロたちは主に温泉の配管を管理しており、複数の源泉から1つの大浴場へと繋がる、複雑に入り組んだ配管網を管理・調整している。
</p>

<p>
配管網の管理・調整業務もなかなかに大変なのだが、風呂のプロたちはその合間を縫って、さらに多くの湯を浴槽へと供給できるよう日々努力を積み重ねていた。
結果、風呂のプロたちは「1本だけ配管をオーバーフローさせることができる」という荒技を習得した。
すなわち、自由に配管1本を選び、その配管の湯量の制限をなくすことができるようになったのだ。
</p>

<p>今まで最大湯量を実現する配管網の設定をあなたのプログラムに依存していた風呂のプロたちは、この技術を使ってさらに浴槽への供給湯量を増やすにはどうすればよいか、あなたに再びプログラムを書くよう依頼してきた。</p>


<h3>問題</h3>
<p>
<var>1</var>つの浴槽、<var>K</var>個の源泉、<var>N</var>個の結合点を含む配管網がある。
配管網は<var>M</var>本の配管からなり、配管1つ1つは流すことのできる湯量の制限を持つ。
配管それぞれは湯を流す方向が決められていないので、自由に決めて使ってよい。
<var>N</var>個の結合点では何本かの配管から流れてきた湯をそれ以外の何本かの配管へと自由な配分で流すことができる。
すべての源泉、および浴槽は一部の配管の端点になっており、源泉からの湯量、および結合点での湯量を調整することで源泉から浴槽へと湯を供給している。
</p>

<p>
<var>M</var>個の配管のうち1本だけオーバーフローさせる、すなわち流せる湯量を無限に増やすことで浴槽に供給できるようになる最大湯量はいくらか。
ただし、最大供給湯量を無限に増やすことができる場合も考えられるが、その場合は風呂がオーバーフローしてしまうので、"overfuro"と出力すること。
</p>

<h3>入力形式</h3>
<p>入力は以下の形式で与えられる。</p>
<pre>
<var>K</var> <var>N</var> <var>M</var>
<var>a_1</var> <var>b_1</var> <var>c_1</var>
...
<var>a_M</var> <var>b_M</var> <var>c_M</var>
</pre>

<p>
入力は全て整数からなる。
最初の行では源泉の数<var>K</var>、結合点の数<var>N</var>、配管の数<var>M</var>が与えられる。
続く<var>M</var>行のうち<var>i</var>行目には、<var>i</var>番目の配管の情報を表す3つの整数 <var>a_i</var>, <var>b_i</var>, <var>c_i</var> が与えられる。
これは<var>i</var>番目の配管の両端点がそれぞれ<var>a_i</var>と<var>b_i</var>であり、湯量の制限が<var>c_i</var>であることを示す。
ここで、配管の端点 <var>x</var> が<var>0</var>のときは大浴場、<var>1</var>から<var>K</var>までのときは <var>x</var> 番目の源泉、<var>K+1</var>から<var>K+N</var>までのときは <var>x &minus; K</var> 番目の結合点であることを表す。
</p>

<h3>制約</h3>
<ul>
<li><var>1 &le; K</var></li>
<li><var>0 &le; N</var></li>
<li><var>N+K &le; 100</var></li>
<li><var>1 &le; M &le; (N+K+1)(N+K)</var>/<var>2</var></li>
<li><var>0 &le; a_i, b_i &le; K+N</var></li>
<li><var>a_i &ne; b_i</var></li>
<li><var>1 &le; c_i &le; 5{,}000</var></li>
<li>同じ2端点を持つ配管は2つ以上存在しないことが保証される。</li>
<li>与えられる配管網は、配管をオーバーフローさせることなく最低1以上の湯を源泉から浴槽に供給できることが保証される。</li>
</ul>

<h3>出力形式</h3>
<p>
1本だけ配管をオーバーフローさせて源泉から浴槽への供給湯量を最大化するときの最大供給湯量を1行に出力せよ。
ただし、最大湯量を無限に増やせるときは、"overfuro"と1行に出力せよ。
</p>

<h3>入力例1</h3>
<pre>
2 2 4
1 3 4
2 4 2
0 3 3
4 0 5
</pre>

<h3>出力例1</h3>
<pre>8</pre>

<h3>入力例2</h3>
<pre>
2 3 7
1 0 8
2 0 9
3 0 3
0 4 5
5 0 2
1 3 2
2 4 9
</pre>

<h3>出力例2</h3>
<pre>overfuro</pre>

<h3>入力例3</h3>
<pre>
1 1 2
0 2 1
1 2 1
</pre>

<h3>出力例3</h3>
<pre>1</pre>

<h3>入力例4</h3>
<pre>
5 0 5
0 1 1
0 2 1
0 3 1
0 4 1
0 5 1
</pre>

<h3>出力例4</h3>
<pre>overfuro</pre>