


<link rel="stylesheet" href="css/description.css" type="text/css" />
<script language="JavaScript" type="text/javascript" src="js/varmath.js" charset="UTF-8"></script>


<h2>G: 最小包含矩形 - Minimum Enclosing Rectangle -</h2>

<h3>物語</h3>
<p>
みんなぁ、こんにちは！　八森中ぷろこん部の藍座あいりだよぉ。
突然だけど、あいりがこの前解けなかった問題をみんなに解いて欲しいんだぁ～。
この前部活で<a href="http://judge.u-aizu.ac.jp/onlinejudge/description.jsp?id=1165&amp;lang=jp">ICPC2010のA問題</a>を解いたんだけど、その時の問題が難しかったんだぁ。
</p>

<p>
あ、ICPCについて説明しなきゃ！　ICPCは、い、いんたーなしょなる……ちゅうがくせい……ぷろぐらみんぐ……こんてすとの略で、日本語に直すと、国際中学生対抗プログラミングコンテストらしいよぉ！ あいりにはちょっとむずかしい言葉がいっぱいだよぉ。
あいり達はこの世界大会に出るために毎日頑張ってるんだぁ！
</p>

<p>
部活から帰った後お姉ちゃんにも聞いてみたんだけど、「わ、わからないわ……A問題からわからないなんて……お姉ちゃん失格ね……」って落ち込んじゃって…… 
でも、「『プロ』の人たちが一杯集まるところを知ってるの、お姉ちゃんちょっと連絡してみるわ。あいり、そこで聞いてみなさい！」って言ってここの合宿を教えてもらったんだぁ～ 。
ここに集まる『プロ』のみんなには簡単かもしれないけど……この問題を解いてほしいの！
</p>

<h3>問題</h3>
<p>長さが<var>1</var>の正方形が<var>N</var>個、<var>2</var>次元平面上にある。これら<var>N</var>個の正方形を全て内包する、最小面積の長方形を求めよ。</p>

<h3>入力形式</h3>
<p>入力は<var>N</var>行からなる。</p>

<pre>
<var>N</var>
<var>n_1</var> <var>d_1</var>
<var>n_2</var> <var>d_2</var>
<var>n_3</var> <var>d_3</var>
...
<var>n_{N &minus; 1}</var> <var>d_{N &minus; 1}</var>
</pre>

<p>
最初の行には、正方形の個数<var>N</var>が与えられる。
以下<var>N &minus; 1</var>行は、正方形の置き方を表している。そのうち上から<var>i</var>行目は、空白区切りで1つの整数<var>n_{i}</var>と1つの文字<var>d_{i}</var>が与えられる。これは<var>i</var>番目の正方形の置き方を指示している。ここで正方形の番号付けは、最初の正方形を<var>0</var>番目とし、その後置いた順番に<var>1</var>, <var>2</var>, ..., <var>N &minus; 1</var>と番号付けられるものとする。<var>0</var>番目の正方形に対する置き方の指示はない。
<var>i</var>番目の正方形に対する置き方の指示<var>n_i, d_i</var>は、<var>i</var>番目の正方形を<var>n_i</var>番目の正方形に対して<var>d_i</var>で示される方向に隣接して置くことを指示する。
ここで、<var>n_i</var>は<var>i</var>未満の非負整数である。また、<var>d_i</var>は<var>0,1,2,3</var>のいずれかの値をとり、それぞれ<var>d_i</var>の値が、<var>0</var>ならば左側、<var>1</var>ならば下側、<var>2</var>ならば右側、<var>3</var>ならば上側を表す。
以下にそれぞれの入力例に対応した最終的な正方形の配置を図示している。左から入力例1、入力例2、入力例3、入力例4の最終的な正方形の配置となっている。図中の番号は正方形の番号に相当する。また、図中の緑線は求める最小面積の長方形を示している。
</p>
<img src="https://judgeapi.u-aizu.ac.jp/resources/images/IMAGE3_ACPC2016Day3HUPC_G" width=800>

<h3>制約</h3>
<ul>
<li>入力はすべて整数</li>
<li><var>1 &le; N &le; 100,000</var></li>
<li><var>1 &le; n_i &lt; i</var> (<var>1 &le; i < N</var>)</li>
<li><var>0 &le; d_i &le; 3</var> (<var>1 &le; i < N</var>)</li>
<li>既に正方形が置かれている位置に、新たな正方形を置くような指示は与えられない。</li>
</ul>

<h3>出力形式</h3>
<p>
与えられた<var>N</var>個の点を全て包含する最小面積の長方形の面積を1行で出力する。
出力には<var>10^{&minus;5}</var>以上の誤差を含んではならない。
</p>

<h3>入力例1</h3>
<pre>1</pre>

<h3>出力例1</h3>
<pre>1</pre>

<h3>入力例2</h3>
<pre>
5
0 0
0 1
0 2
0 3
</pre>
<h3>出力例2</h3>
<pre>8</pre>
<h3>入力例3</h3>
<pre>
12
0 0
1 0
2 0
3 1
4 1
5 1
6 2
7 2
8 2
9 3
10 3
</pre>
<h3>出力例3</h3>
<pre>16</pre>
<h3>入力例4</h3>
<pre>
10
0 2
1 2
2 2
3 2
2 1
5 1
6 1
7 1
8 1
</pre>
<h3>出力例4</h3>
<pre>30</pre>