
<!--<script language="JavaScript" type="text/javascript" src="js/varmath.js" charset="UTF-8"></script>-->




<h2>D: みゃんぱすーれつ - Myampus Sequence -</h2>
<h3>物語</h3>
<p>
みゃんぱすー．
ウチ，田舎の分校に通う小学一年生なん．
</p>

<p>
あんなー，今日の授業はプログラミングだったん．
みんな苦戦してたけど，まっつんのにぃにぃ，凄い勢いでタイピングしてたん．
さすが中三なんなー．
</p>

<p>
にぃにぃ，プログラムが完成してどこか行ってしまったん．
そんで，画面見たら，色んな数列が出力されてたん．
だんだん出力と同じような数列を書きたくなったん，ウチ，出力テキストに同じような数列をいくつも書き加えてたん．
そしたら，にぃにぃが戻ってきて，すごい怒られたん．
ウチ，にぃにぃの声初めて聞いたから，びっくりしたん．
</p>

<p>
でな，にぃにぃに謝ってプログラムを見せてもらったん．
プログラムが出力してたん，「みゃんぱすーれつ」いうん．
数列がみゃんぱすーれつか調べて，にぃにぃの機嫌を直したいん．
でも，ウチ，プログラミング初めてなん，教えてほしいのん．
</p>

<h3>問題</h3>
<p><var>N</var> 個の整数からなる数列と <var>M</var> 個の関数からなるプログラムが与えられる．プログラムが開始されると <var>1</var> 番目の関数を呼び出し，この関数の処理が終了すると，プログラムは終了する．また， <var>i</var> (<var>1 &le; i &le; M</var>) 番目の関数は，次のどちらか一方の処理を行い，関数の処理を終了する．</p>

<ul>
<li>整数 <var>a_i</var> を出力する．</li>
<li><var>b_i</var> (<var>1 &le; b_i &le; M</var>) 番目の関数を呼び出し，呼び出した関数の処理が終了したら， <var>c_i</var> (<var>1 &le; c_i &le; M</var>) 番目の関数を呼び出し，呼び出した関数の処理の終了を待つ．</li>
</ul>

<p>どちらの処理を行うかは，処理の度にランダムに決定される．つまり，プログラムが開始されると1個の数列を出力して終了する．ここで，プログラムが出力する数列としてあり得るものを「みゃんぱすーれつ」と定義する．</p>

<p>与えられた数列がみゃんぱすーれつか判定せよ．</p>

<h3>入力形式</h3>
<p>入力は次の形式で与えられる．</p>

<pre>
<var>N</var>
<var>x_1</var> ... <var>x_N</var>
<var>M</var>
<var>a_1</var> <var>b_1</var> <var>c_1</var>
...
<var>a_M</var> <var>b_M</var> <var>c_M</var>
</pre>

<p>
1行目に，判定すべき数列の長さ <var>N</var> が与えられる．
2行目に，判定すべき整数列 <var>x_1</var>, <var>x_2</var>, ..., <var>x_N</var> が順に与えられる．
3行目に，関数の個数 <var>M</var> が与えられる．
<var>i + 3</var> (<var> 1 &le; i &le; M</var>) 行目に， <var>i</var> 番目の関数の情報を表す <var>a_i</var>, <var>b_i</var>, <var>c_i</var> が順に与えられる．
</p>

<p>入力は次の制約を満たす．</p>

<ul>
<li><var>1 &le; N &le; 100</var></li>
<li><var>i = 1, </var>...<var>, N</var> に対して， <var>x_i</var> は <var>0 &le; x_i &le; 9</var> を満たす整数</li>
<li><var>1 &le; M &le; 10</var></li>
<li><var>i = 1, </var>...<var>, M</var> に対して， <var>a_i</var> は <var>0 &le; a_i &le; 9</var> を満たす整数</li>
<li><var>i = 1, </var>...<var>, M</var> に対して， <var>b_i</var> は <var>1 &le; b_i &le; M</var> を満たす整数</li>
<li><var>i = 1, </var>...<var>, M</var> に対して， <var>c_i</var> は <var>1 &le; c_i &le; M</var> を満たす整数</li>
</ul>

<h3>出力形式</h3>
<p>与えれた数列がみゃんぱすーれつの場合には “Yes” と出力し，数列がみゃんぱすーれつではない場合には “No” と出力せよ．また，出力の最後に改行せよ．</p>

<h3>入力例1</h3>
<pre>
3
3 5 3
3
5 2 3
3 3 1
7 1 2
</pre>

<h3>出力例1</h3>
<pre>Yes</pre>

<p>次のようにプログラムが動作すると，与えられた数列を生成します．</p>

<ol>
<li>プログラムが関数 <var>1</var> を呼び出す．</li>
<li>関数 <var>1</var> が関数 <var>2</var> と関数 <var>3</var> を順に呼び出す．</li>
<li>関数 <var>2</var> が <var>3</var> を出力する．</li>
<li>関数 <var>3</var> が関数 <var>1</var> と関数 <var>2</var> を順に呼び出す．</li>
<li>関数 <var>1</var> が <var>5</var> を出力する．</li>
<li>関数 <var>2</var> が <var>3</var> を出力する．</li>
</ol>

<h3>入力例2</h3>
<pre>
10
9 9 9 9 9 9 9 9 9 9
4
6 2 3
7 3 1
8 1 2
9 2 1
</pre>

<h3>出力例2</h3>
<pre>No</pre>

<p>どのような処理を行っても，関数 <var>4</var> を呼び出すことがないので， <var>9</var> を出力することができません．そのため， <var>9</var> を含む数列を出力することはできません．</p>

<h3>入力例3</h3>
<pre>
2
2 4
4
1 2 3
2 1 1
3 4 1
4 1 1
</pre>

<h3>出力例3</h3>
<pre>No</pre>

<p>このプログラムは， <var>2, 4, 1</var> のように， <var>2, 4</var> を含む数列を生成することがありますが， <var>2, 4</var> 自体を生成することはありません．</p>