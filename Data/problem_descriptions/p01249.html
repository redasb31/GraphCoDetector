
<H1><font color="#000">Problem J:</font> Billion Million Thousand</H1>

<p>
A linguist, Nodvic Natharus Damenhof (commonly called <i>Dr. Usoperant</i>), invented an artificial language <i>Usoperant</i> in 2007. The word <i>usoperant</i> means ‘one which tires’. Damenhof’s goal was to create a complex and
pedantic language that would remind many difficulties in universal communications. Talking in Usoperant, you
should remember the importance of choosing your words in many conversations.
</p>
<p>
For example of the complexity, you may be confused by the way to say large numbers. Usoperant has some
words that indicate exponential numbers in decimal, described as 10<sup><i>p</i></sup> where <i>p</i> is a positive integer. In terms of
English, those words might include thousand for 10<sup>3</sup> (1,000), million for 10<sup>6</sup> (1,000,000), and <i>undecillion</i> for
10<sup>36</sup> (1,000,000,000,000,000,000,000,000,000,000,000,000).
</p>
<p>
You can concatinate those words to express larger numbers. When two words <i>w</i><sub>1</sub> and <i>w</i><sub>2</sub> mean numbers 10<sup><i>p</i><sub>1</sub></sup>
and 10<sup><i>p</i><sub>2</sub></sup> respectively, a concatinated word <i>w</i><sub>1</sub><i>w</i><sub>2</sub> means 10<sup><i>p</i><sub>1</sub>+<i>p</i><sub>2</sub></sup>. Using the above examples in English (actually
the following examples are incorrect in English), you can say 10<sup>9</sup> by <i>millionthousand</i>, 10<sup>12</sup> by <i>millionmillion</i>
and 10<sup>39</sup> by <i>undecillionthousand</i>. Note that there can be multiple different expressions for a certain number.
For example, 10<sup>9</sup> can also be expressed by <i>thousandthousandthousand</i>. It is also possible to insert separators
between the adjacent components like <i>million-thousand</i> and <i>thousand-thousand-thousand</i>.
</p>
<p>
In this problem, you are given a few of such words, their representing digits and an expression of a certain number
in Usoperant. Your task is to write a program to calculate the length of the shortest expression which represents
the same number as the given expression.
</p>
<p>
The expressions in the input do not contain any separators like <i>millionthousand</i>. In case of ambiguity, the
expressions should be interpreted as the largest number among possibles. The resultant expressions should
always contain separators like <i>million-thousand</i>, so we can distinguish, for example, <i>x</i>-<i>x</i> (a concatinated word of
two <i>x</i>'s) and <i>xx</i> (just a single word). The separators should not be counted in the length.
</p>

<H2>Input</H2>

<p>
The input consists of multiple test cases. Each test case begins with a line including an integer <i>N</i> (1 &le; <i>N</i> &le; 100).
The integer <i>N</i> indicates the number of words in the dictionary of exponential numbers.
</p>
<p>
The following <i>N</i> lines give the words in the dictionary. Each line contains a word <i>w<sub>i</sub></i> and an integer <i>p<sub>i</sub></i> (1 &le; <i>i</i> &le; <i>N</i>,
1 &le; <i>p<sub>i</sub></i> &le; 10), specifying that the word <i>w<sub>i</sub></i> expresses an exponential number 10<sup><i>p<sub>i</sub></i></sup> in Usoperant. Each <i>w<sub>i</sub></i> consists
of at most 100 alphabetical letters.
</p>
<p>
Then a line which contains an expression of a number in Usoperant follows. The expression consists of at most
200 alphabetical letters.
</p>
<p>
The end of the input is indicated by a line which contains only a single 0.
</p>

<H2>Output</H2>

<p>
For each test case, print a line which contains the case number and the length of the shortest expression which
represents the same number as the given expression in the input.

</p>

<H2>Sample Input</H2>
<pre>
3
billion 9
million 6
thousand 3
billionmillionthousand
3
oku 8
sen 3
man 4
okusenman
2
nico 2
video 4
niconicovideo
6
abcd 1
efgh 2
abcde 4
fgh 6
y 8
yy 10
abcdefgh
0
</pre>

<H2>Output for the Sample Input</H2>
<pre>
Case 1: 14
Case 2: 9
Case 3: 10
Case 4: 2
</pre>

<H2>Note:</H2>
<p>
        In the fourth case, the word <i>abcdefgh</i> can be separated as <i>abcd-efgh</i> (representing 10<sup>3</sup> ) and <i>abcde-fgh</i>
(representing 10<sup>10</sup> ), and by the rule described in the problem statement, this word should be interpreted as 10<sup>10</sup>.
As this number can be expressed by <i>yy</i>, the length of the shortest expression is two (as in the sample output). The
existence of <i>y</i>-<i>y</i> (representing 10<sup>16</sup> ) is not a problem here, because we can distinguish <i>yy</i> and <i>y</i>-<i>y</i> as long as we
always use separators.
</p>

