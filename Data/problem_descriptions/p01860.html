
<!--<script language="JavaScript" type="text/javascript" src="js/varmath.js" charset="UTF-8"></script>-->



<h2>C: 買い出し - Shopping -</h2>

<h3>物語</h3>
<p>磯野の姉であるサゾエさんは，『あれ』や『あれ』で遊んでいる磯野と中島のために夕食を作ってあげることにしました．あいにく，冷蔵庫には食材が残り僅かしか無く，サゾエさんは買い出しに行くことにしました．幾つか食材を買おうとしているサゾエさんですが，大変陽気であるため一度に一品のみレジで会計してしまいます．このままでは遊んでいた磯野と中島が買い物を終える前に帰ってきてしまい，夕食を準備することが出来ないかもしれません．そこで，サゾエさんの友人であるあなたは，サゾエさんのためにサゾエさんの買い物にかかる最小の時間を求めてください．</p>

<h3>問題</h3>
<p>とあるスーパーに<var>N</var>個のレジがあり，それぞれ<var>1</var>〜<var>N</var>までの番号がついている．</p>

<p>また，客が<var>M</var>人居て，それぞれ<var>1</var>〜<var>M</var>までの番号がついている．<var>i</var>番目の客は，時刻<var>a_i</var>に<var>c_i</var>番目のレジに並び，会計に<var>b_i</var>の時間がかかる．1人の客は一度だけ会計をする．</p>

<p>ここで，ある客が並んだレジに既に人が並んでいる場合，その客は既に並んでいる人全員の会計が終了した後に会計をする．<var>i</var>番目の客と，<var>i+1</var>番目の客が同じレジに並んでいたとすると，<var>i</var>番目の客の会計開始時刻が<var>t</var>であった場合，<var>i</var>番目の客の会計終了時刻は<var>t+b_i</var>，<var>i+1</var>番目の客の会計開始時刻は<var>t+b_i</var>，そして，<var>i+1</var>番目の客の会計終了時刻は，<var>t+b_i+b_{i+1}</var>となる．</p>

<p>サゾエさんは1人の客である．しかし，サゾエさんは例外的に<var>K</var>回会計をする．また，会計にかかる時間は0，すなわちサゾエさんの会計開始時刻を<var>t</var>とすると，会計終了時刻は<var>t</var>となり，次の客の会計開始時刻は<var>t</var>となる．その後，サゾエさんが再度レジに並ぶ際，会計終了時刻<var>t</var>から品定めにかかる時間<var>D</var>だけ経ってから並ばなければいけない．つまり，再度レジに並ぶことができる時刻は<var>t+D</var>となる．</p>

<p>また，サゾエさんは時刻<var>S</var>にスーパーにやって来る．そして，時刻<var>S</var>から<var>D</var>だけ経った時刻<var>S+D</var>に，初めてサゾエさんはレジに並ぶことが出来る．</p>

<p><var>N</var>，<var>M</var>，<var>K</var>，<var>D</var>，<var>S</var>と，<var>1</var>番目〜<var>M</var>番目までの客の情報がそれぞれ与えられるので，サゾエさんがスーパーに来てから最後の会計を終えるまでにかかる時間の最小値を求めよ．この時，異なる2人の客が同じ時刻に同じレジに並ぶことは無いとし，サゾエさんとほかの人が同時にレジに並ぼうとした場合，サゾエさんは常にほかの客に順番を譲ることとする．</p>

<h3>入力形式</h3>
<p>入力は次の形式で与えられる．</p>

<pre>
<var>N</var> <var>M</var> <var>K</var> <var>D</var> <var>S</var>
<var>a_1</var> <var>b_1</var> <var>c_1</var>
...
<var>a_M</var> <var>b_M</var> <var>c_M</var>
</pre>

<p>1行目にスーパーにあるレジの数<var>N</var>（<var>1 &le; N &le; 10^{15}</var>），訪れる客の数<var>M</var>(<var>1 &le; M &le; 10^5</var>)，サゾエさんがレジを回る回数<var>K</var>(<var>1 &le; K &le; 10^4</var>)，サゾエさんの品定めにかかる時間<var>D</var>(<var>1 &le; D &le; 10^4</var>)，サゾエさんがスーパーに来る時刻<var>S</var>(<var>1 &le; S &le; 10^4</var>)が空白区切りで与えられる．</p>

<p>続く<var>M</var>行に訪れる客の情報が与えられる．<var>M</var>行のうち，<var>i</var>(<var>1 &le; i &le; M</var>)行目には，<var>i</var>番目の客がレジに来る時刻<var>a_i</var>(<var>1 &le; a_i &le; 10^4</var>)，会計にかかる時間<var>b_i</var>(<var>1 &le; b_i &le; 10^4</var>)，やって来るレジの番号<var>c_i</var>(<var>1 &le; c_i &le; N</var>)が空白区切りで与えられる．ここで<var>2 &le; M</var>の時，全ての<var>i</var>(<var>1 &le; i &le; M&minus;1</var>)について，<var>a_i &le; a_{i+1}</var>が成立する．</p>

<p>なお，入力が非常に大きくなる場合があるため，入力の受け取りには高速な関数を用いることを推奨する．</p>

<h3>出力形式</h3>
<p>サゾエさんがスーパーに来てから最後の会計を終えるまでにかかる時間の最小値を1行で出力せよ．</p>

<h3>入力例1</h3>
<pre>
3 9 3 2 3
1 2 3
1 1 2
2 3 1
3 4 2
4 1 3
4 1 1
5 1 1
6 2 3
7 2 2
</pre>

<h3>出力例1</h3>
<pre>6</pre>

<p>
時間5にレジ3，時間7にレジ1，時間9にレジ2に並ぶ．
サゾエさんの入店時間が時間3なので初めてレジに並んでから時間6で3回の会計が終了する．
また，時間9に並ぶレジはレジ1，もしくはレジ3でも最適解になる
</p>

<h3>入力例2</h3>
<pre>
3 9 3 1 3
1 2 3
1 1 2
2 3 1
3 4 2
4 1 3
4 1 1
5 1 1
6 2 3
7 2 2
</pre>

<h3>出力例2</h3>
<pre>5</pre>

<h3>入力例3</h3>
<pre>
1 3 3 2 1
1 1 1
2 2 1
3 2 1
</pre>


<h3>出力例3</h3>
<pre>9</pre>