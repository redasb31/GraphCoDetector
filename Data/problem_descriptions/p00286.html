


<h1>古代遺跡の謎</h1>

<p>
古代遺跡から超大型あみだくじが発見された。学者達はこれをVLA(Very Long Amidakuji)と命名した。分析の結果、VLAは <var>N</var> 本の縦棒を持ついくつかの部品の組み合わせで構成され、多くの場合繰り返しを含んでいることがわかった。例えば、図のVLAは２種類の部品AとBを使った４つの部品から構成されている。
</p>

<center>
<img src="https://judgeapi.u-aizu.ac.jp/resources/images/IMAGE2_PCK2013_monument" width="400">
</center>

<p>
このVLAの上端に左から順番に 1,2,3,4,5 と番号をつけ、それぞれの番号からVLAをたどり（あみだくじのたどり方については問題文最後の補足を参照してください)、下端にたどり着いた場所の縦棒にその番号を振る。すべての番号についてたどり終えた後で、下端に振られた番号を左から読むと 4,2,5,1,3 になる。このように、1,2,3,4,5 という番号の列が 4,2,5,1,3 という列に変換される。
</p>

<p>
彼らはVLAによって 1 から <var>N</var> までの番号の列がどのように変換されるのかを知りたいが、手作業でたどるのは大変そうだ。そこでパソコン甲子園出場者である優秀なプログラマーの君たちに、VLAのシミュレーションを依頼した。
</p>

<p>
VLAはとても長いため、そのままの状態ではプログラマーたちに情報を伝えることができない。そこで学者たちは、部品の種類を英大文字１つで表し、VLAを式で表現することにした。
</p>

<p>
部品は同じ位置関係である縦棒が一致するように、左から順番に <span>+<span> 演算子で接続される。たとえば、上からA,B,C,D という順番で連結された部品の列は <span>A+B+C+D</span> という式で表記される。
</p>

<p>
部品の列を表す式 <var>seq</var> の <var>m</var> 回の繰り返しは、<var>m</var>(<var>seq</var>) と表記できる。たとえば、<span>A+B</span> の2回の繰り返しは <span>2(A+B)</span> と表せ、これは <span>A+B+A+B</span> と同じである。また、<var>seq</var> が１つの部品 <var>a</var> の場合は、<var>a</var> を囲むかっこを省略しても構わない。<span>4(A+B)</span> と <span>3(X+Y)</span> を、この順番で連結したVLAは <span>4(A+B)+3(X+Y)</span> と表せる。また、かっこは <span>2(4(A+B)+3(X+Y))+10C</span> のように入れ子にしても構わない。
</p>

<p>
それでは、縦棒の数 <var>N</var>、各部品の情報、複数のVLAの式を入力とし、各式が表すVLAによって1から <var>N</var> までの番号の列がどのように変換されるかを出力するプログラムを作成しなさい。
</p>

<p>
（※補足：あみだくじのたどり方について）<br>
あみだくじのある縦棒の上端から出発して上から下へ進む。ただし、横棒がある地点ではその横棒でつながった別の縦棒に移動する。これを、縦棒の下端にたどり着くまで繰り返す。
</p>


<h2>入力</h2>
<p>
入力は１つのデータセットからなる。入力データは以下の形式で与えられる。
</p>

<pre>
<var>N</var> <var>K</var>
<var>p<sub>1</sub></var> <var>h<sub>1</sub></var>
<var>g</var><sub>1</sub>(1,1) <var>g</var><sub>1</sub>(1,2) .. <var>g</var><sub>1</sub>(1,<var>N</var>-1)
<var>g</var><sub>1</sub>(2,1) <var>g</var><sub>1</sub>(2,2) .. <var>g</var><sub>1</sub>(2,<var>N</var>-1)
:
<var>g</var><sub>1</sub>(<var>h</var><sub>1</sub>-1,1) <var>g</var><sub>1</sub>(<var>h</var><sub>1</sub>-1,2) .. <var>g</var><sub>1</sub>(<var>h</var><sub>1</sub>-1,<var>N</var>-1)
<var>p<sub>2</sub></var> <var>h<sub>2</sub></var>
<var>g</var><sub>2</sub>(1,1) <var>g</var><sub>2</sub>(1,2) .. <var>g</var><sub>2</sub>(1,<var>N</var>-1)
<var>g</var><sub>2</sub>(2,1) <var>g</var><sub>2</sub>(2,2) .. <var>g</var><sub>2</sub>(2,<var>N</var>-1)
:
<var>g</var><sub>2</sub>(<var>h</var><sub>2</sub>-1,1) <var>g</var><sub>2</sub>(<var>h</var><sub>2</sub>-1,2) .. <var>g</var><sub>2</sub>(<var>h</var><sub>2</sub>-1,<var>N</var>-1)
:
<var>p<sub>K</sub></var> <var>h<sub>K</sub></var>
<var>g<sub>K</sub></var>(1,1) <var>g<sub>K</sub></var>(1,2) .. <var>g<sub>K</sub></var>(1,<var>N</var>-1)
<var>g<sub>K</sub></var>(2,1) <var>g<sub>K</sub></var>(2,2) .. <var>g<sub>K</sub></var>(2,<var>N</var>-1)
:
<var>g<sub>K</sub></var>(<var>h<sub>K</sub></var>-1,1) <var>g<sub>K</sub></var>(<var>h<sub>K</sub></var>-1,2) .. <var>g<sub>K</sub></var>(<var>h<sub>K</sub></var>-1,<var>N</var>-1)
<var>E</var>
expression<sub>1</sub>
expression<sub>2</sub>
:
expression<var><sub>E</sub></var>
</pre>

<p>
1行目に縦棒の数を表す整数 <var>N</var> (2 &le; <var>N</var> &le; 12) と部品の種類の数 <var>K</var> (1 &le; <var>K</var> &le; 26)が与えられる。
</p>

<p>
2行目以降に <var>K</var> 種類の部品の情報が与えられる。各部品は以下の形式で与えられる。
</p>
<ul>
<li> 最初の行は部品名を表す１つの英大文字 <var>p<sub>i</sub></var> と部品 <var>i</var> の縦棒の長さを表す整数 <var>h<sub>i</sub></var> (1 &le; <var>h<sub>i</sub> &le; 20)を含む。</li>
<li> 続く<var>h<sub>i</sub></var>-1 行で部品 <var>i</var> の横棒の情報が与えられる。<var>g<sub>i</sub></var>(<var>r, c</var>) は部品 <var>i</var> の上端から長さ <var>r</var> の位置において、左から <var>c</var> 番目の縦棒と <var>c</var>+1 番目の縦棒をつなぐ横棒の有無を表す。横棒があるときは <var>g<sub>i</sub></var>(<var>r</var>, <var>c</var>) = 1、横棒がないときは <var>g<sub>i</sub></var>(<var>r</var>, <var>c</var>) = 0である。
</ul>

<p>
続く１行に式の数 <var>E</var> (1 &le; <var>E</var> &le; 100) が与えられる。続く <var>E</var> 行にVLAの式を表す文字列 expression<sub><var>i</var></sub>（1文字以上1000文字以下）が与えられる。
</p>

<p>
入力は以下の条件を満たす。
</p>
<ul>
<li> 異なる部品に同じ名前が使われることはない。 </li>
<li> 各部品 <var>i</var> について、<var>g<sub>i</sub></var>(<var>r</var>, <var>c</var>)と <var>g<sub>i</sub></var>(<var>r</var>, <var>c</var>+1)が同時に 1 となることはない。</li>
<li> 式に含まれる整数は 1 以上 1,000,000,000 以下である。</li>
<li> 式には空白は含まれない。</li>
</ul>

<h2>出力</h2>

<p>
式ごとに、VLAによる1からNまでの列の変換結果を１行に出力する。それぞれの数字の間は空白1つで区切る。
</P>

<h2>入出力例</h2>
<br>

<h2>入力例</h2>
<pre>
5 2
A 5
1 0 0 1
0 1 0 0
1 0 1 0
0 1 0 1
B 4
1 0 0 1
0 1 0 0
0 0 1 0
2
2(A+B)
1000000000(1000000000A+1000000000B)
</pre>

<h2>出力例</h2>
<pre>
4 2 5 1 3
1 2 3 4 5
</pre>