<style type="text/css">
    blockquote {
        font-family: Menlo, Monaco, "Courier New", monospace;
        display: block;
        margin: 10px 0 10px 30px;
        font-size: 16px;
        line-height: 18px;
        white-space: pre;
        white-space: pre-wrap;
        word-break: break-all;
        word-wrap: break-word;
    }
    table.ioexample {
        width: 100%;
        border-collapse: collapse;
    }
    table.ioexample td {
        width: 50%;
        border: 1px solid rgba(0, 0, 0, 0.15);
        vertical-align: top;
        padding: 5px;
    }
    .no-page-break {
        page-break-inside: avoid;
    }
    .page-break {
        page-break-before: always;
    }
</style>
<h3>Problem Statement</h3>
<p>You have a grid with $H$ rows and $W$ columns. Each cell contains one of the following 11 characters: an addition operator <code>+</code>, a multiplication operator <code>*</code>, or a digit between $1$ and $9$. </p>
<p>There are paths from the top-left cell to the bottom-right cell by moving right or down $H+W-2$ times. Let us define the value of a path by the evaluation result of the mathematical expression you can obtain by concatenating all the characters contained in the cells on the path in order.
Your task is to compute the sum of values of any possible paths. Since the sum can be large, find it modulo $M$.</p>
<p>It is guaranteed the top-left cell and the bottom-right cell contain digits. Moreover, if two cells share an edge, at least one of them contains a digit. In other words, each expression you can obtain from a path is mathematically valid.</p>
<hr />
<h3>Input</h3>
<p>The input consists of a single test case in the format below.</p>
<blockquote>$H$ $W$ $M$
$a_{1,1}$ $\cdots$ $a_{1,W}$
$\ldots$
$a_{H,1}$ $\cdots$ $a_{H,W}$</blockquote>
<p>The first line consists of three integers $H$, $W$ and $M$ ($1 \le H,W \le 2 000$, $2 \le M \le 10^{9}$).The following $H$ lines represent the characters on the grid. $a_{i,j}$ represents the character contained in the cell at the $i$-th row and $j$-th column. Each $a_{i,j}$ is either <code>+</code>, <code>*</code>, or a digit between $1$ and $9$. $a_{1,1}$ and $a_{H,W}$ are both digits. If two cells share an edge, at least one of them contain a digit.</p>
<h3>Output</h3>
<p>Print the sum of values of all possible paths modulo $M$.</p>
<p><div class="no-page-break"><h3>Examples</h3><table class="ioexample"><tr><th>Input</th><th>Output</th></tr><tr><td><pre>2 3 1000
3*1
+27
</pre></td><td><pre>162
</pre></td></tr><tr><td><pre>4 4 3000000
24+7
*23*
9+48
*123
</pre></td><td><pre>2159570
</pre></td></tr></table></div></p>
