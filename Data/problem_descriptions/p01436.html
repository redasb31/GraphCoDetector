

<script type="text/javascript" src="./varmath.js" charset="UTF-8"></script>
<h2>問題文</h2>
<p>
<i>キュゥべえ</i>はなかなか契約を結んでくれない<i>鹿目まどか</i>にしびれを切らせて，ソウルジェムゲームと称して<i>佐倉杏子</i>と<i>美樹さやか</i>のソウルジェムの中身 (魂) を <var>W</var> 列 <var>H</var> 段のロッカーの中に隠してしまった．そこで，<i>まどか</i>は<i>杏子</i>と<i>さやか</i>を助け出したい．しかし，契約を結ばずに助けるにはロッカーボックスの壁を操作して <var>2</var> 人のソウルジェムの中身を，指定されたロッカーボックスに正しく移さなければならない．ロッカーはロッカーボックスが <var>W</var> 列 <var>H</var> 段に並ぶことで構成され，隣り合うロッカーボックスは壁で仕切られている．
</p>
<p>
<i>まどか</i>は，<var>1</var> 回の操作でいずれかの隣りあった <var>2</var> つのロッカーボックスの壁を取り除くか取り付けることができる．ただし，ロッカーボックスの壁を開けるには制約があり，各ロッカーボックスから隣接する上下左右の壁のうち，高々 <var>2</var> 枚までの壁しか同時に開けておくことはできない．ロッカーボックスには上の段から下の段に向かって重力が働いている．ソウルジェムの中身は液体と同じような動きをし，隣りあった <var>2</var> つのロッカーボックスの壁が取り除かれている時，同じ高さであれば互いに同じ量になり，違う高さであれば低い方へ移動する．すべての操作が終わった時に指定された <var>2</var> つのロッカーボックスに正しい組み合わせでソウルジェムの中身がすべて入っていれば<i>まどか</i>の勝利となる．また，一部のロッカーボックスは穢れており，その中へソウルジェムの中身が入ってしまうと大変なことになってしまうので，そのロッカーボックスはソウルジェムの中身の移動のために使うことはできない．
</p>
<p>
最小で何度の操作を行えば<i>まどか</i>は <var>2</var> 人を救いだすことができるかを求めよ．
</p>
<h2>入力形式</h2>
<p>入力は以下の形式で与えられる．</p>
<pre><var>H\ W\\
s_{11}\ s_{12}\ … s_{1W}\\
s_{21}\ s_{22}\ … s_{2W}\\
…\\
s_{H1}\ s_{H2}\ … s_{HW}\\
</var></pre>
<p><var>H</var> はロッカーの段数，<var>W</var> はロッカーの列数である．<var>s_{ij}</var> は上から <var>i</var> 段目の左から <var>j</var> 列目のロッカーボックスの状態を表す．<i>杏子</i>のソウルジェムの中身が入っているときは <code>'K'</code> であり，<i>さやか</i>のソウルジェムの中身が入っているときは <code>'S'</code> ，<i>杏子</i>のソウルジェムの中身を移すべきロッカーボックスであるときは <code>'k'</code>，<i>さやか</i>のソウルジェムの中身を移すべきロッカーボックスであるときは <code>'s'</code>，穢れたロッカーボックスであるときは <code>'#'</code>，それ以外のロッカーボックスであるときは <code>'.'</code> である．</p>

<h2>出力形式</h2>
<var>2</var> 人を救い出すために必要な操作の最小回数を出力せよ．どのように操作しても救い出すことが出来ない場合は <code>CONTRACT</code> と出力せよ．

<h2>制約</h2>
<ul>
<li><var>1 &le; H &le; 10</var></li>
<li><var>1 &le; W &le; 10</var></li>
<li><var>s_{ij}</var> は <code>'#'</code>, <code>'.'</code>, <code>'S'</code>, <code>'K'</code>, <code>'s'</code>, <code>'k'</code> のいずれかである．</li>
<li><var>s_{ij}\ =\ </var><code>'S'</code> であるような <var>i, j</var> がちょうど 1 つだけ存在する．</li>
<li><var>s_{ij}\ =\ </var><code>'K'</code> であるような <var>i, j</var> がちょうど 1 つだけ存在する．</li>
<li><var>s_{ij}\ =\ </var><code>'s'</code> であるような <var>i, j</var> がちょうど 1 つだけ存在する．</li>
<li><var>s_{ij}\ =\ </var><code>'k'</code> であるような <var>i, j</var> がちょうど 1 つだけ存在する．</li>
</ul>

<h2>入出力例</h2>
<h3>入力例 1</h3>
<pre>4 4
.S..
K...
....
..sk</pre>

<h3>出力例1</h3>
<pre>9</pre>

<h3>入力例 2</h3>
<pre>5 5
.S.K.
..#..
.###.
..#..
.k.s.</pre>

<h3>出力例 2</h3>
<pre>CONTRACT</pre>

<h3>入力例 3</h3>
<pre>8 5
S....
####K
##...
#..##
#..##
##k##
#...#
#.s.#</pre>

<h3>出力例 3</h3>
<pre>19</pre>

<h3>入力例 4</h3>
<pre>8 5
S....
####K
##...
##.##
##.##
##k##
#...#
#.s.#</pre>

<h3>出力例 4</h3>
<pre>CONTRACT</pre>

<h3>入力例 5</h3>
<pre>10 10
..........
##......##
#K......S#
..........
..........
.#..##..#.
..##..##..
..........
..........
....s.k...</pre>

<h3>出力例 5</h3>
<pre>22</pre>

<h3>入力例 6</h3>
<pre>3 3
S.s
K..
..k</pre>

<h3>出力例 6</h3>
<pre>CONTRACT</pre>

<hr>
<address>Problem Setter: Flat35</address>