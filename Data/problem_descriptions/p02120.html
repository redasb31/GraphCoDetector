


<script type="text/x-mathjax-config">
 MathJax.Hub.Config({ tex2jax: { inlineMath: [["$","$"], ["\\(","\\)"]], processEscapes: true }});
</script>

<script language="JavaScript" type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML">
</script>

<h1>Problem J: Cluster Network</h1>

<h2>Problem</h2>
<p>マイヅ大学にある大規模クラスタ<sup>†</sup>型スーパーコンピュータ（通称「SAKURA」）のクラスタは、$N$台のコンピュータ（ノード）と$M$本の相互に通信が可能な物理的通信路で構成される。また、各ノードにはそれぞれ1から$N$までの識別番号が割り当てられている。</p>

<p>この度SAKURAの利用を大学関係者だけでなく、県内の企業にも認めることとなった。それに伴い、SAKURAを構成する各ノードを点検する必要がある。しかし、SAKURAの利用スケジュールは数ヶ月先まで埋まっているので、点検中もシステム全体を停止させることはできない。そこで、ノードを1日に1台ずつ順番に点検する。</p>

<p>点検は$N$日にわたって行われ、$i$日目にノード$i$を点検する。このとき、点検するノードとそのノードに直接接続されている通信路をSAKURAのクラスタから切り離す。それによって、SAKURAのクラスタ全体は1つ以上のクラスタに分断されるので、そのうちのいずれかをSAKURAの代わりに運用する。当然、点検中のノードは運用することができない。</p>

<p>複数のクラスタに分断された場合、それらの中で最も「総合性能値」の高いクラスタのみを運用する。各クラスタの「総合性能値」はそれを構成する各ノードに設定された「単体性能値」の和である。</p>

<p>SAKURAを構成するノードの数、通信路の本数と各ノードに設定された「単体性能値」が与えられるので、$i$日目の点検中に運用されるクラスタの「総合性能値」を出力せよ。</p>

<p>†：クラスタとは、1つ以上のコンピュータを結合してひとまとまりにしたシステムのこと。ここでは、物理的通信路で連結なノードの集合とする。</p>

<h2>Input</h2>
<p>入力は以下の形式で与えられる。</p>
<p>
$N$ $M$<br>
$w_1$ $w_2$ ... $w_N$<br>
$u_1$ $v_1$<br>
$u_2$ $v_2$<br>
...<br>
$u_M$ $v_M$<br>
</p>
<p>
    1行目にクラスタを構成するノードの数$N$と通信路の本数$M$が空白区切りで与えられる。<br>
    2行目には各ノードの「単体性能値」を表す$N$個の整数が空白区切りで与えられる。$i$番目の整数$w_i$はノード$i$の「単体性能値」を表す。<br>
    3行目からの$M$行には各通信路がつなぐ2つのノードの識別番号が空白区切りで与えられる。2+$i$行目の入力では、通信路がノード$u_i$とノード$v_i$を相互につなぐことを表す。
</p>

<h2>Constraints</h2>
<p>入力は以下の条件を満たす。</p>
<ul>
    <li>$2 \leq N \leq 10^5$</li>
    <li>$N-1 \leq M \leq min(\frac{N\times(N-1)}{2},10^5)$</li>
    <li>$1 \leq w_i \leq 10^6$</li>
    <li>$1 \leq u_i, v_i \leq N, u_i \ne v_i$</li>
    <li>$(u_i,v_i) \ne (u_j,v_j), (u_i,v_i) \ne (v_j,u_j), i \ne j$</li>
    <li>入力は全て整数</li>
</ul>

<h2>Output</h2>
<p>出力は$N$行からなる。<br>$i$行目には、$i$日目に運用されるクラスタの「総合性能値」を出力する。</p>

<h2>Sample Input 1</h2>
<pre>
9 10
1 2 3 4 5 6 7 8 9
1 2
2 3
2 4
3 4
4 5
4 6
2 7
7 8
7 9
9 1
</pre>

<h2>Sample Output 1</h2>
<pre>
44
25
42
30
40
39
30
37
36
</pre>

<h2>Sample Input 2</h2>
<pre>
16 19
1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16
1 2
2 3
3 4
3 5
1 6
6 7
6 8
7 8
8 9
8 10
10 11
11 12
12 10
1 13
13 14
14 15
15 13
14 16
15 16
</pre>

<h2>Sample Output 2</h2>
<pre>
63
122
124
132
131
73
129
86
127
103
125
124
78
122
121
120
</pre>

<h2>Sample Input 3</h2>
<pre>
2 1
1 2
1 2
</pre>

<h2>Sample Output 3</h2>
<pre>
2
1
</pre>