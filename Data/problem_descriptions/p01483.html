
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html>
<body>
<h1> Elevator</h1>
<p>
Time Limit: 8 sec / Memory Limit: 64 MB
</p>
<h2> E: エレベータ</h2>
<p>
あなたの友人は，キリンのマークの引越業者でアルバイトをしている．
彼の仕事は，建物から荷物を運び出すことである．
</p>
<p>
今回，彼はある<i>n</i>階建てのビルからいくつかの荷物を運び出すことになった．
幸い，このビルにはエレベータが1つ備え付けられているため，
エレベータで荷物を運び出すことにした．
</p>
<p>
運び出すべき荷物は，各階に複数個あり，荷物毎に重さが異なる．
エレベータには，重量制限が設定されており，重さ<i>W</i>を超える荷物を載せることはできない．
エレベータは十分に広く，重量制限を満たすならば，どれだけ多くの荷物でも載せることができる．
</p>
<p>
エレベータは停止した階で荷物の搬入と搬出を行うことができる．
ベテランアルバイターである彼は，エレベータに乗らずに，階段で移動する．
エレベータに荷物を積み込んだ後，階段で次のエレベータの停止フロアに先回りし，荷物の搬入と搬出を行うのだ．
ベテランアルバイターの彼は，荷物の搬入と搬出を非常に高速に行うことができるので，各フロアでのエレベータの停止時間は，無視することができる．
よって，全ての荷物を1階に移動させるのに必要な時間は，エレベータの移動距離から容易に算出できる．
</p>
<p>
彼は，荷物をできるだけ早く1階に移動させたい．
彼はベテランアルバイターではあるが，どのような手順で各階での荷物の出し入れを行えばよいのか分からない．
そこで，彼は，友人であるあなたに助けを求めてきた．
</p>
<p>
あなたの仕事は，彼が全ての荷物を1階に移動させるために必要なエレベータの最小の移動距離を求めることである．
</p>
<h2> Input</h2>
<p>
入力は以下の形式で与えられる．
</p>
<pre>
<i>n m W</i>
1階の荷物の情報
...
<i>i</i> 階の荷物の情報
...
<i>n</i> 階の荷物の情報
</pre>
<p>

<i>i</i>階の荷物の情報は，以下の形式で与えられる．(1 &lt;= <i>i</i> &lt;= <i>n</i>)
</p>
<pre>
<i>k<sub>i</sub></i> <i>w<sub>1</sub></i> <i>w<sub>2</sub></i>, ..., <i>w<sub>j</sub></i>, ..., <i>w<sub>k<sub>i</sub></sub></i>
</pre>
<p>

入力の形式の各変数の意味は次の通りである．
</p>
<ul>
<li> <i>n</i> はフロア数(1 &lt;= <i>n</i> &lt;= 10000)</li>
<li> <i>m</i> はエレベータの初期位置(1 &lt;= <i>m</i> &lt;= n)</li>
<li> <i>W</i> はエレベータの重量制限(1 &lt;= <i>W</i> &lt;= 10000)</li>
<li> <i>k<sub>i</sub></i> は荷物の数(0 &lt;= <i>k<sub>i</sub></i> &lt;= 15, 1 &lt;= <i>k<sub>1</sub></i> + <i>k<sub>2</sub></i> + ... + <i>k<sub>n</sub></i> &lt;= 15)</li>
<li> <i>w<sub>j</sub></i> は荷物 <i>j</i> の重さ(1 &lt;= <i>w<sub>j</sub></i> &lt;= <i>W</i>)</li>
</ul>
<h2> Output</h2>
<p>
最小の移動距離を1行で出力せよ．
</p>
<h2> Sample Input 1</h2>
<pre>
3 3 2
1 1
2 1 1
3 1 1 1
</pre>
<h2> Sample Output 1</h2>
<pre>
8
</pre>
<h2> Sample Input 2</h2>
<pre>
3 3 10
0
2 4 5
3 3 3 5
</pre>
<h2> Sample Output 2</h2>
<pre>
6
</pre>
<h2> Sample Input 3</h2>
<pre>
3 3 100
5 3 4 5 6 7
0
0
</pre>
<h2> Sample Output 3</h2>
<pre>
0
</pre>
</body>
</html>