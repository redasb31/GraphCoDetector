


<script type="text/x-mathjax-config">
 MathJax.Hub.Config({ tex2jax: { inlineMath: [["$","$"], ["\\(","\\)"]], processEscapes: true }});
</script>

<script language="JavaScript" type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML">
</script>

<h1>Problem M: Fissure Puzzle Hard</h1>

<h2>Problem</h2>
<p>$N \times N$個のマスから成るグリッドがある。最初すべてのマスは白色である。以下の手順に従って黒色のマスを増やしていく。</p>

<p>上から偶数番目かつ、左から偶数番目であるマスの中で、白色のマスを1つ選ぶ。選んだマスは黒色に変化する。さらに、そのマスの上下左右それぞれの方向について、隣接している白色のマスも連鎖的に黒色に変化する。この連鎖はその方向に白色のマスが存在しなくなるまで続く。(以下に例を示す)</p>
<p>
□□□□□□□□□<br>
□□□□□□□□□<br>
□□□□□□□□□<br>
□□□□□□□□□<br>
□□□□□□□□□<br>
□□□□□□□□□<br>
□□□□□□□□□<br>
□□□□□□□□□<br>
□□□□□□□□□<br>
↓上から4番目、左から6番目を選ぶ<br>
□□□□□■□□□<br>
□□□□□■□□□<br>
□□□□□■□□□<br>
■■■■■■■■■<br>
□□□□□■□□□<br>
□□□□□■□□□<br>
□□□□□■□□□<br>
□□□□□■□□□<br>
□□□□□■□□□<br>
↓上から2番目、左から2番目を選ぶ<br>
□■□□□■□□□<br>
■■■■■■□□□<br>
□■□□□■□□□<br>
■■■■■■■■■<br>
□□□□□■□□□<br>
□□□□□■□□□<br>
□□□□□■□□□<br>
□□□□□■□□□<br>
□□□□□■□□□<br>
↓上から6番目、左から8番目を選ぶ<br>
□■□□□■□□□<br>
■■■■■■□□□<br>
□■□□□■□□□<br>
■■■■■■■■■<br>
□□□□□■□■□<br>
□□□□□■■■■<br>
□□□□□■□■□<br>
□□□□□■□■□<br>
□□□□□■□■□<br>
</p>

<p>
あなたは上から$i$番目で左から$j$番目のマスの色が$A_{i,j}$であるグリッドを作りたい。
作ることが可能かどうかを判定せよ。可能な場合は、選ぶべきマスの場所と順番を求めよ。
</p>

<h2>Input</h2>
<p>入力は以下の形式で与えられる。</p>
<p>
$N$<br>
$A_{1,1}$ $A_{1,2}$ ... $A_{1,N}$<br>
$A_{2,1}$ $A_{2,2}$ ... $A_{2,N}$<br>
...<br>
$A_{N,1}$ $A_{N,2}$ ... $A_{N,N}$<br>
</p>

<p>
  $A_{i,j}$が'o'であるときは上から$i$番目、左から$j$番目のマスが白色であることを表し、'x'のときは黒色のマスであることを表す。
</p>

<h2>Constraints</h2>
<p>入力は以下の条件を満たす。</p>
<ul>
    <li>$3 \le N \le 2047$</li>
    <li>$N$は奇数である</li>
    <li>$A_{i,j}$は'o'か'x'である</li>

</ul>

<h2>Output</h2>
<p>
  不可能な場合は-1と1行に出力せよ。
  可能な場合は1行目に選ぶマスの個数を出力し、
  $i \times 2$行目には$i$番目に選択するマスが上から何番目なのかを、
  $i \times 2 + 1$行目には$i$番目に選択するマスが左から何番目なのかを出力せよ。
  一意に定まらない場合は辞書順で最小になるようにせよ。
</p>

<h2>Sample Input 1</h2>
<pre>
5
oxooo
oxooo
oxooo
xxxxx
oxooo
</pre>

<h2>Sample Output 1</h2>
<pre>
1
4
2
</pre>

<h2>Sample Input 2</h2>
<pre>
9
oxoooooxo
oxxxxxxxx
oxoooooxo
xxxxxxxxx
oxoxooooo
oxxxxxxxx
oxoxoxooo
oxoxxxxxx
oxoxoxooo
</pre>

<h2>Sample Output 2</h2>
<pre>
4
4
2
2
8
6
4
8
6
</pre>

<h2>Sample Input 3</h2>
<pre>
3
oxx
oxx
ooo
</pre>

<h2>Sample Output 3</h2>
<pre>
-1
</pre>