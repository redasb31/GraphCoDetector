

<H1>
<font color="#000">Problem F:</font> Name the Crossing
</H1>

<P>
The city of Kyoto is well-known for its Chinese plan: streets are
either North-South or East-West. Some streets are numbered, but most
of them have real names.
<br>
Crossings are named after the two streets crossing there,
e.g. Kawaramachi-Sanjo is the crossing of Kawaramachi street and Sanjo
street. But there is a problem: which name should come first?
At first the order seems quite arbitrary: one says Kawaramachi-Sanjo
(North-South first) but Shijo-Kawaramachi (East-West first). With some
experience, one realizes that actually there
seems to be an "order" on the streets, for instance in the above
Shijo is "stronger" than Kawaramachi, which in turn is "stronger" than
Sanjo.
One can use this order to deduce the names of other crossings.
</P>



<P>
You are given as input a list of known crossing names X-Y.
Streets are either North-South or East-West, and only orthogonal streets
may cross.
</P>
<P>
As your list is very incomplete, you start by completing it using
the following rule:
</P>
<ul>
<li>
  two streets A and B have <i>equal strength</i> if (1) to (3) are
  all true:
<ol>
<li> they both cross the same third street C in the input </li>
<li> there is no street D such that D-A and B-D appear in the input </li>
<li> there is no street E such that A-E and E-B appear in the input </li>
</ol>
</li>
</ul>
<P>
We use this definition to extend our strength relation:
</P>
<ul>
<li>
  A is <i>stronger</i> than B, when there is a
  sequence A = A<sub>1</sub>, A<sub>2</sub>, ..., A<sub><i>n</i></sub> = B,
  with <i>n</i> at least 2, <br>
  where, for any <i>i</i> in 1 .. <i>n</i>-1, either
  A<sub><i>i</i></sub>-A<sub><i>i</i>+1</sub> is an input crossing or
  A<sub><i>i</i></sub> and A<sub><i>i</i>+1</sub> have equal strength.
</li>
</ul>
<P>
Then you are asked whether some other possible crossing names X-Y are
valid. You should answer affirmatively if you can infer the validity of a
name, negatively if you cannot. Concretely:
</P>
<ul>
<li>
  YES    if you can infer that the two streets are orthogonal, and X
         is stronger than Y
</li>
<li>
  NO     otherwise
</li>
</ul>


<H2>Input</H2>


<P>
The input is a sequence of data sets, each of the form
</P>
<blockquote>
<pre><i>N
Crossing<sub>1</sub>
...
Crossing<sub>N</sub>
M
Question<sub>1</sub>
...
Question<sub>M</sub>
</i></pre>
</blockquote>
<P>
Both <i>Crossing</i>s and <i>Question</i>s are of the form
</P>
<blockquote>
<i>X-Y</i>
</blockquote>
<P>
where <i>X</i> and <i>Y</i> are strings of alphanumerical characters,
of lengths no more than 16. There is no white space, and case matters
for alphabetical characters.
<br>
<i>N</i> and <i>M</i> are between 1 and 1000 inclusive, and there are
no more than 200 streets in a data set.
</P>
<P>
The last data set is followed by a line containing a zero.
</P>


<H2>Output</H2>


<P>
The output for each data set should be composed of <i>M</i>+1 lines,
the first one containing the number of streets
in the <i>Crossing</i> part of the input, followed by the answers to
each question, either YES or NO without any spaces.
</P>


<H2>Sample Input</H2>
<PRE>
7
Shijo-Kawaramachi
Karasuma-Imadegawa
Kawaramachi-Imadegawa
Nishioji-Shijo
Karasuma-Gojo
Torimaru-Rokujo
Rokujo-Karasuma
6
Shijo-Karasuma
Imadegawa-Nishioji
Nishioji-Gojo
Shijo-Torimaru
Torimaru-Gojo
Shijo-Kawabata
4
1jo-Midosuji
Midosuji-2jo
2jo-Omotesando
Omotesando-1jo
4
Midosuji-1jo
1jo-Midosuji
Midosuji-Omotesando
1jo-1jo
0
</PRE>

<H2>Output for the Sample Input</H2>
<PRE>
8
YES
NO
YES
NO
YES
NO
4
YES
YES
NO
NO
</PRE>



