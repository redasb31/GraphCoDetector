

<script src="./IMAGE/varmath.js" charset="UTF-8"></script>


<h1><font color="#000">問題 J </font> Mod 3 Knights Out</h1>


<h2>問題文</h2>
<p>
ある日の夕方，コンテストの問題を解き終えた二人は今日の問題について話し合っていた．<br>
A「くそー，あのライツアウトの問題，mod <var>2</var> じゃなくて mod <var>3</var> とか mod <var>7</var> とかだったら解法分かったのにー！」<br>

B「じゃあ，mod <var>3</var> で別の方法で解く問題を作ればいいんですね．分かりました！」<br>
こうして次のような問題が誕生した．</p>
<p></p>
<p><var>H × W</var> のチェス盤がある．チェス盤の各マスには <var>0</var> から <var>2</var> の整数が書かれている．このチェス盤にナイトを置いていく．ただし，各マスには多くても <var>1</var> 体のナイトしか置けない．各マスについて，<var>(マスの数値+そこを攻撃するマスにいるナイトの数)=0 mod 3</var>が成り立つようなナイトの配置を<b>良い</b>配置と呼ぶ．攻撃するマスとはそのマスから縦方向に <var>±2</var> マスかつ横方向に <var>±1</var> マス，もしくは縦方向に <var>±1</var> マスかつ横方向に <var>±2</var> マスずれたマスのことである．</p>

<p>良いナイトの配置の数を求めよ．答えは大きくなる可能性があるので <var>1,000,000,007</var> で割った余りを答えよ．</p>

<h2>入力形式</h2>
<p>
最初の行に <var>H</var> と <var>W</var> がスペース区切りで与えられる．
</p>

<p>
次の <var>H</var> 行には、チェス盤のマス目に書かれている数値として <var>W</var> 個の <var>0</var>，<var>1</var>，<var>2</var> のいずれかの整数がスペース区切りで与えられる．
</p>

<h2>出力形式</h2>
<p>
良いナイトの配置の数を <var>1,000,000,007</var> で割った余りを出力せよ．
</p>

<h2>制約</h2>
<ul>
    <li><var>1 &le; H &le; 50</var></li>

    <li><var>1 &le; W &le; 16</var></li>
</ul>

<h2>入出力例</h2>
<h3>入力例 1</h3>
<pre>
5 5
0 2 0 2 0
2 0 0 0 2
0 0 0 0 0
2 0 0 0 2
0 2 0 2 0
</pre>

<h3>出力例 1</h3>
<pre>
5
</pre>

<h3>入力例 2</h3>
<pre>
3 3
2 2 2
2 0 2
2 2 2
</pre>

<h3>出力例 2</h3>
<pre>
8
</pre>

<h3>入力例 3</h3>
<pre>
7 7
2 2 2 2 2 2 2
2 1 1 2 1 1 2
2 0 1 0 1 0 2
2 2 0 2 0 2 2
2 0 1 0 1 0 2
2 1 1 2 1 1 2
2 2 2 2 2 2 2
</pre>

<h3>出力例 3</h3>
<pre>
96
</pre>

<h3>入力例 4</h3>
<pre>
7 3
2 2 2
1 0 1
0 1 0
1 1 1
0 1 0
1 0 1
2 2 2

</pre>

<h3>出力例 4</h3>
<pre>
8
</pre>

<h3>入力例 5</h3>
<pre>
6 6
0 2 0 1 0 2
2 0 1 2 2 2
0 2 2 0 0 0
2 0 2 0 2 0
0 2 2 1 0 2
0 0 0 2 0 2
</pre>

<h3>出力例 5</h3>
<pre>

1
</pre>

<h3>入力例 6</h3>
<pre>
16 16
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
</pre>

<h3>出力例 6</h3>
<pre>
1
</pre>

<h2>謝辞</h2>

この問題は Tester と Writer が<a href="http://icpc2010.honiden.nii.ac.jp/regional-contest/problem">アジア地区予選の問題</a>に関して話し合ったのをきっかけとして作られた。





