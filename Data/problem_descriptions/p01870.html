


<!-- - - - - - begin nicebody - - - - - -->

<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]}
});
</script>
<script type="text/javascript" async
        src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-MML-AM_CHTML">
</script>

<h1>F: リレー / Relay</h1>


<h2>問題文</h2>

<p>
湖に浮かぶ $N$ 個の小島からなるビワコという村がある．
ビワコ村には $N-1$ 本の簡単な作りの橋がある．
島には $0$ から $N-1$ まで，橋には $0$ から $N-2$ までの番号が付けられている．
$i$ 番の橋は $i+1$ 番の島と $p_i$ 番の島を直接つなぎ，長さは $w_i$ である．
村人はどの島の間もいくつかの橋を通って相互に移動できるようになっている．
</p>

<p>
ある村人の提案により，ビワコ村でリレー大会が開催されることとなった．
しかし，ビワコ村には閉路がなくトラックを用意できないため，
現在ある橋を $1$ つだけ掛け替えることによって閉路を作ろうと考えた．
この操作によって用意できる閉路のうち，長さが最大となるものの長さを求めなさい．
</p>

<h2>入力</h2>

<p>
$N$<br>
$p_0 \ w_0$<br>
$\vdots$<br>
$p_{n-2} \ w_{n-2}$<br>
</p>

<h2>制約</h2>

<p>
$2 \leq N \leq 100000$<br>
$0 \leq p_i \leq N-1$<br>
$1 \leq w_i \leq 1000$<br>
全て整数<br>
全ての島と島の間が到達可能である<br>
</p>

<h2>出力</h2>

<p>
答えを $1$ 行で出力せよ．
</p>

<h2>サンプル</h2>

<p>
各サンプルを図示すると次のようになる．
</p>

<img src="https://judgeapi.u-aizu.ac.jp/resources/images/IMAGE3_RUPC20160306_F">

<h3>サンプル入力1</h3>

<pre>
5
0 1
0 2
0 3
0 4
</pre>

<h3>サンプル出力1</h3>

<pre>
9
</pre>

<h3>サンプル入力2</h3>

<pre>
12
0 6
1 1
0 3
3 4
0 2
5 1
6 1
0 2
8 1
9 1
10 2
</pre>

<h3>サンプル出力2</h3>

<pre>
19
</pre>

<h3>サンプル入力3</h3>

<pre>
2
0 1
</pre>

<h3>サンプル出力3</h3>

<pre>
1
</pre>