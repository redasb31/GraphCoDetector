
<H1><font color="#000">Problem H: </font>Company Organization</H1>

<p>
You started a company a few years ago and fortunately it has been highly successful. As the growth of the company, you noticed that you need to manage employees in a more organized way, and decided to form several groups and assign employees to them.
</p>

<p>
Now, you are planning to form n groups, each of which corresponds to a project in the company. Sometimes you have constraints on members in groups. For example, a group must be a subset of another group because the former group will consist of senior members of the latter group, the members in two groups must be the same because current activities of the two projects are closely related, the members in two groups must not be exactly the same to avoid corruption, two groups cannot have a common employee because of a security reason, and two groups must have a common employee to facilitate collaboration.
</p>

<p>
In summary, by letting <i>X<sub>i</sub></i> (<i>i</i> = 1, ... , <i>n</i>) be the set of employees assigned to the <i>i</i>-th group, we have five types of constraints as follows.
</p>

<ol>
<li> <i>X<sub>i</sub></i> &sube; <i>X<sub>j</sub></i></li>
<li> <i>X<sub>i</sub></i> = <i>X<sub>j</sub></i></li>
<li> <i>X<sub>i</sub></i> &ne; <i>X<sub>j</sub></i></li>
<li> <i>X<sub>i</sub></i> &cap; <i>X<sub>j</sub></i> = &empty;</li>
<li> <i>X<sub>i</sub></i> &cap; <i>X<sub>j</sub></i> &ne; &empty;</li>
</ol>

<p>
Since you have listed up constraints without considering consistency, it might be the case that you cannot satisfy all the constraints. Constraints are thus ordered according to their priorities, and you now want to know how many constraints of the highest priority can be satisfied.
</p>

<p>
You do not have to take ability of employees into consideration. That is, you can assign anyone to any group. Also, you can form groups with no employee. Furthermore, you can hire or fire as many employees as you want if you can satisfy more constraints by doing so.
</p>

<p>
For example, suppose that we have the following five constraints on three groups in the order of their priorities, corresponding to the first dataset in the sample input.
</p>

<ul>
<li><i>X</i><sub>2</sub> &sube; <i>X</i><sub>1</sub></li>
<li><i>X</i><sub>3</sub> &sube; <i>X</i><sub>2</sub></li>
<li><i>X</i><sub>1</sub> &sube; <i>X</i><sub>3</sub></li>
<li><i>X</i><sub>1</sub> &ne; <i>X</i><sub>3</sub></li>
<li><i>X</i><sub>3</sub> &sube; <i>X</i><sub>1</sub></li>
</ul>

<p>
By assigning the same set of employees to <i>X</i><sub>1</sub>, <i>X</i><sub>2</sub>, and <i>X</i><sub>3</sub>, we can satisfy the first three constraints. However, no matter how we assign employees to <i>X</i><sub>1</sub>, <i>X</i><sub>2</sub>, and <i>X</i><sub>3</sub>, we cannot satisfy the first four highest priority constraints at the same time. Though we can satisfy the first three constraints and the fifth constraint at the same time, the answer should be three.
</p>

<H2>Input</H2>

<p>
The input consists of several datasets. The first line of a dataset consists of two integers <i>n</i> (2 &le; <i>n</i> &le; 100) and <i>m</i> (1 &le; <i>m</i> &le; 10000), which indicate the number of groups and the number of constraints, respectively. Then, description of <i>m</i> constraints follows. The description of each constraint consists of three integers <i>s</i> (1 &le; <i>s</i> &le; 5), <i>i</i> (1 &le; <i>i</i> &le; <i>n</i>), and <i>j</i> (1 &le; <i>j</i> &le; <i>n</i>, <i>j</i> &ne;= <i>i</i>), meaning a constraint of the <i>s</i>-th type imposed on the <i>i</i>-th group and the <i>j</i>-th group. The type number of a constraint is as listed above. The constraints are given in the descending order of priority.
</p>

<p>
The input ends with a line containing two zeros.
</p>


<H2>Output</H2>

<p>
For each dataset, output the number of constraints of the highest priority satisfiable at the same time.
</p>

<H2>Sample Input</H2>
<pre>
4 5
1 2 1
1 3 2
1 1 3
3 1 3
1 3 1
4 4
1 2 1
1 3 2
1 1 3
4 1 3
4 5
1 2 1
1 3 2
1 1 3
4 1 3
5 1 3
2 3
1 1 2
2 1 2
3 1 2
0 0
</pre>

<H2>Output for the Sample Input</H2>
<pre>
3
4
4
2
</pre>