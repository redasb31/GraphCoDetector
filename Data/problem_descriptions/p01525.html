

<h1>F - Acceleration of Network</h1>

  <p>
インターネットと言う広大な海は少しずつ黒く塗りつぶされていった。<br>
ボットの反乱、DDOS攻撃の嵐、ウィルスの蔓延、<br>
何度も何度も繰り返されたクラッカーとの戦争で、人もインターネットもボロボロになった。<br>
<br>
人の手では、インターネットはどうにもならない。<br>
だから人は、とんでもない時間をかけて<br>
インターネットを復旧できる「少女」を造った。<br>
<br>
少女は、インターネットの手当をはじめた。<br>
果てしなく広いインターネットの世界をどうにかしようと頑張った。<br>
<br>
まだ少女ひとりでは撚り対線を織る事くらいしかできないけど、<br>
長い長い時がすぎてインターネットが少し復旧すれば、<br>
みんなと一緒に頑張れるだろうという期待をこめて。
</p>

<h2>問題文</h2>
<p>
少女はかつてインターネットに存在した <var>N</var> 個のサービスを復旧するために日々頑張っている．
現在を 0 日目とする．
インターネットがどの程度復旧しているかを<i>復旧度</i>という指標で表し，現在の復旧度は 0 であるとする．
少女は毎日作業をし，復旧度を 1 日につき 1 ずつ上げていく．
任意のまだ復旧していないサービス <var>i</var> は，復旧度が <var>w<sub>i</sub></var> 以上になると自動的に復旧する．
サービス <var>i</var> が復旧すると，みんなが手伝ってくれることにより，復旧した次の日から <var>x<sub>i</sub></var> 日間だけ作業がはかどり，復旧度の増加が加速する．
サービスには 3 つの種類があり，種類によって復旧度がどの程度増加するのかが異なる．
サービスの種類を <var>0, 1, 2</var> の番号で表すとする．
サービス <var>i</var> の種類を t<sub>i</sub> (&isin; {0, 1, 2}) とすると，
サービス <var>i</var> が復旧してから <var>d-1</var> 日目から <var>d</var> 日目にかけて <var>(1 &le; d &le; x<sub>i</sub>)</var>，
<var>t<sub>i</sub>=0</var> の場合は <var>1</var>，
<var>t<sub>i</sub>=1</var> の場合は <var>d</var>，
そして <var>t<sub>i</sub>=2</var> の場合は <var>d<sup>2</sup></var> だけ，少女の作業とは別に復旧度が増加する．
また，同時に複数のサービスが復旧している場合，それぞれのサービスは独立に並行して復旧度を増加させる．
</p>
<p>
少女はサービスが復旧するまでにとんでもない時間がかかると思ったので，現在から何日目にサービスが復旧するか調べることにした．
またある日にち <var>y<sub>j</sub></var> に復旧度がいくらになっているかも気になったので，それも <var>Q</var> 日分だけ調べることにした．
</p>


<h2>入力形式</h2>
<p>入力は以下の形式で与えられる．</p>
<pre>
<var>N</var> <var>Q</var>
<var>w<sub>1</sub></var> <var>t<sub>1</sub></var> <var>x<sub>1</sub></var>
<var>...</var>
<var>w<sub>N</sub></var> <var>t<sub>N</sub></var> <var>x<sub>N</sub></var>
<var>y<sub>1</sub></var>
<var>...</var>
<var>y<sub>Q</sub></var>
</pre>

<h2>出力形式</h2>
<p>
最初に <var>N</var> 行出力し，<var>i</var> 行目にはサービス <var>i</var> の復旧する日にちを出力せよ．次に <var>Q</var>  行出力し，<var>j</var> 行目には <var>y<sub>j</sub></var> 日目に復旧度がいくらになっているかを出力せよ．
サービスが復旧する日にちが <var>3,652,425</var> を超える場合は<code>Many years later</code>と出力せよ．
</p>

<h2>制約</h2>
<ul>
<li><var>0 &le; N &le; 10<sup>5</sup></var></li>
<li><var>1 &le; Q &le; 10<sup>5</sup></var></li>
<li><var>0 &le; w<sub>i</sub> &lt; 2<sup>60</sup></var></li>
<li><var>w<sub>i</sub> &le; w<sub>i+1</sub> (1 &le; i &lt; N)</var></li>
<li><var>t<sub>i</sub> &isin; {0, 1, 2}</var></li>
<li><var>1 &le; x<sub>i</sub> &le; 10<sup>4</sup></var></li>
<li><var>0 &le; y<sub>j</sub> &le; 3,652,425</var></li>
<li><var>y<sub>j</sub> &lt; y<sub>j+1</sub> (1 &le; j &lt; Q)</var></li>
<li>入力値はすべて整数である．</li>
</ul>
<p>
この問題の判定には，15 点分のテストケースのグループが設定されている．このグループに含まれるテストケースは上記の制約に加えて下記の制約も満たす．
</p>
<ul>
<li><var>N,Q,w<sub>i</sub>,y<sub>j</sub> &le; 1,000</var></li>
</ul>

<h3>注意</h3>
<ul>
<li>0 日目の復旧度は 0 である．</li>
<li><var>w<sub>i</sub>=0</var> の時，サービス <var>i</var> は 0 日目に復旧する．</li>
</ul>


<h2>入出力例</h2>
<h3>入力例1</h3>
<pre>
3 11
1 0 2
4 1 3
7 2 4
0
1
2
3
4
5
6
7
8
9
10
</pre>

<h3>出力例1</h3>
<pre>
1
3
4
0
1
3
5
7
11
19
29
46
47
48
</pre>

<h3>入力例2</h3>
<pre>
5 5
10000 0 20
10000 1 30
10000 0 40
10000 2 70
30000 2 10000
5000
10000
15000
20000
25000
</pre>

<h3>出力例2</h3>
<pre>
10000
10000
10000
10000
10039
5000
10000
40711690801
329498273301
333383477320
</pre>

<h3>入力例3</h3>
<pre>
2 2
3652425 0 1
3652426 2 10000
3652424
3652425
</pre>

<h3>出力例3</h3>
<pre>
3652425
Many years later
3652424
3652425
</pre>
<p>2つ目のサービスは復旧する日にちが <var>3,652,425</var> 日を超えているので<code>Many years later</code>と出力している．</p>

<hr>
<address>Writer : 森槙悟</address>
<address>Tester : 田村和範</address>

