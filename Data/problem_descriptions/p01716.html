


<h1>問題 E : Pattern Language</h1>

<h2>問題文</h2>
<p>
<var>m</var> 個の相異なるアルファベット <var>var_0, &thinsp;var_1, &thinsp; …&thinsp;, &thinsp;var_{m-1}</var> がある．
<var>0, &thinsp; 1, &thinsp; …&thinsp;, &thinsp; 9, &thinsp; var_0, &thinsp; var_1, &thinsp; …&thinsp;, &thinsp; var_{m-1}</var> の <var>10+m</var> 種類の文字からなる，長さ <var>N</var> の文字列 <var>s_0s_1s_2…s_{N-1}</var> が与えられる．
この文字列における各アルファベットを数字で置き換えて回文になるようにしたい．(回文とは，前から読んでも後ろから読んでも同じ文字列をあらわす．)
ここで，同じアルファベットは同じ数字で置き換えなければならない．また与えられたすべてのアルファベット<var>var_i</var>は少なくとも，一度は文字列<var>s_0s_1s_2…s_{N-1}</var>にあらわれる．
</p>

<p>
アルファベット <var>var_i</var> は <var>0</var> 以上 <var>u_i</var> 以下の，leading zero を含まない整数に置き換える事ができる．
置き換えた後の文字列が回文になるような置き換え方が何通り存在するかを，<b>mod</b> <var>10^9+7</var> で求めよ．
なお，アルファベットの置き換え方が異なれば，得られる文字列が同じでも異なるものとして数える．
</p>



<h2>入力形式</h2>
<p>
入力は以下の形式で与えられる
<pre>
<var>N</var> <var>m</var>
<var>s_0s_1s_2…s_{N-1}</var>
<var>var_0</var> <var>u_0</var>
<var>...</var>
<var>var_{m-1}</var> <var>u_{m-1}</var>
</pre>

<h2>出力形式</h2>
<p>
置き換え方の場合の数を <var>10^9 + 7</var> で割った剰余を一行で出力せよ．
</p>

<h2>制約</h2>
<ul>
<li><var>1 &le; N &le; 500</var></li>
<li><var>1 &le; m &le; 10</var></li>
<li><var>0 &le; u_i &le; 99</var></li>
<li><var>s_i</var> &isin; <var>\{'0', &thinsp; '1', &thinsp; …&thinsp;, &thinsp; '9', &thinsp; var_0, &thinsp; var_1, &thinsp; …&thinsp;, &thinsp; var_{m-1}\}</var></li>
<li><var>var_i &isin; \{'a', &thinsp; 'b', &thinsp; …&thinsp;, &thinsp; 'j'\}</var>
<li>各アルファベット <var>var_i</var> は <var>s_0s_1s_2&thinsp;…s_{N-1}</var> に少なくとも一度は現れる．</li>
<li><var>var_0,&thinsp; var_1,&thinsp; …&thinsp;, &thinsp;var_{m-1}</var> はすべて異なる</li>
</ul>

<h2>入出力例</h2>
<h3>入力例 1</h3>
<pre>
3 1
a1a
a 99
</pre>

<h3>出力例 1</h3>
<pre>
19
</pre>

<h3>入力例 2</h3>
<pre>
5 3
jbfjb
f 50
b 25
j 5
</pre>

<h3>出力例 2</h3>
<pre>
252
</pre>


<h3>入力例 3</h3>
<pre>
7 3
jag2013
j 53
a 10
g 93
</pre>

<h3>出力例 3</h3>
<pre>
23
</pre>
