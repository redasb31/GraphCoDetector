

<h1><font color="#000">Problem F:</font> Canal: Water Going Up and Down</h1>

<!--
<h3><U>閘門式運河: 上下に動く水面</U></h3>
-->


<p>ACM国には中央を東西に流れる川がある．この川は西の隣国からACM国を通り東の隣国へと流れており，ACM国内の全長は <i>K</i> kmである．この川にいくつかの閘門を設置し，運河として利用することが計画されている．</p>

<p>閘門とは，異なる2つの水位間を船が移動するための仕組みである．閘門は上流側と下流側にそれぞれ水門を持ち，それらの間に閘室と呼ばれる小さな水域を持つ．この閘室に船を入れた後に注水あるいは排水を行い，閘室の水位を上下させることで船も上下させる．以下にその模式図を示す．</p>

<center>
<p><img src="https://judgeapi.u-aizu.ac.jp/resources/images/IMAGE2_F1" /><br />
図 F-1: 閘門の模式図</p>
</center>

<p>この川の川幅はあまり広くないため，西から東へ一方通行の運河となることが決まっている．設計の担当者は，運河を効率良く運用するため，予想される船の航行スケジュールに合わせて閘門の設置場所などを最適にしたいと考えている．</p>

<p>あなたは設計担当者に雇われているプログラマーである．あなたの仕事は，閘門の情報と複数の船の航行スケジュールが与えられたとき，全ての船が川を通過するまでの時間をシミュレーションにより求めるプログラムを書くことである．</p>

<p>各閘門は以下の情報によって表される．</p>
<ul>
	<li>ACM国西端からの距離 <i>X</i> (km)</li>
	<li>水位の切り替えに必要な水の容積 <i>L</i> (L)</li>
	<li>単位時間あたりの最大注水量 <i>F</i> (L/h)</li>
	<li>単位時間あたりの最大排水量 <i>D</i> (L/h)</li>
	<li>閘門の西側の水位と東側の水位の上下関係</li>
</ul>

<p>便宜上，シミュレーションにおいて，川はACM国外においても同様に無限に続いているものとする．</p>

<p>シミュレーションの開始時点において，全ての閘室の水位は東側と西側の水位のうち，低い方にある．また，航行スケジュールに含まれる船は，ACM国の西端を先頭地点として，入力で与えられる順に東から西に向かって1kmおきに並んでいるものとする． 便宜上，先頭の船の初期位置を0km地点とする．</p>

<p>シミュレーション開始とともに船は東に向かって航行を始める．このとき，ある船の前後1km未満に他の船が入ってはならない．
各船にはそれぞれ最大船速 <i>V</i> (km/h)が設定されている．船は一瞬で任意の船速に達し，さらに一瞬で静止することすらできる．基本的に船は最大船速で航行するが，先行する船より後続の船のほうが最大船速が速く，かつ後続の船が先行する船の1km手前に追いついた場合は，後続の船は先行する船と同じ船速で航行する．船及び閘門の大きさは無視できるものとする．</p>

<p>船は，閘門の西側の水位と閘室の水位が等しいときのみ，その閘門に入ることができる．同様に，閘門の東側の水位と閘室の水位が等しいときのみ，その閘門から出ることができる．各閘室の水位は，中に船がいない場合は，その閘門の西側の水位と一致するまで上昇または下降する．また，船がいる場合は，その閘門の東側の水位と一致するまで変位する．閘門の丁度1km先で船が停泊している場合でも，船は閘門から出ることができる．ただし，このとき，船は先行する船が発進するまで閘門から出たところで停泊しなければならない．</p>

<p>船はACM国の東端を通過した後，可能な限りの速度で無限遠まで航行する．全ての船がACM国の東端を通過し終えた時点でシミュレーションは終了する．</p>


<h2>Input</h2>


<p>入力は複数のデータセットからなる．各データセットは以下の形式で与えられる．</p>

<blockquote><i>N</i> <i>M</i> <i>K</i><br />
<i>X<sub>1</sub></i> <i>L<sub>1</sub></i> <i>F<sub>1</sub></i> <i>D<sub>1</sub></i>
<i>UD<sub>1</sub></i><br />
<i>X<sub>2</sub></i> <i>L<sub>2</sub></i> <i>F<sub>2</sub></i> <i>D<sub>2</sub></i>
<i>UD<sub>2</sub></i><br />
...<br />
<i>X<sub>N</sub></i> <i>L<sub>N</sub></i> <i>F<sub>N</sub></i> <i>D<sub>N</sub></i>
<i>UD<sub>N</sub></i><br />
<i>V<sub>1</sub></i><br />
<i>V<sub>2</sub></i><br />
...<br />
<i>V<sub>M</sub></i><br />
</blockquote>

<p>最初の1行は3つの整数 <i>N</i>, <i>M</i>, <i>K</i> からなる． <i>N</i> (1 &le; <i>N</i> &le; 100) は閘門の数， <i>M</i> (1 &le; <i>M</i> &le; 100) は船の数， <i>K</i> (2 &le; <i>K</i> &le; 1000) は川のACM国内における全長をそれぞれ表す．</p>

<p>続く <i>N</i> 行は閘門の情報を表す． 各行は5つの整数 <i>X<sub>i</sub></i>, <i>L<sub>i</sub></i>, <i>F<sub>i</sub></i>, <i>D<sub>i</sub></i>, <i>UD<sub>i</sub></i> からなる． <i>X<sub>i</sub></i> (1 &le; <i>X<sub>i</sub></i> &le; <i>K</i> - 1) は閘門 <i>i</i> のACM国西端からの位置(km)， <i>L<sub>i</sub></i> (1 &le; <i>L<sub>i</sub></i> &le; 1000) は閘門 <i>i</i> の水位の切り替えに必要な水の容積(L)， <i>F<sub>i</sub></i> (1 &le; <i>F<sub>i</sub></i> &le; 1000) は閘門 <i>i</i> の単位時間あたりの最大注水量(L/h)， <i>D<sub>i</sub></i> (1 &le; <i>D<sub>i</sub></i> &le; 1000) は閘門 <i>i</i> の単位時間あたりの最大排水量(L/h)， <i>UD<sub>i</sub></i> (<i>UD<sub>i</sub></i> &isin; {0, 1})は閘門 <i>i</i> の西側の水位と東側の水位の上下関係をそれぞれ表す．
<i>UD<sub>i</sub></i> が 0 の場合，閘門 <i>i</i> は西側より東側が水位が高いことを表す．一方 <i>UD<sub>i</sub></i> が 1 の場合，閘門 <i>i</i> は西側より東側が水位が低いことを表す．</p>

<p>続く <i>M</i> 行には，各行に <i>i</i> 番目の船の最大船速(km/h)を表す整数 <i>V<sub>i</sub></i> (1 &le; <i>V<sub>i</sub></i> &le; 1000) が与えられる．</p>

<p>閘門は <i>X<sub>i</sub></i> の値の小さい順で与えられる．また，同一の位置に複数の閘門が設置されることはない．</p>

<p>入力の終りはスペースで区切られた3個のゼロからなる．</p>


<h2>Output</h2>


<p>各データセットに対し，シミュレーション開始から終了までの時刻を1行で出力せよ．出力する値は10<sup>-6</sup>以下の誤差を含んでいても構わない．値は小数点以下何桁表示しても構わない．</p>

<h2>Sample Input</h2>
<pre>
1 1 100
50 200 20 40 0
1
2 4 100
7 4 1 4 1
19 5 1 4 0
5
3
7
9
1 2 3
1 1 1 1 0
1
3
1 2 10
5 10 1 1 1
2
3
0 0 0
</pre>

<h2>Output for the Sample Input</h2>
<pre>
110
46.6666666667
5
41.6666666667
</pre>

