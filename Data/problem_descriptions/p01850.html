


<script type="text/x-mathjax-config">
	MathJax.Hub.Config({ tex2jax: { inlineMath: [["$","$"], ["\\(","\\)"]], processEscapes: true }});
</script>
<script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML">
</script>

<h3>百人一首</h3>


<p>百人一首は日本の伝統的なゲームである． このゲームでは <i>N</i> 枚のカードが用いられ，それぞれのカードには1つの文字列が書かれている．細かいルールは省略するが， A君は <i>N</i> 枚のカードに書かれている文字列を何らかの順序でそれぞれちょうど1回ずつ読むことになった．
</p>
<p>百人一首ではその接頭辞が非常に重要である．百人一首で使用される文字列として接頭辞は似ている言葉が多く， 連続して似たような文字列を読むとA君も混乱してしまう． そこでA君は，連続する二つのカードの文字列の接頭辞ができるだけ異なるように，カードを並べ替えようと考えた．
</p>
<p>A君の目標は，「山札の読みやすさ」と呼ばれる指標を最小化するような山札を求めることである．ここで山札とは，この百人一首で読まれる <i>N</i> 枚のカードを並べ替えたものを指す．山札の読みやすさとは，山札内にある隣接したカードの類似度の総和を言う．2 枚のカードの類似度はそれらに書かれた文字列どうしの最長共通接頭辞の長さとして定義される．なお，文字列 <i>t</i> と <i>u</i> の最長共通接頭辞とは，<i>t</i> と <i>u</i> 両方の接頭辞であるような文字列のうち，最長のものを指す．
</p>
<p>例えば，2 枚のカードに書かれた文字列がそれぞれ "<samp>jag</samp>" と "<samp>japan</samp>" であれば，これらのカードの類似度は 2 である．一方，"<samp>wan</samp>" と "<samp>nyan</samp>" であれば類似度は 0 である．
</p>
<p>ところで，「山札の読みやすさ」が最小となる山札は複数存在するかもしれない．A君は，最小解としてありうる山札のうち，辞書順最小の山札を求めたい．ここで，山札 <i>P</i> と <i>Q</i> について <i>P</i> が辞書順で小さいとは，ある正の整数 <i>i</i> が存在して，1 番目から <i>i-1</i> 番目のカードまではそれぞれ同一のカードであり，かつ <i>i</i> 番目のカードの文字列は辞書順において山札 <i>P</i> のカードのほうが小さいことを言う．
</p>
<p>あなたの仕事は，「山札の読みやすさ」を最小にするような山札の中で，辞書順最小となるものを求めることである．
</p>


<h3>Input</h3>

<p>入力は複数のデータセットからなる． 各データセットは次の形式で表される．
</p>
<blockquote><i>N</i><br><i>s<sub>1</sub></i><br>...<br><i>s<sub>N</sub></i></blockquote>

<p>1行目にはカードの枚数を表す整数 <i>N</i> (<i>1 ≤ N ≤ 100,000</i>) が与えられる．
続く <i>N</i> 行にはカードに書かれた1文字以上の文字列が書かれてあり， 1行は英小文字のみで構成される．また，同一セット内において，各 <i>s<sub>i</sub></i> は互いに異なることが保証されている．
さらに，<i>s<sub>i</sub></i> の長さの合計は 400,000 以下であることが保証されている．
</p>
<p>入力の終わりは， 1つのゼロからなる行で示す．
</p>



<h3>Output</h3>

<p>各データセットについて，「山札の読みやすさ」が最小となる山札の中で辞書順最小の山札の情報を，<i>N</i> 行に出力せよ．具体的には，そのような山札の <i>i</i> 番目のカードに書かれた文字列を，<i>i</i> 行目に出力することになる．
</p>


<h3>Sample Input</h3>

<pre>3
icpc
icfp
topcoder
4
apple
application
appointment
acmicpc
3
a
aa
aaa
4
a
aza
azb
b
0</pre>

<h3>Output for Sample Input</h3>

<pre>icfp
topcoder
icpc
apple
acmicpc
application
appointment
aa
a
aaa
a
aza
b
azb</pre>

<p>
辞書順の定義に注意すること．今回の定義では，文字列を連結した時に辞書順最小になるということを意味するわけではない．例えば，3番目の入力例では [aaa,a,aa] も「山札の読みやすさ」が最小となる解の一つであり，連結すれば同じ文字列になるため，辞書順最小の解に見えるかもしれない．しかしながら，今回の定義では先頭の文字列 "aa" と "aaa" が優先的に比較されるため，辞書順最小の解は [aa,a,aaa] となる．
</p>
