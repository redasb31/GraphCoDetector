<h1>Problem D: Blaster</h1>

<h2>Problem</h2>
<p>
なんと、あなたは洞窟の中に閉じ込められてしまいました！<br>
壁が崩れたりでもしたのでしょうか、1つしかない出口にたどり着くまでには沢山の岩が邪魔をしています。<br>
<br>
しかしなんと、あなたのすぐ隣に爆弾の自動販売機があることに気がつきました。<br>
さらに、洞窟にはいくつかの「ブラスター」も落ちているようです。<br>
この2つの道具を活用すれば、出口まで脱出できそうです。<br>
</p>
<hr style="border:2px dotted #000000;">
<h4>アイテムの説明</h4>
<p>
洞窟内で使用できるアイテムとして、「爆弾」「ブラスター」の2種類があります。<br>
</p>
<ul>
<li>爆弾は、使用することで1マス分の岩を破壊できるアイテムです。<br>
<li>ブラスターは、使用することで自身の正面一直線にある岩を全て破壊することのできるアイテムです。<br>
</ul>
<p>
対象となる岩を破壊すると、岩は砕け散り「床」となります。<br>
爆弾、ブラスターは使い切りで、各アイテムごとに使用できる回数はそれぞれ1回のみです。<br>
また、ブラスターを使用することで、他のブラスターを破壊することはありません。<br>
</p>
<hr style="border:2px dotted #000000;">
<h4>洞窟のフィールド</h4>
<p>
偶然手持ちにあったドローンを飛ばして、洞窟の様子を知ることが出来ました。<br>
<br>
洞窟のフィールドが与えられます。<br>
フィールドは以下のようなアスキーアートで与えらます。<br>
</p>
<pre>
_###
##B#
B##_
</pre>
<p>
フィールドは、上下に $H$ マス、左右に $W$ マスの幅を持つ $H \times W$ のマスからなる長方形です。<br>
$i$ 行 $j$ 列目のマスを $(i,j)$ と表します。 <br>
<br>
各マスには、床、壁、ブラスターのいずれかがあります。<br>
ブラスターのマスには、床の上にちょうど1つのブラスターが落ちていることを示します。<br>
なお、フィールドの外側は爆弾やブラスターでも破壊できない壁で囲まれています。<br>
フィールドの外側に出ることは出来ません。<br>
</p>
<hr style="border:2px dotted #000000;">
<h4>脱出までの行動</h4>
<p>
あなたは、以下の行動を任意の回数取ることが出来ます。<br>
</p>
<ul>
<li>隣接するマスの、任意の床へ進む。</li>
<li>隣接するマスにある任意のブラスターを取得する。取得後、ブラスターを取得したマスは床となる。</li>
<li>隣接するマスにある岩を、爆弾を1つ消費して破壊する。</li>
<li>現在のマスから、上下左右好きな方向を向いて、所持しているブラスターを1つ使用する。</li>
</ul>
<p>
ここで、マス $(i,j)$ と $(k,l)$ が隣接するとは、 $|i-k|+|j-l|=1$ であることをいいます。<br>
ブラスターは十分に軽いため、行動中いくつでも取得することが出来ます。<br>
但し、アイテムの説明に記載してあるとおり、取得した個数分の回数しかブラスターを使用することは出来ないので、注意してください。<br>
<br>
最初、マス $(1,1)$ にいます。<br>
脱出とは、マス $(H,W)$ に到達することを言います。<br>
</p>
<hr style="border:2px dotted #000000;">
<h4>ミッション</h4>
<p>
あなたは、爆弾の自動販売機から大量の爆弾を買えば問題なく脱出できることに気づきました。<br>
幸い、爆弾の自動販売機には $10^{100}$ 個の在庫があり脱出するには十分そうです。<br>
しかし、爆弾は非常に高価であるためあまり沢山買いたくありません。<br>
手に入れた洞窟の様子から、脱出するには最小でいくつの爆弾を買う必要があるか、知りたくなりました。<br>
</p>

<h2>Input</h2>
<p>入力は以下の形式で与えられる。</p>
<pre>
$H$ $W$
$c_{1,1}$$\cdots$$c_{1,W}$
$\vdots$
$c_{H,1}$$\cdots$$c_{H,W}$
</pre>
<p>
1行目に $H,W$ が空白区切りに与えられます。<br>
2行目から、続く $H$ 行にフィールドの情報がアスキーアートで与えられます。<br>
<br>
フィールドの情報は、それぞれの文字ごとに以下の意味を持ちます。<br>
</p>
<ul>
<li>$c_{i,j}$ が '#' のとき、 $(i,j)$ に岩があることを示す。
<li>$c_{i,j}$ が '_' のとき、 $(i,j)$ に床があることを示す。
<li>$c_{i,j}$ が 'B' のとき、 $(i,j)$ にブラスターがちょうど1つあることを示す。
</ul>

<h2>Constraints</h2>
<p>入力は以下の条件を満たす。</p>
<ul>
  <li>$2 \leq H,W \leq 1000 $</li>
  <li>$H,W$ は整数である</li>
  <li>$c_{1,1},c_{H,W}$ は、必ず'_'である。</li>
</ul>


<h2>Output</h2>
<p>
1行に脱出に必要な爆弾の数を出力せよ。<br>
</p>

<h2>Sample Input 1</h2>
<pre>
8 5
_###_
_#_B#
_####
____#
###_#
#####
###_#
####_
</pre>

<h2>Sample Output 1</h2>
<pre>
1
</pre>
<p>
この場合の脱出方法は、
</p>
<ul>
<li>マス $(3,4)$ にある岩を爆弾で破壊する</li>
<li>マス $(2,4)$ にあるブラスターを取得する</li>
<li>マス $(2,4)$ で下方向にブラスターを使用する</li>
<li>脱出！
</ul>
<p>
このように、爆弾 $1$ つで脱出することが出来ます。<br>
なお、ブラスターを使用した直後のフィールドは、以下のようになっています。<br>
</p>
<pre>
_###_
_#__#
_##_#
____#
###_#
###_#
###_#
###__
</pre>

<h2>Sample Input 2</h2>
<pre>
5 5
_____
_____
_____
_____
_____
</pre>

<h2>Sample Output 2</h2>
<pre>
0
</pre>
<p>
邪魔する岩もブラスターもありません。目の錯覚だったのでしょうか。<br>
爆弾を一つも買うことなく、脱出できる場合もあります。<br>
</p>

<h2>Sample Input 3</h2>
<pre>
4 5
_####
##B##
_####
_###_
</pre>

<h2>Sample Output 3</h2>
<pre>
2
</pre>
<p>マス $(2,1),(2,2)$ にある岩を破壊すれば、爆弾 $2$ つだけで脱出可能です。</p>

<h2>Sample Input 4</h2>
<pre>
4 5
_#B##
#####
##B##
####_
</pre>

<h2>Sample Output 4</h2>
<pre>
1
</pre>