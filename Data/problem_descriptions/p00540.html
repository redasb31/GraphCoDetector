



<h2>舞踏会 (Ball)</h2>

<p>
IOI 王国では，王女である JOI 姫の誕生日を祝って舞踏会が開かれることになった．
</p>
<p>
舞踏会には <var>N</var> 人の貴族が参加する予定である．<var>N</var> は奇数である．貴族には 1 から <var>N</var> までの番号が付けられている．それぞれの貴族には踊りのうまさという整数が定められており，貴族 <var>i</var> (1 &le; <var>i</var> &le; <var>N</var>) の踊りのうまさは <var>D<sub>i</sub></var> である．
</p>

<p>
舞踏会では JOI 姫を含む <var>N</var> + 1 人で 2 人ずつ組を作って踊る．IOI 王国では，上級者が初級者を補助できるように，伝統的に以下の方法で踊りの組を決定している．
</p>
<ul>
<li> 最初に，<var>N</var> 人の貴族が 1 列に並ぶ．</li>
<li> 列に並んでいる貴族が 1 人になるまで，以下の操作を繰り返す．<br>
- 列の先頭から 3 人の貴族の踊りのうまさを調べる．<br>
- その 3 人の貴族の中で，最も踊りのうまさが大きい貴族を A とおく．ただし，複数いる場合は，最も踊りのうまさが大きい貴族の中で，最も番号の小さい貴族 を A とおく．<br>
- その 3 人の貴族の中で，最も踊りのうまさが小さい貴族を B とおく．ただし，複数いる場合は，最も踊りのうまさが小さい貴族の中で，最も番号の大きい貴族 を B とおく．<br>
- A と B が列から抜けて組になる．<br>
- 残った 1 人は列の最後尾に移動する．</li>
<li> 最終的に残った 1 人が JOI 姫と組になる．</li>
</ul>

<p>
貴族 1 から貴族 <var>M</var> (1 &le; <var>M</var> &le; <var>N</var> − 2) の <var>M</var> 人の貴族については，すでに初期状態で列の何番目に並ぶのかが決まっている．残りの <var>N</var> − <var>M</var> 人の貴族の並び方は国王が自由に決めることができる．
</p>

<p>
JOI 姫は踊りを学んだばかりなので，国王は JOI 姫と組になる貴族の踊りのうまさをできるだけ大きくしたいと考えている．JOI 姫と組になる貴族の踊りのうまさとして考えられる最大値を求めよ．
</p>


<h3>課題</h3>
<p>
それぞれの貴族の踊りのうまさと，<var>M</var> 人の貴族の初期状態で並ぶ場所が与えられたとき，JOI 姫と組になる貴族の踊りのうまさとして考えられる最大値を求めるプログラムを作成せよ．
</p>

<h3>入力</h3>
<p>
標準入力から以下のデータを読み込め．
</p>
<ul>
<li> 1 行目には，2 個の整数 <var>N</var>, <var>M</var> が空白を区切りとして書かれている．これは舞踏会に貴族が <var>N</var> 人参加し，列に並ぶ場所がすでに決まっている貴族が <var>M</var> 人いることを表す．</li>
<li> 続く <var>M</var> 行のうちの <var>i</var> 行目 (1 &le; <var>i</var> &le; <var>M</var>) には，2 個の整数 <var>D<sub>i</sub></var>, <var>P<sub>i</sub></var> が空白を区切りとして書かれている．これは貴族 <var>i</var> の踊りのうまさが <var>D<sub>i</sub></var> で，貴族 <var>i</var> が初期状態で列の先頭から <var>P<sub>i</sub></var> 番目に並ぶことを表す．</li>
<li> 続く <var>N</var> − <var>M</var> 行のうちの <var>i</var> 行目 (1 &le; <var>i</var> &le; <var>N</var> − <var>M</var>) には，整数 <var>D<sub>i+M</sub></var> が書かれている．これは貴族 (<var>i</var> + <var>M</var>)の踊りのうまさが <var>D<sub>i+M</sub></var> であることを表す．
</li>
</ul>

<h3>出力</h3>
<p>
標準出力に，JOI 姫と組になる貴族の踊りのうまさとして考えられる最大値を表す整数を 1 行で出力せよ．
</p>

<h3>制限</h3>
<p>
すべての入力データは以下の条件を満たす．
</p>
<ul>
<li> 3 &le; <var>N</var> &le; 99 999．</li>
<li> <var>N</var> は奇数である．</li>
<li> 1 &le; <var>M</var> &le; <var>N</var> − 2．</li>
<li> 1 &le; <var>D<sub>i</sub></var> &le; 1 000 000 000 (1 &le; <var>i</var> &le; <var>N</var>)．</li>
<li> 1 &le; <var>P<sub>i</sub></var> &le; <var>N</var> (1 &le; <var>i</var> &le; <var>M</var>)．</li>
<li> <var>P<sub>i</sub></var> &ne; <var>P<sub>j</sub></var> (1 &le; <var>i</var> &lt; <var>j</var> &le; <var>M</var>)．</li>
</ul>


<h3>入出力例</h3>

<h3>入力例 1</h3>
<pre>
7 3
5 2
5 5
8 6
6
2
8
9
</pre>
<h3>出力例 1</h3>
<pre>
8
</pre>
<p>
初期状態では 3 人の貴族の並ぶ場所がすでに決まっている．
</p>

<center>
<img src="https://judgeapi.u-aizu.ac.jp/resources/images/IMAGE2_JOI2014_ball1"><br>
括弧内の数字は踊りのうまさを表す．左端が列の先頭である．
</center>
<br>
<p>
例えば，先頭から順に貴族 5，貴族 1，貴族 4，貴族 6，貴族 2，貴族 3，貴族 7 という順番に並んだ場
合を考える．
</p>

<center>
<img src="https://judgeapi.u-aizu.ac.jp/resources/images/IMAGE2_JOI2014_ball2"><br>
すべての貴族が並んだあとの配置
</center>
<br>
<p>
この場合，以下のように列が変化していく．
</p>
<ul>
<li> 列の先頭の 3 人の貴族 (貴族 5，貴族 1，貴族 4) 中で，最も踊りのうまさが大きい貴族 4 と最も踊りのうまさが小さい貴族 5 が組になり，残った貴族 1 が最後尾に移動する．</li>
<li> 次に，列の先頭の 3 人の貴族 (貴族 6，貴族 2，貴族 3) の中で，最も踊りのうまさが大きい貴族は貴族 6 と貴族 3 の 2 人であり，このうち番号の小さい貴族は貴族 3 である．また，列の先頭の 3 人の貴族のうち最も踊りのうまさが小さい貴族は貴族 2 である．貴族 3 と貴族 2 が組になり，残った貴族 6 が最後尾に移動する．</li>
<li> 次に，列の先頭の 3 人の貴族 (貴族 7，貴族 1，貴族 6) の中で，最も踊りのうまさが大きい貴族 7 と最も踊りのうまさが小さい貴族 1 が組になり，残った貴族 6 が最後尾に移動する．</li>
<li> 最終的に貴族 6 が残り，JOI 姫と組になる．貴族 6 の踊りのうまさは 8 である．この値が JOI 姫と組になる貴族の踊りのうまさとして考えられる最大値である．</li>
</ul>

<center>
<img src="https://judgeapi.u-aizu.ac.jp/resources/images/IMAGE2_JOI2014_ball3"><br>
列の変化の様子
</center>
<br>


<h3>入力例 2 </h3>
<pre>
3 1
5 3
5
5
</pre>
<h3>出力例 2</h3>
<pre>
5
</pre>
<p>
どのような順番で並んでも，貴族 2 と JOI 姫が組になる．
</p>
<h3>入力例 3</h3>
<pre>
7 2
32 4
27 6
37
41
41
30
27
</pre>
<h3> 出力例 3</h3>
<pre>
37
</pre>


<div class="source">
<p class="source">
問題文と自動審判に使われるデータは、<a href="http://www.ioi-jp.org">情報オリンピック日本委員会</a>が作成し公開している問題文と採点用テストデータです。
</p>
</div>
