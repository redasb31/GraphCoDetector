
<H1><font color="#000">Problem J:</font> Blue Forest</H1>

<p>
John is playing a famous console game named 'Tales of Algorithmers.' Now he is facing the last dungeon called 'Blue Forest.' To find out the fastest path to run through the very complicated dungeon, he tried to draw up the dungeon map.
</p>

<p>
The dungeon consists of several floors. Each floor can be described as a connected simple plane graph. Vertices of the graph are identified by X-Y coordinate, and the length of an edge is calculated by Euclidean distance. A vertex may be equipped with a one-way warp gate. If John chooses to use the gate, it brings John to another vertex in a possibly different floor. The distance between a warp gate and its destination is considered as 0.
</p>

<p>
One vertex has at most one warp gate, though some vertices might be the destination of multiple warp gates.
</p>

<p>
He believed he made one map for each floor, however after drawing maps of all the floors, he
noticed that he might have made a few mistakes. He might have drawn the same floor several times, and might have forgotten to mark some warp gates in the maps. However, he was sure he marked all warp gates at least once. So if the maps of same floor are unified to one map, all the warp gates must be described there. Luckily there are no floors which have the same shape
as the other floors, so if two (or more) maps can be unified, they must be the maps of the same floor. Also, there is no floor which is circular symmetric (e.g. a regular triangle and a square).
</p>

<p>
Map A and map B can be unified if map B can be transformed to map A using only rotation and parallel translation. Since some of the warp gates on maps might be missing, you should not consider the existence of warp gates when checking unification. If it is possible to unify map A and map B, a vertex on map A and the corresponding vertex on map B are considered as 'identical' vertices. In other words, you should treat warp gates on map B as those on map A where the warp gates are located on the corresponding vertices on map A. Destinations of warp gates should be treated similarly. After that you can forget map B. It is guaranteed that if both map A and map B have warp gates which are on the identical vertices, the destinations of them are also identical.
</p>

<p>
Remember, your task is to find the shortest path from the entrance to the exit of the dungeon, using the unified maps.
</p>

<H2>Input</H2>

<p>
The input consists of multiple datasets. Each dataset is in the following format.
</p>

<p>
<i>n</i><br>
<i>component</i><sub>1</sub></br>
<i>component</i><sub>2</sub></br>
...<br>
<i>component</i><sub><i>n</i></sub></br>
<i>sl sn</i><br>
<i>dl dn</i><br>
</p>

<p>
<i>n</i> is a positive integer indicating the number of maps. <i>component<sub>i</sub></i> describes the <i>i</i>-th map in the following format.
</p>

<p>
<i>A</i><br>
<i>x</i><sub>1</sub> <i>y</i><sub>1</sub><br>
<i>x</i><sub>2</sub> <i>y</i><sub>2</sub><br>
...<br>
<i>x</i><sub><i>A</i></sub> <i>y</i><sub><i>A</i></sub><br>
<i>B</i><br>
<i>s</i><sub>1</sub> <i>d</i><sub>1</sub><br>
<i>s</i><sub>2</sub> <i>d</i><sub>2</sub><br>
...<br>
<i>s</i><sub><i>B</i></sub> <i>d</i><sub><i>B</i></sub><br>
<i>C</i>
<i>sn</i><sub>1</sub> <i>dl</i><sub>1</sub> <i>dn</i><sub>1</sub><br>
<i>sn</i><sub>2</sub> <i>dl</i><sub>2</sub> <i>dn</i><sub>2</sub><br>
...<br>
<i>sn</i><sub><i>C</i></sub> <i>dl</i><sub><i>C</i></sub> <i>dn</i><sub><i>C</i></sub><br>
</p>

<p>
<i>A</i> denotes the number of vertices in the map. Each of the following <i>A</i> lines contains two integers
<i>x<sub>i</sub></i> and <i>y<sub>i</sub></i> representing the coordinates of the <i>i</i>-th vertex in the 2-dimensional plane. <i>B</i> denotes the number of the edges connecting the vertices in the map. Each of the following <i>B</i> lines contains two integers representing the start and the end vertex of each edge. Vertices on the same map are numbered from 1.
</p>

<p>
<i>C</i> denotes the number of warp gates. Each of the following <i>C</i> lines has three integers describing a warp gate. The first integer is the vertex where the warp gate is located. The second and the third integer are the indices of the map and the vertex representing the destination of the warp gate, respectively. Similarly to vertices, maps are also numbered from 1.
</p>

<p>
After the description of all maps, two lines follow. The rst line contains two integers <i>sl</i> and <i>dl</i> , meaning that the entrance of the dungeon is located in the <i>sl</i>-th map, at the vertex <i>dl</i>. The last line has two integers <i>sn</i> and <i>dn</i>, similarly describing the location of the exit.
</p>

<p>
The values in each dataset satisfy the following conditions:
</p>
<ul>
<li> 1 &le; <i>n</i> &le; 50,</li>
<li> 3 &le; <i>A</i> &le; 20,</li>
<li> <i>A</i> - 1 &le; <i>B</i> &le; <i>A</i>(<i>A</i> - 1)/2,</li>
<li> 0 &le; <i>C</i> &le; <i>A</i>, and</li>
<li> -10,000 &le; <i>x<sub>i</sub></i>, <i>y<sub>i</sub></i> &le; 10,000.</li>
</ul>


<H2>Output</H2>

<p>
For each dataset, print the distance of the shortest path from the entrance to the exit. The
output should not contain an absolute error greater than 10<sup>-1</sup>. If there is no route, print -1.
</p>

<H2>Sample Input</H2>
<pre>
2
5
0 0
10 0
20 0
30 0
30 10
4
1 2
2 3
3 4
4 5
2
1 2 4
3 2 2
5
-10 0
0 0
0 -10
0 -20
0 -30
4
1 2
2 3
3 4
4 5
1
4 1 3
1 1
2 1
4
3
4 3
0 0
5 0
2
1 2
2 3
0
3
0 0
3 4
0 5
2
1 2
1 3
1
2 3 4
4
0 13
0 0
13 0
13 13
4
1 2
1 4
2 3
2 4
0
4
5 12
0 0
-7 17
-12 5
4
1 2
2 3
2 4
4 3
0
1 1
4 1
4
3
0 0
2 0
0 4
2
1 2
1 3
0
3
0 0
-2 0
0 4
2
1 2
1 3
1
1 4 1
3
0 0
1 0
0 2
2
1 2
1 3
1
1 4 1
3
0 0
2 0
0 4
2
1 2
2 3
0
1 1
4 1
0
</pre>

<H2>Output for the Sample Input</H2>
<pre>
10.0000000000
41.3847763109
-1.000000000
</pre>
