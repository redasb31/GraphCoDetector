

<H1><font color="#000000">Problem 06:</font> Ghost Buster!</H1>

<p>
一般人には知る由も無いことだが、この街は幽霊で溢れている。そのほとんどは無害なのだが、困ったことに、人を呪う悪霊も少なからずいるのだ。
</p>

<p>
あるところに、そんな悪霊と戦う少女がいた。彼女は昼間は何食わぬ顔で高校に通いながらも、夜になると街中を歩き回り、彷徨える魂を見付けては成仏させるのだ。
</p>

<p>
幽霊を成仏させるためにはまずその幽霊に接近する必要があるのだが、それは簡単なことではない。幽霊は物をすり抜けられるからだ。幽霊は民家に壁から侵入して勝手口から出て行ったり、信号の無い大通りを悠々と横断したりする。人間である彼女にはそんなことはできないので、幽霊を追跡するのはとても難しいのだ。
</p>

<p>
彼女は経験上、幽霊が規則的な動きをすることを知っていた。そこで彼女は、この情報を活用して幽霊を追跡することを考えた。
</p>

<p>
彼女のいる街は、(<i>H</i> &times; <i>W</i>)マスのグリッドとして表される。彼女も幽霊も、1分間に1回、次の5つの行動
</p>

<ul>
<li>東へ1マス進む</li>
<li>西へ1マス進む</li>
<li>南へ1マス進む</li>
<li>北へ1マス進む</li>
<li>その場に留まる</li>
</ul>

<p>
のうちどれか1つを行うことができる。ただし、彼女は街の周囲に結界を張ったので、彼女も幽霊も街の外に出ることはできない。また、そのような行動をしようとした場合、代わりにその場に留まる。
</p>

<p>
それぞれのマスは '<span>#</span>' または '<span>.</span>' という文字によって表され、前者は幽霊だけが進入できるマスを、後者は両者が進入できるマスを表す。
</p>

<p>
幽霊の行動パターンは、L個の行動の列として与えられる。幽霊はこれらの行動を最初から順番に実行していき、全ての行動を実行し終わるとまた最初の行動に戻り、順に実行し続ける。
</p>

<p>
彼女と幽霊が N 分後に同じマスにいたならば、彼女と幽霊は時刻 N で遭遇したと言うことが出来る。幽霊は放っておくとどんな被害をもたらすか分からないので、彼女は出来るだけ早い時刻に幽霊を捕まえたい。なので、彼女は頼れる先輩であるあなたに、彼女と幽霊が遭遇できる最も早い時刻とその遭遇場所を求めるプログラムを書いてほしいと思っている。
</p>
<p>
さあ、彼女を助けて、彼女のありがたい言葉で彷徨える魂を極楽浄土へと導くのだ！
</p>

<H2>Input</H2>
<p>
複数のデータセットが与えられる。
各データセットの形式を以下に示す。
<br>

<p>
<i>H W</i> （グリッドの南北方向のマスの数、グリッドの東西方向のマスの数：　空白区切りの２つの整数）<br>
<i>H × W</i> の文字　（マスの種類：'<span>.</span>', '<span>#</span>', '<span>A</span>', または '<span>B</span>'）<br>
<i>pattern</i> （幽霊の行動パタン：文字列）<br>
</p>

<p>
'<span>A</span>' は少女の初期位置、'<span>B</span>' は幽霊の初期位置を示す。両者の初期位置は、 '<span>.</span>' のマスの上にある。
</p>

<p>
<i>pattern</i> は '<span>5</span>', '<span>2</span>', '<span>4</span>', '<span>6</span>', '<span>8</span>' から成る文字列で、各文字の意味は以下の通りである： 
</p>

<table border=1 cellspacing=4 cellpadding=4>
<tr><td>'<span>5</span>'</td><td>その場に留まる</td></tr>
<tr><td>'<span>8</span>'</td><td>北に1マス進む</td></tr>
<tr><td>'<span>6</span>'</td><td>東に1マス進む</td></tr>

<tr><td>'<span>4</span>'</td><td>西に1マス進む</td></tr>
<tr><td>'<span>2</span>'</td><td>南に1マス進む</td></tr>
</table>

<p>
例えば、<i>pattern</i> が "<span>8544</span>" の場合、幽霊は「北に1マス進む」「その場に留まる」「西に1マス進む」「西に1マス進む」の行動パタンを繰り返す。
</p>

<p>
<i>H</i>, <i>W</i> は 1 以上 20 以下であり、<i>pattern</i> の長さは 10 以下である。
</p>
<p>
<i>H</i>, <i>W</i> がともに 0 のとき、入力は終了する。 
</p>

<H2>Output</H2>
<p>
もし少女が幽霊と遭遇できるならば、最も早い遭遇時刻と、その遭遇場所の南北方向の座標、東西方向の座標を空白で区切って1行に出力せよ。グリッドの最北西を座標(0, 0)とし、最南東を座標(<i>H</i>-1, <i>W</i>-1) とする。</p>
<p>
どのように行動しても絶対に遭遇できない場合は、 "<span>impossible</span>" と出力せよ。 
</p>


<H2>Sample Input</H2>
<pre>
4 7
A#...#B
.#.#.#.
.#.#.#.
...#...
5
4 7
A#...#B
.#.#.#.
.#.#.#.
...#...
2
4 7
A#...#B
.#.#.#.
.#.#.#.
...#...
4
4 7
A#...#B
.#.#.#.
.#.#.#.
...#...
442668
1 10
A#.......B
55555554
1 10
A#.......B
55555555
0 0
</pre>


<H2>Output for the Sample Input</H2>
<pre>
18 0 6
15 3 6
6 0 0
14 0 4
72 0 0
impossible
</pre>
