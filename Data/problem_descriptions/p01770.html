


<h1 id="arojams-mask-ムジュラの仮面">E : Arojam&#39;s Mask / 仮面</h1>
<h2 id="問題文">問題文</h2>
<p>あなたは勇者である。勇者が旅をしている世界は <var>N</var> 個の街と、異なる街同士を結ぶ <var>M</var> 本の道からなる。道 <var>i</var> は街 <var>a_i</var> と街 <var>b_i</var> を結び、双方向に移動可能である。</p>
<p>街 <var>S</var> から出発し、街 <var>T</var> に移動することが勇者の目的である。 <var>S,T</var> は異なる街である。勇者は <var>0</var> 日目に街を出発し、ちょうど <var>1</var> 日かけて <var>1</var> 本の道を通って移動することができる。道を使った移動には日数の制限 <var>R</var> があり、<var>R</var> 日目を超えることはできない。</p>
<p>また、勇者は任意の街で「オカリナを吹く」こともできる。オカリナを吹くと、時は <var>0</var> 日目に、位置は街 <var>S</var> に戻される。つまり、<var>R</var> 回を超える移動を行う場合は、最低一度はオカリナを吹かなければならない。</p>
<p>さらに、勇者がある街に位置すると「イベント」が発生することがある。イベントは <var>E</var> 種類あり、<var>i</var> 番目のイベントは、街 <var>c_{i}</var> で発生する。イベントは勇者がそこにいると自動的に発生し、新たに道 <var>a’_i</var> と <var>b’_i</var> を結ぶ道が生じる。この道はオカリナを吹いても消えることはなく、初めから存在する道とも、別のイベントによって追加される道とも重複しない。ある町で起こるイベントは高々1つである。</p>
<p>さて、勇者の今日の仕事は、街 <var>T</var> に到達するまでに必要な移動の回数とオカリナを吹く回数の和の最小値を求めるプログラムを書くことである。</p>
<h2 id="入力">入力</h2>
<p>入力は以下の形式で与えられる。</p>
<pre><var>N</var> <var>M</var> <var>E</var> <var>S</var> <var>T</var> <var>R</var>
<var>a_{0}</var> <var>b_{0}</var>
<var>…</var>
<var>a_{M&minus;1}</var> <var>b_{M&minus;1}</var>
<var>a’_{0}</var> <var>b’_{0}</var> <var>c_{0}</var>
<var>…</var>
<var>a’_{E&minus;1}</var> <var>b’_{E&minus;1}</var> <var>c_{E&minus;1}</var>
</pre>

<h2 id="制約">制約</h2>
<ul>
<li>入力はすべて整数である</li>
<li><var>2 \&le; N \&le; 100</var></li>
<li><var>1 \&le; M+E \&le; N(N&minus;1)</var>/<var>2</var></li>
<li><var>0 \&le; E \&le; 4</var></li>
<li><var>0 \&le; R \&le; 100</var></li>
<li><var>0 \&le; S,T,a_i,b_i,a’_i,b’_i,c_i \&le; N&minus;1</var></li>
<li><var>S ≠ T</var></li>
<li><var>a_{i} ≠ b_{i}, a’_{i} ≠ b’_{i}</var></li>
<li><var>a_{i}</var> と <var>b_{i}</var>、<var>a’_{i}</var> と <var>b’_{i}</var>の全ての組は重複しない</li>
<li><var>i ≠ j</var> なら <var>c_{i} ≠ c_{j}</var></li>
</ul>
<h2 id="出力">出力</h2>
<p>答えを一行で出力せよ。どうしても <var>T</var> へ到達できない場合は <var>&minus;1</var> を出力せよ。</p>
<h2 id="サンプル">サンプル</h2>
<h3 id="サンプル入力1">サンプル入力1</h3>
<pre>8 5 2 0 5 5
0 1
0 3
0 6
1 2
6 7
3 4 7
4 5 2
</pre>

<h3 id="サンプル出力1">サンプル出力1</h3>
<pre>9
</pre>

<p>例えば以下のように移動すればよい。イベントを起こすまでは道(4,5), (3,4)は存在しないことに注意せよ。</p>
<ul>
<li>街2に行くと4から5へ移動できるようになる</li>
<li>オカリナを使用し0へ戻る</li>
<li>街7に行くと3から4へ移動できるようになる</li>
<li>オカリナを使用し0へ戻る</li>
<li>0から5へまっすぐ進む</li>
</ul>
<div class="figure">
<img src="https://judgeapi.u-aizu.ac.jp/resources/images/IMAGE2_RUPC2015_E1" />
</div>
<h3 id="サンプル入力2">サンプル入力2</h3>
<pre>7 5 1 0 6 8
0 1
1 2
2 3
3 4
4 5
3 6 5
</pre>

<h3 id="サンプル出力2">サンプル出力2</h3>
<pre>8
</pre>

<p>オカリナを1度も吹かない経路が最適である。</p>
<h3 id="サンプル入力3">サンプル入力3</h3>
<pre>4 1 4 1 2 3
3 1
3 2 0
0 1 3
0 3 1
0 2 2
</pre>

<h3 id="サンプル出力3">サンプル出力3</h3>
<pre>5
</pre>

<p>街 <var>S</var> でイベントが起こることもある。</p>