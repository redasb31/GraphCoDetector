
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html>
<body>
<h1> Lucky Dip</h1>
<p>
Time Limit: 8 sec / Memory Limit: 64 MB
</p>
<h2> C: 福袋</h2>
<p>
福袋，それは年始を祝う商習慣の一つである．
人気の福袋には多くの人が開店前から行列を作り，ターゲットの福袋へダッシュする．
この風物詩に魅了されたあなたは，今年もお目当ての福袋を狙い，計画を立てていた．
</p>
<p>
しかし，お客を呼び寄せる側の某百貨店の店長は頭を悩ませていた．
どうやらフロアの準備が開店に間に合いそうにない．
</p>
<p>
そこで店長はある一つのアイディアを思いついた．
それは開店後，店内を徐々に開放すればなんとか営業できるのではないかというものである．
</p>
<p>
あなたは刻一刻と変化する店内の情報を元に，お目当ての福袋がどの時間帯から入手できるのかを調べたい．
</p>
<h2> Input</h2>
<p>

入力は単一のデータセットで与えられ，EOFで終了する．<br/>

<br/>

店内の様子は各行が <i>W</i> 文字からなる <i>H</i> 行の文字列で表される．<br/>

<br/>

1 行目<br/>

</p>
<pre>
<i>W H</i>
2 &lt; <i>W</i>, <i>H</i> &lt;= 1000
</pre>
<p>
<br/>

続く <i>H</i> 行<br/>

</p>
<pre>
店内の様子
</pre>
<ul>
<li> .: 床</li>
<li> #: 壁</li>
<li> <i>t</i>: 目的の福袋</li>
</ul>
<p>

目的の福袋は店内に必ず1つだけ存在する．<br/>

<br/>

<i>H</i> + 2 行目<br/>

</p>
<pre>
営業時間 <i>N</i> (0 &lt;= <i>N</i> &lt;= 1000)
</pre>
<p>
<br/>

続く <i>N</i> 行<br/>

</p>
<pre>
<i>x<sub>1</sub></i> <i>y<sub>1</sub></i>
<i>x<sub>2</sub></i> <i>x<sub>2</sub></i>
...
<i>x<sub>i</sub></i> <i>y<sub>i</sub></i>
...
<i>x<sub>n</sub></i> <i>y<sub>n</sub></i>
</pre>
<p>

(<i>x<sub>i</sub></i>, <i>y<sub>i</sub></i>)は，<i>i</i> 時間目に開放される壁の座標を表す．(0 &lt;= <i>x<sub>i</sub></i> &lt; <i>W</i>, 0 &lt;= <i>y<sub>i</sub></i> &lt; <i>H</i>)<br/>

<i>x<sub>i</sub></i> が列，<i>y<sub>i</sub></i> が行である．<br/>

開放される壁の座標の位置が &quot;#&quot; なら &quot;.&quot; に置き換え，&quot;.&quot; なら何もしない．<br/>

目的の福袋が開放されることはない．
<br/>

(0, 0) が壁になることはない．<br/>

</p>
<p>
またあるマスからの移動は，上下左右の4方向のマスへのみが可能であり，壁の上へ移動することはできないものとする．
</p>
<h2> Output</h2>
<p>

左上(0, 0) から <i>t</i> の座標へ辿りつけるようになる時間 <i>s</i> (-1 &lt;= <i>s</i> &lt;= <i>N</i>)を1行で出力せよ．<br/>

壁を開放せずに辿りつける場合，0 を出力せよ．<br/>

営業時間が終了しても到達できなければ -1 を出力すること．<br/>

<br/>

</p>
<h2> Sample Input 1</h2>
<pre>
10 10
.....#....
.....#....
.....#....
######....
..........
####......
....###...
t..#..####
...##.....
....#...##
3
0 3
0 5
4 6
</pre>
<h2> Sample Output 1</h2>
<pre>
2
</pre>
<h2> Sample Input 2</h2>
<pre>
10 10
.....#....
.....#....
.....#....
##########
##########
##########
##########
t..#..####
...##.....
....#...##
3
0 3
0 5
4 6
</pre>
<h2> Sample Output 2</h2>
<pre>
-1
</pre>
</body>
</html>