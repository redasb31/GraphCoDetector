


<script type="text/x-mathjax-config">
  MathJax.Hub.Config({ tex2jax: { inlineMath: [["$","$"], ["\\(","\\)"]], processEscapes: true }});
</script>
<script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-MML-AM_CHTML">
</script>

<h2>鉄道運賃(Train Fare)</h2>

<p>
JOI 国には $N$ 個の都市があり，それぞれ $1, 2, ..., N$ の番号が付けられている．都市 1 はJOI 国の首都である．
</p>

<p>
また，JOI 国には鉄道会社がひとつだけあり，この会社は $M$ 個の路線を運行している．これらの路線にはそれぞれ $1, 2, ..., M$ の番号が付けられており，$i$ 番目 $(1 \leq i \leq M)$ の路線は都市 $U_i$ と都市 $V_i$ を双方向に結んでいる．都市と都市の間を鉄道以外で移動することはできない．また，どの都市からどの都市へもいくつかの路線を乗り継いで移動することができるようになっている．
</p>

<p>
現在，どの路線の運賃も 1 円である．経営不振に陥った鉄道会社は，今後 $Q$ 年間かけていくつかの路線の運賃を値上げする計画を立てた．この計画では，計画開始から $j$ 年目$(1 \leq j \leq Q)$ の年初めに路線 $R_j$ の運賃を 1 円から 2 円に値上げする予定である．値上げされた路線の運賃は，その後ずっと2 円のままであり，再び値上げすることはない．
</p>

<p>
ところで，この鉄道会社では，毎年，各都市の住民の満足度調査を行っている．計画開始前は，どの都市の住民もこの鉄道会社に満足しているが，値上げによって不満を持つ住民が現れる可能性がある．
</p>

<p>
それぞれの年の満足度調査は，その年の値上げの実施後に行う．したがって， $j$ 年目$(1 \leq j \leq Q)$ の満足度調査は，路線 $R_1, R_2, ... , R_j$ の運賃の値上げは完了し，それ以外の路線の運賃は値上げされていない状態で行われることになる． $j$ 年目$(1 \leq j \leq Q)$ の満足度調査では，都市 $k$ $(2 \leq k \leq N)$ の住民は，以下の条件が満たされるとき，そしてそのときに限り鉄道会社に不満を抱く．
</p>
<ul>
<li> その時の運賃で都市 $k$ から首都である都市 $1$ へ移動するときの費用の最小値が，計画開始前の運賃で都市 $k$ から都市 $1$ へ移動するときの費用の最小値よりも大きい．
</li>
</ul>

<p>
ただし，いくつかの路線を使って移動するときの費用は，それぞれの路線の運賃の合計である．また，都市 $1$ の住民が鉄道会社に対して不満を抱くことはない．値上げ後の運賃で最小の費用を達成する経路は，計画開始前の運賃で最小の費用を達成する経路と異なる可能性があることに注意せよ．
</p>

<p>
計画の実行に先立って，今後 $Q$ 年間の住民の満足度調査それぞれにおいて，鉄道会社に不満を抱く住民がいる都市の数を計算しておきたい．
</p>

<h2>課題</h2>
<p>
JOI 国の鉄道路線の情報と，運賃の値上げ計画が与えられたとき，それぞれの満足度調査において鉄道会社に不満を抱く住民がいる都市の数を求めるプログラムを作成せよ．
</p>

<h2>入力</h2>
<p>
標準入力から以下の入力を読み込め．
</p>
<ul>
<li> 1 行目には，3 個の整数 $N, M, Q$ が空白を区切りとして書かれている．これらは，JOI 国には $N$ 個の都市と $M$ 個の路線があり，運賃の値上げ計画が $Q$ 年間に渡ることを表している．</li>
<li> 続く $M$ 行のうちの $i$ 行目$(1 \leq i \leq M)$ には，2 個の整数 $U_i$, $V_i$ が空白を区切りとして書かれている．これらは，$i$ 番目の路線が都市 $U_i$ と都市 $V_i$ を結んでいることを表している．</li>
<li> 続く $Q$ 行のうちの $j$ 行目$(1 \leq j \leq Q)$ には，整数 $R_j$ が書かれている．これは，計画の $j$ 年目に路線 $R_j$ の運賃を値上げすることを表している．</li>
</ul>


<h2>出力</h2>
<p>
標準出力に $Q$ 行で出力せよ． $j$ 行目$(1 \leq j \leq Q)$ には， $j$ 年目の満足度調査で不満を抱く住民がいる都市の数を出力せよ．
</p>

<h2>制限</h2>
<p>
すべての入力データは以下の条件を満たす．
</p>
<ul>
<li> $2 \leq N \leq 100 000$ </li>
<li> $1 \leq Q \leq M \leq 200 000$ </li>
<li> $1 \leq U_i \leq N$ $(1 \leq i \leq M)$ </li>
<li> $1 \leq V_i \leq N$ $(1 \leq i \leq M)$ </li>
<li> $U_i \ne V_i$ $(1 \leq i \leq M)$ </li>
<li> $1 \leq R_j \leq M$ $(1 \leq j \leq Q)$ </li>
<li> $R_j \ne R_k$ $(1 \leq j < k \leq Q)$ </li>
<li> どの2 つの都市についても，それらを直接結ぶ路線は 1 個以下である． </li>
<li> どの都市についても，その都市から都市 1 までいくつかの路線を使って移動することができる． </li>
</ul>

<h2>入出力例</h2>

<h3>入力例1</h3>
<pre>
5 6 5
1 2
1 3
4 2
3 2
2 5
5 3
5
2
4
1
3
</pre>

<h3>出力例1</h3>
<pre>
0
2
2
4
4
</pre>

<p>
この入力例では，計画開始前，及びそれぞれの満足度調査の時点でのそれぞれの都市から都市 $1$ への運賃は，以下の表のようになる．
</p>

<table>
<tr><td>時点</td><td>都市2&nbsp;&nbsp;&nbsp;&nbsp;</td> <td>都市3&nbsp;&nbsp;&nbsp;&nbsp;</td> <td>都市4&nbsp;&nbsp;&nbsp;&nbsp;</td> <td>都市5&nbsp;&nbsp;&nbsp;&nbsp;</td></tr>
<tr><td>計画開始前 &nbsp;&nbsp;&nbsp;&nbsp;</td><td>1</td> <td>1</td><td> 2</td><td> 2</td></tr>
<tr><td>1 年目</td><td>1</td><td> 1</td><td> 2</td><td> 2</td></tr>
<tr><td>2 年目</td><td>1</td><td> 2</td><td> 2</td><td> 3</td></tr>
<tr><td>3 年目</td><td>1 </td><td>2 </td><td>2 </td><td>3</td></tr>
<tr><td>4 年目</td><td>2 </td><td>2 </td><td>3 </td><td>3</td></tr>
<tr><td>5 年目</td><td>2 </td><td>2 </td><td>4 </td><td>3</td></tr>
</table>
<br>


<p>
例えば，3 年目の満足度調査では，都市 $3$ と都市 $5$ の住民が不満を抱くので，出力の 3 行目には 2 を出力する．
</p>


<h3>入力例2</h3>
<pre>
4 6 6
1 2
1 3
1 4
2 3
2 4
3 4
1
4
2
5
3
6
</pre>

<h3>出力例2</h3>
<pre>
1
1
2
2
3
3
</pre>


<h3>入力例3</h3>
<pre>
2 1 1
1 2
1
</pre>

<h3>出力例3</h3>
<pre>
1
</pre>

<div class="source">
<p class="source">
<a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/"><img alt="クリエイティブ・コモンズ・ライセンス" style="border-width:0" src="https://i.creativecommons.org/l/by-sa/4.0/80x15.png"/></a>
</p>
<p class="source">
<a href="https://www.ioi-jp.org/joi/2015/2016-ho/2016-ho.pdf">第15回 日本情報オリンピック本選 課題 &nbsp; 2016 年 2 月 14 日</a>
</p>
</div>
