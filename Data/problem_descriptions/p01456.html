


<H1>Problem J: 問題文担当者は働かない！</H1>

<p>
<i>N</i> 個の点からなる有向グラフがある。このグラフに閉路はない。それぞれの点には、いくつかの石が置かれている。このグラフを使って、２人のプレイヤーがゲームをする。おのおのの手番は、交互に訪れる。各プレイヤーは、自分の手番において、頂点<i>v</i> を選び、そこに置かれた石を１つ以上取り除く。その後、<i>v</i> から<i>w</i> に辺が張られているすべての頂点<i>w</i> について、<i>w</i> に置かれている石の個数を自由に変化させることができる（いくつ増やしても、いくつ減らしても、変化させなくてもよい）。これを繰り返して、最初に取る石がなくなった方の負けである。両者が最善をつくしたとき、先手と後手、どちらが勝つか。もしくは、いつまでもゲームが終わらないか。
</p>

<p>
「……いや、無理でしょう、これ」<br>
「何が？」<br>
「何がじゃなくて！　これにどうやって自然な問題設定をつけろって言うんですか」<br>
「ははは。それを考えるのが君の仕事じゃないか。文章担当だろう？」<br>
「丸投げにもほどがありますよ……。まずゲームのルールが不自然すぎるでしょう」<br>
「そうかなぁ？　僕はよくある石取りゲームだと思うけどね」<br>
「プレイヤーの意思で石を無尽蔵に増やせる石取りゲームがよくあってたまりますか！」<br>
「お。君、今うまいこと言ったね」<br>
「ええ、意思で石を……ってどうでもいいわ！　そっちも少しは考えてくださいよ」<br>
「そうだねぇ。縊死した医師の遺志を継ぐ遺子の意思で石を取る、なんてどうだい？」<br>
「考えるのはそこじゃねぇよ！　石取りゲームの話だよ！」<br>
「違うのかい？　でも『取り』は鳥くらいしか同音異義語がなくて難しいんだよね」<br>
「いったん言葉遊びから離れろや！　自然な問題設定を考えてくれって言ってるんですよ！」<br>
「だからそれは君の仕事だろうに。僕はただの仲介役。原案担当と文章担当の間をとりもつだけさ」<br>
「くそ……。原案担当め、どうしてこんな厄介な問題を……」<br>
「原案担当者から君へのメッセージ。『フヒヒｗ　存分に苦しめ文章担当ｗｗ』だそうだよ」<br>
「畜生あの野郎！　いつか一発殴る！」<br>
「まあ、僕の『石が増える石取りゲームなんて実に設定がつけにくいと思わないかい？』ってアドバ
イスのおかげもあるだろうけどね」<br>
「畜生お前もか！　いつかと言わず今殴る！」<br>
「はっはっは。君が締め切りまでに文章担当としての役割を果たせないようなら、僕が勝手に問題文
を書いちゃうよ？」<br>
「殴……って、え？　お前が書いてくれんの？」<br>
「タイトルは『問題文担当者は働かない！』。本文には、僕たちのこの会話をそのまま掲載」<br>
「頼むからやめて！　そんなふざけた問題が自分名義で世に出たら、これから皆になんて言われる
か！」<br>
「はっはっは。締め切りも守れないような奴は、社会的に抹殺されて当然だよね」<br>
「畜生！　こうなったら、意地でも自然な問題設定を思いついてやらあああああ！」<br><br>
（※　結局そのまま掲載されました）<br>
</p>

<H2>Input</H2>

<p>
<i>N M</i><br>
<i>v</i><sub>1</sub><br>
<i>v</i><sub>2</sub><br>
.<br>
.<br>
.<br>
<i>v<sub>N</sub></i><br>
<i>a</i><sub>1</sub> <i>b</i><sub>1</sub></br>
<i>a</i><sub>2</sub> <i>b</i><sub>2</sub></br>
.<br>
.<br>
.<br>
<i>a<sub>M</sub> b<sub>M</sub></i><br>
</p>

<p>
入力の１行目には、整数<i>N</i>（2 &le; <i>N</i> &le; 1,000）と整数<i>M</i>（1 &le; <i>M</i> &le; 10,000）が、空白区切りで書かれている。これは、有向グラフがN 個の点と<i>M</i> 本の辺からなることをあらわす。頂点には、1 番から<i>N</i> 番までの番号がふられている。
</p>

<p>
続く<i>N</i> 行には、整数<i>v<sub>i</sub></i>（1 &le; <i>v<sub>i</sub></i> &le; 10,000）が書かれている。１＋ i 行目に書かれた整数<i>v<sub>i</sub></i> は、i 番の点に最初はvi 個の石が置かれていることをあらわす。
</p>

<p>
続く<i>M</i> 行には、整数<i>a<sub>i</sub></i>（1 &le; <i>a<sub>i</sub></i> &le; <i>N</i>）と整数<i>b<sub>i</sub></i>（1 &le; <i>b<sub>i</sub></i> &le; <i>N</i>）が、空白区切りで書かれている。１＋<i>N</i> ＋ i 行目に書かれた整数<i>a<sub>i</sub></i> と<i>b<sub>i</sub></i> は、<i>a<sub>i</sub></i> 番の点から<i>b<sub>i</sub></i> 番の点へ張られている辺が存在することをあらわす。ある点から自分自身へと張られる辺は存在せず、ある点A からある点B へ張られる辺は高々１本である。
</p>

<p>
与えられた有向グラフには閉路がないと仮定してよい。
</p>

<H2>Output</H2>

<p>
両プレイヤーが自身の勝利を目指して最善をつくしたとき、先手が勝つならば1 を、後手が勝つなら
ば2 を、いつまでもゲームが終わらないならば0 を出力せよ。
</p>


<h2>Sample Input 1 </h2>
<pre>
6 5
7
14
5
11
2
5
1 2
2 3
3 4
4 5
5 6
</pre>
<h2>Sample Output 1 </h2>
<pre>
2
</pre>
<h2>Sample Input 2 </h2>
<pre>
5 7
295
127
350
982
426
1 5
3 5
4 2
3 1
3 4
5 4
3 2
</pre>
<h2>Sample Output 2 </h2>
<pre>
1
</pre>
<h2>Sample Input 3 </h2>
<pre>
8 7
6
1
7
2
5
2
6
3
1 3
6 3
7 4
4 2
1 6
5 4
7 5
</pre>
<h2>Sample Output 3 </h2>
<pre>
2
</pre>