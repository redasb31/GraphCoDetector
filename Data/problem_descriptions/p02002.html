<h1>G: 式の切り取り</h1>

<h2>問題</h2>
<p>
  長さ $N$ の数式 $S$ が与えられる。
  数式は、以下の BNF で示される形式になっている。
</p>

<pre>
&lt;expr&gt; ::= &lt;number&gt; | &lt;expr&gt; &lt;op&gt; &lt;expr&gt; <br>
&lt;op&gt; ::= ‘^’ | ‘&’ | ‘|’ <br>
</pre>

<p>
  &lt;number&gt; は、 $0$ 以上 $2^{31}-1$ 以下の整数を表す。
</p>

<p>
  演算子、’^’  ‘&’  ‘|’  は、それぞれ排他的論理和、論理積、論理和を表す。
  演算子の優先順位は以下の通りである。
</p>

<p>
  高　’^’ > ‘&’ > ‘|’　低
</p>

<p>
  区間 $[i, j]$ が $Q$ 個与えられる。
  $S_i, \dots , S_j$ の計算結果を出力せよ。
</p>

<p>
  なお、数式 $S_i, \dots , S_j$ が上記のBNFで示される形式であることは保証される。また、数式にゼロ詰めされた値が含まれることはない。
</p>

<h2>制約</h2>
<ul>
  <li>$1 \leq N, Q \leq 10^5$</li>
  <li>$N = |S| \ \ \ \ \ |S|$ は文字列の長さを表す。</li>
  <li>$0 \leq i \leq j < N$</li>
			 </ul>

<h2>入力形式</h2>
<p> 入力は以下の形式で与えられる。 </p>

<p>
  $N$<br>
  $S$<br>
  $Q$<br>
  $i_1\ j_1$<br>
  $\vdots$<br>
  $i_Q\ j_Q$<br>
</p>

<h2>出力</h2>
<p>$S_i, \dots , S_j$ の計算結果を出力せよ。 また、末尾に改行も出力せよ。 </p>

<h2>サンプル</h2>

<h3>サンプル入力 1</h3>
<pre>
7
9^2&amp;1|2
4
0 6
0 2
2 6
4 4
</pre>
<h3>サンプル出力 1</h3>
<pre>
3
11
2
1
</pre>

<h3>サンプル入力 2</h3>
<pre>
13
3423&amp;423^1234
3
2 12
5 9
9 12
</pre>
<h3>サンプル出力 2</h3>
<pre>
21
422
1234
</pre>

<h3>サンプル入力 3</h3>
<pre>
7
1234567
3
0 0
0 1
4 6
</pre>
<h3>サンプル出力 3</h3>
<pre>
1
12
567
</pre>
