
<H1><font color="#000">Problem F:</font> Ninja Legend</H1>

<p>
Ninjas are professional spies in the Middle Age of Japan. They have been popular in movies and games
as they have been described with extraordinary physical abilities and unrealistic abilities.
</p>
<p>
You are absorbed in one of ninja games, <i>Ninja Legend</i>. In this game, you control in an exceptionally
talented ninja named <i>Master Ninja</i> and accomplish various missions. In one of the missions, the ninja
intrudes into a mansion and aims to steal as many gold pieces as possible. It is not easy to be done
because there are many pitfalls to evade him. Once he falls into a pitfall, all he can do will be just to wait
for being caught by the owner of this mansion. This definitely means failure of the mission. Thus, you
must control the ninja with a good strategy.
</p>
<p>
The inside of mansion is represented by a grid map as illustrated below. Master Ninja enters at and exits
from the entrance. He can move in the four directions to the floor cells. He can pick up gold blocks when
he moves to the cells where they are placed, but it is also allowed to pick up them in the later visit of
those cells or even to give up them.
</p>

<center>
<img src="https://judgeapi.u-aizu.ac.jp/resources/images/IMAGE1_ninja1">
<p>Figure 1: Example Map</p>
</center>

<p>
The ninja has a couple of special abilities for dealing with the pitfalls. He has two moving modes: <i>normal
mode and dash mode</i>. He is initially in the normal mode. He gets into the dash mode when he moves
in the same direction by two cells in a row without picking up gold blocks. He gets back to the normal
mode when he changes the direction, picks up a gold block, or runs on a wall as mentioned later. He is
able to jump over a pitfall, or in the dash mode he can jump over two pitfalls in his dashing direction. In
addition, when he is in the dash mode, he can <i>run on a wall</i> to pass over up to four pitfalls in his dashing
direction. For his running, there must be consecutive wall cells adjacent to the passing cells including
the departure and arrival floor cells. Note that he gets back to the normal mode when he runs on a wall
as mentioned previously.
</p>
<p>
In the figure below, the left one shows how the ninja runs on a wall, and the right one illustrates a case in
which he cannot skip over pitfalls by running on a wall.
</p>

<center>
<table cellpadding=8 cellspacing=8>
<tr>
<td><img src="https://judgeapi.u-aizu.ac.jp/resources/images/IMAGE1_ninja2"></td>
<td><img src="https://judgeapi.u-aizu.ac.jp/resources/images/IMAGE1_ninja3"></td>
</tr>
<tr>
<td><p>Figure 2: Running on a Wall</p></td>
<td><p>Figure 3: Non-consecutive Walls</p></td>
</tr>
</table>
</center>

<p>
You want to know the maximum number of gold blocks the ninja can get, and the minimum cost to get
those gold blocks. So you have decided to write a program for it as a programmer. Here, move of the
ninja from a cell to its adjacent cell is considered to take one unit of cost.
</p>


<H2>Input</H2>

<p>
The input consists of multiple datasets.
</p>
<p>
The first line of each dataset contains two integers <i>H</i> (3 &le; <i>H</i> &le; 60) and <i>W</i> (3 &le; <i>W</i> &le; 80). <i>H</i> and <i>W</i>
indicate the height and width of the mansion. The following <i>H</i> lines represent the map of the mansion.
Each of these lines consists of <i>W</i> characters. Each character is one of the following: ‘<span>%</span>’ (entrance), ‘<span>#</span>’
(wall), ‘<span>.</span>’ (floor), ‘<span>^</span>’ (pitfall), ‘<span>*</span>’ (floor with a gold block).
</p>
<p>
You can assume that the number of gold blocks are less than or equal to 15 and every map is surrounded
by wall cells.
</p>
<p>
The end of the input indicated with a line containing two zeros.
</p>

<H2>Output</H2>

<p>
For each dataset, output the maximum number of gold blocks and the minimum cost in one line. Output
two zeros instead if the ninja cannot get any gold blocks. No other characters should be contained in the
output.

</p>

<H2>Sample Input</H2>
<pre>
6 23
#######################
#%.^.^#################
#^^^^^######^^^^^^^^^^#
#^^^...^^^^...^^*^^..*#
#^^^^^^^^^^^^^^^^^^^^^#
#######################
5 16
################
#^^^^^^^^^^^^^^#
#*..^^^.%.^^..*#
#^^#####^^^^^^^#
################
0 0
</pre>

<H2>Output for the Sample Input</H2>
<pre>
1 44
2 28
</pre>

