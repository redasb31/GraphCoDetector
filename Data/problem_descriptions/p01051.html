


<h1>Squid Ink</h1>

<h2>Problem</h2>
<p>
近年、イカたちの間では縄張り争いが頻繁に起きている。複数のイカたちがチームを組み、自らのイカスミを武器に戦うのが近年のイカの戦闘スタイルである。
</p>

<p>
現在も縄張り争いが起こっており、その戦場は <var>R</var>&times;<var>C</var> のグリッドで表される。縄張り争いに参加しているイカのゲソ太はこのグリッド上のある場所にいる。この争いでは、重要な場所を敵よりも早く占拠することで戦況を有利にすることができる。そのため、ゲソ太は重要そうな場所を1つ決め、そこになるべく早く移動したいと考えている。
</p>

<p>
ゲソ太は隣接する上下左右のマスに移動することができる。グリッドの各マスには味方、または敵のイカスミが塗られている場合がある。なにも塗られていないマスに移動する場合、2秒かかるが、味方のイカスミが塗られているマスに移動する場合、その半分の時間(1秒)で済む。敵のイカスミが塗られているマスには移動することができない。壁があるマスや戦場の外へは当然移動することができない。
</p>

<p>
また、ゲソ太は上下左右のいずれかの方向を向き、イカスミを吐くことができる。すると、前方の3マスが味方のイカスミで上書きされる。ただし途中に壁がある場合はその手前までしかイカスミは届かない。この動作には2秒かかる。
</p>

<p>
戦場の情報とゲソ太の位置と目的の位置が与えられるので、最短で何秒で移動できるか求めてほしい。
</p>

<h2>Input</h2>
<p>
入力は以下の形式で与えられる。
</p>

<pre>
<var>R</var> <var>C</var>
<var>a<sub>1,1</sub></var> <var>a<sub>1,2</sub></var> ... <var>a<sub>1,C</sub></var>
<var>a<sub>2,1</sub></var> <var>a<sub>2,2</sub></var> ... <var>a<sub>2,C</sub></var>
:
<var>a<sub>R,1</sub></var> <var>a<sub>R,2</sub></var> ... <var>a<sub>R,C</sub></var>
</pre>

<p>
1行目に2つの整数<var>R</var>,<var>C</var>が空白区切りで与えられる。続く<var>R</var>行に戦場の情報として<var>C</var>個のマスの情報が与えられる。<var>a<sub>i,j</sub></var>は戦場の位置(<var>i</var>,<var>j</var>)のマスの情報を表し、以下のいずれかの文字である。
</p>

<ul>
<li>'.': なにも塗られていないマス</li>
<li>'#': 壁</li>
<li>'o': 味方のイカスミが塗られているマス</li>
<li>'x': 敵のイカスミが塗られているマス</li>
<li>'S': ゲソ太の位置(入力中に1つだけ存在し、マスはなにも塗られていない)</li>
<li>'G': 目的の位置(入力中に1つだけ存在し、マスはなにも塗られていない)</li>
</ul>

<p>
与えられる入力は、目的の位置まで移動することが可能であることが保証される。
</p>

<h2>Constraints</h2>

<ul>
<li>2 &le; <var>R</var>,<var>C</var> &le; 30</li>
</ul>

<h2>Output</h2>
<p>
ゲソ太が目的の位置まで移動するのにかかる最短の秒数を1行に出力せよ。
</p>

<h2>Sample Input 1</h2>
<pre>
5 5
S....
.....
.....
.....
....G
</pre>

<h2>Sample Output 1</h2>
<pre>
14
</pre>

<h2>Sample Input 2</h2>
<pre>
5 5
Sxxxx
xxxxx
xxxxx
xxxxx
xxxxG
</pre>

<h2>Sample Output 2</h2>
<pre>
15
</pre>

<h2>Sample Input 3</h2>
<pre>
4 5
S#...
.#.#.
.#.#.
...#G
</pre>
<h2>Sample Output 3</h2>
<pre>
23
</pre>

<h2>Sample Input 4</h2>
<pre>
4 5
S#ooo
o#o#o
o#o#o
ooo#G
</pre>

<h2>Sample Output 4</h2>
<pre>
14
</pre>

<h2>Sample Input 5</h2>
<pre>
4 5
G####
ooxoo
##x#o
Soooo
</pre>

<h2>Sample Output 5</h2>
<pre>
10
</pre>
