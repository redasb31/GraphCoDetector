


<link rel="stylesheet" href="css/description.css" type="text/css" />
<script language="JavaScript" type="text/javascript" src="js/varmath.js" charset="UTF-8"></script>


<h2>E: 鬼畜ババ抜き - Unbalanced Old Maid -</h2>

<h3>物語</h3>
<p>高坂さんと園田さんと南さんは子供の頃からの仲良し3人組だ。3人は沖縄に修学旅行に行くも、台風が来てしまい、海で遊ぶことができないのでババ抜きをすることにした。</p>

<p>
園田さんは勝負事には強いが、ポーカーフェイスが苦手なため、自分のカードが引かれるときに無意識にかわいらしい顔芸を披露してしまう。園田さんを愛して止まない高坂さんと南さんは、園田さんの顔芸を見るだけで園田さんの手札が分かってしまうため、園田さんのカードを引くときは、自分が有利になるように引くことができる。
一方、高坂さんと南さんは特に顔芸をしたりはしないので、手札がばれることはない。 よって、高坂さんと南さんのカードを引く人はそれぞれ、高坂さんと南さんが持っているカードの中から等確率で1枚引く。
</p>

<p>どう考えても不利な園田さんは、ババ抜きでなかなか勝てないことに違和感を覚えている。 使用するカードの種類数<var>n</var>と初期の手札が与えられたとき、園田さんが負けとならない確率を求めてあげよう。</p>

<h3>問題文</h3>
<p>高坂さん、園田さん、南さんの3人は、以下の状況でババ抜きを行う。</p>
<ul>
<li>使用するカードは、1から<var>n</var>までの整数が書かれた<var>n</var>種類のカードそれぞれ4枚ずつとジョーカー1枚の合計<var>4n+1</var>枚である。</li>
<li>最初の手札が与えられたとき、3人はそれぞれ自分の手札に同一の整数が書かれたカードのペア（2枚組）があるならば、そのようなペアを全て捨てる。</li>
<li>3人は「高坂さんが南さんの手札からカードを引く」、「園田さんが高坂さんの手札からカードを引く」「南さんが園田さんの手札からカードを引く」という順番（ターン）で以下の操作を繰り返す。（このババ抜きでは、カードを引いた人が、次に引かれるというルールであることに注意せよ。）</li>
<ol>
<li>一人がジョーカーのみを持ち、その人以外の2人の手札が空のとき、ババ抜きは終了し、ジョーカーを持っている人が負けとなる。</li>
<li>カードを引く順番の人の手札が空のとき、ターンを次の人とし、1.に戻る。</li>
<li>そうでなければ、カードを引く順番の人は決められた相手からカードを1枚引く。ただし、相手の手札が空のとき、まだ残っているもう1人からカードを引く。</li>
<li>引いたカードと同じ整数が書かれたカードがカードを引いた人の手札にあれば、その2枚を捨てる。</li>
<li>ターンを次の人とし、1.へ戻る。</li>
</ol>
<li>ただし、園田さんのカードを引く人（南さんか高坂さん）は、以下の戦略でカード引く。</li>
<ol>
<li>もし自分のカードと園田さんのカードで同じ整数が書かれたカードがあれば、それらのうち最小の整数が書かれたカードを引く</li>
<li>そうでないとき、園田さんがジョーカーでないカードを持っていれば、それらのうち最小の整数が書かれたカードを引く</li>
<li>そうでないなら、園田さんはジョーカーしか持っていないので、ジョーカーを引く</li>
</ol>
<li>高坂さんと南さんのカードを引く人は、それぞれ高坂さんと南さんが持っているカードの中から等確率で1枚引く。</li>
</ul>

<p>使用するカードの種類数<var>n</var>と3人の初期の手札が与えられたとき、園田さんが負けとならない確率を求めてあげよう。</p>


<h3>入力形式</h3>
<p>入力は4行からなり、以下の形式で与えられる。</p>
<pre>
<var>n</var>
<var>m_1</var> <var>c_{1,1}</var> ... <var>c_{1,m_1}</var>
<var>m_2</var> <var>c_{2,1}</var> ... <var>c_{2,m_2}</var>
<var>m_3</var> <var>c_{3,1}</var> ... <var>c_{3,m_3}</var>
</pre>

<p>
1行目にジョーカー以外のカードの種類数<var>n</var>が与えられる。 
続く入力は3行からなり、2行目に高坂さんの手札、3行目に園田さんの手札、4行目に南さんの手札の情報が与えられる。
<var>i+1 (1 &le; i &le; 3)</var>行目では行頭に手持ちの枚数<var>m_i</var>、続けて手持ちのカードを表す<var>m_i</var>個の整数<var>c_{i,j} (1 &le; j &le; m_i)</var>が空白区切りで与えられる。 <var>0</var>はジョーカー、<var>1</var>から<var>n</var>はカードに書かれた整数を表す。
</p>

<h3>制約</h3>
<ul>
<li><var>1 &le; n &le; 100</var></li>
<li><var>m_1+m_2+m_3 = 4n+1</var></li>
<li>3人の手札で0はちょうど1つ、<var>1</var>から<var>n</var>はちょうど4回ずつ現れる</li>
<li><var>0 &le; c_{i,j} &le; n</var> (<var>1 &le; i &le; 3</var>, <var>1 &le; j &le; m_i</var>)</li>
</ul>

<h3>出力形式</h3>
<p>園田さんが負けとならない確率を1行に出力せよ。答えには<var>10^{&minus;6}</var>を超える絶対誤差があってはならない。</p>

<h3>入力例1</h3>
<pre>
1
1 1
3 0 1 1
1 1
</pre>

<h3>出力例1</h3>
<pre>0.0</pre>
<p>
高坂さんが南さんのカード1を引き、高坂さんと南さんは手札が空になる。
園田さんはどうしても勝つことはできない。
</p>

<h3>入力例2</h3>
<pre>
1
2 1 1
1 1
2 0 1
</pre>

<h3>出力例2</h3>
<pre>0.5</pre>

<p>はじめの高坂さんのターンは、高坂さんの手札が既に空なので何もしない。次の園田さんのターンでは、園田さんは南さんの手札のうちそれぞれ0.5の確率でカード1かジョーカーを引く。カード1を引いたとき、園田さんの手札は空となり勝利する。一方ジョーカーを引いたときは、次の南さんのターンで、南さんは確実にカード1を引くので園田さんが負けとなる。</p>

<h3>入力例3</h3>
<pre>
2
3 0 1 2
3 1 2 2
3 1 1 2
</pre>

<h3>出力例3</h3>
<pre>0.5</pre>

<h3>入力例4</h3>
<pre>
2
2 0 1
6 2 2 2 1 1 1
1 2
</pre>

<h3>出力例4</h3>
<pre>0.6666666667</pre>