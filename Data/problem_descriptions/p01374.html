

<!-- begin en only -->
<!--<h3><U>Sakura Poetry</U></h3>-->
<!-- end en only -->
<!-- begin ja only -->
<h3><U>桜詩  願はくは花の下にて春死なむ </U></h3>
<!-- end ja only -->


<div>
<!-- begin en only -->
<p>
English text is not available in this practice contest.
</p>
<!-- end en only -->
<!-- begin ja only -->
<p>
Nathan O. Davis は集積回路コースの学生である．
</p>
<p>
Nathan は足りない単位を補充するために，日本文化に関する授業を履修している．今日の課題は詩の作成である．
</p>
<p>
Nathan は勉強不足で日本語が不得手なため，プログラムに詩を自動生成させようと考えた．手始めに彼は，日本語の単語の接続辞書を入手した．
あとは単語の接続にしたがってランダムな文章を生成するだけである．
</p>
<p>
しかしながら，ランダムに生成された全ての文字列が詩として認められるわけではない．
詩には，いくつかの季語のうち1つが，一度だけ現れていなければならない．ある季語が2回以上出現することや，2種類以上の季語が1回ずつ出現することは許されない．
また，季語は単語の接続の境界をまたいで出現してもよい．
</p>
<p>
あなたの仕事は，入力で与えられた単語の接続辞書と季語のリストから，指定された長さの詩が何通りに作られるかを求めるプログラムを作成することである．
違う単語を繋げて詩となる同じ文字列が得られた場合，それらは重複して数え上げるものとする．答えは非常に大きくなりうるので， 1,000,000,007 で割った余りを出力せよ．</p>
</p>
<!-- end ja only -->
</div>

<h3>Input</h3>

<div>
<!-- begin ja only -->
<p>
入力は複数のテストケースを含んでいる．1つのテストケースは，以下の形式で与えられる．
</p>
<blockquote>
<i>N</i> <i>M</i> <i>K</i><br/>
<i>from<sub>1</sub></i> <i>to<sub>1</sub></i><br/>
<i>from<sub>2</sub></i> <i>to<sub>2</sub></i><br/>
:<br/>
</i>from<sub>N</sub></i> <i>to<sub>N</sub></i><br/>
<i>seasonword<sub>1</sub></i><br/>
<i>seasonword<sub>2</sub></i><br/>
:<br/>
<i>seasonword<sub>K</sub></i>
</blockquote>
<p>
入力の最初の行には3つの整数 <i>N</i> (1 &le; <i>N</i> &le; 250), <i>M</i> (1 &le; <i>M</i> &le; 500), <i>K</i> (1 &le; <i>K</i> &le; 30) が含まれ，それぞれ単語の接続辞書の大きさ，作成すべき詩の長さ，季語の数を表す．
</p>
続く <i>N</i> 行は単語の接続辞書の情報を表す．
各行は2つの文字列 <i>from<sub>i</sub></i> , <i>to<sub>i</sub></i> を含み，単語 <i>from<sub>i</sub></i> の後に続けて単語 <i>to<sub>i</sub></i> が出現してもよいということを表す．
<i>to<sub>i</sub></i> の後に続けて <i>from<sub>i</sub></i> が出現してもよいということを表すものではないことに注意せよ．また，<i>from<sub>i</sub></i> で終わるような他の文字列の後に続けて <i>to<sub>i</sub></i> が出現してもよいということを表すものでもない．詩は，接続辞書に含まれるどの単語から始めてもよい．

続く <i>K</i> 行は1つの文字列 <i>seasonword<sub>i</sub></i> からなり，それぞれ季語を表す．

入力中に現れる文字列は全て小文字のアルファベットからなり，その長さは 1 以上 20 以下である．

接続辞書の各項目，および季語は互いに異なる．
すなわち， <i>i</i> &ne; <i>j</i> に対して <i>from<sub>i</sub></i> &ne; <i>from<sub>j</sub></i> または <i>to<sub>i</sub></i> &ne; <i>to<sub>j</sub></i> が成り立つ．
同様に，<i>i</i> &ne; <i>j</i> に対して <i>seasonword<sub>i</sub></i> &ne; <i>seasonword<sub>j</sub></i> が成り立つ．

入力の末尾には，入力の終了を表す 3 つの 0 がある．
</p>
<!-- end ja only -->
</div>

<h3>Output</h3>
<div>
<!-- begin ja only -->
<p>
生成される異なる詩の数を 1,000,000,007 で割った余りを1行に出力せよ．
先に言及したように，違う単語を繋げて詩となる同じ文字列が得られた場合，それらは重複して数え上げるものとする．
厳密に言えば，2つの詩 <i>s</i>, <i>t</i> があり，それぞれ単語の列 [<i>a<sub>1</sub></i> , <i>a<sub>2</sub></i> , ..., <i>a<sub>n</sub></i> ], [<i>b<sub>1</sub></i> , <i>b<sub>2</sub></i> , ..., <i>b<sub>m</sub></i> ] を順に連結して得られたものであるとき，
<i>n</i> = <i>m</i> かつすべての 1 &le; <i>i</i> &le; <i>n</i> に対して <i>a<sub>i</sub></i> = <i>b<sub>i</sub></i> であるとき，またそのときに限って，2つの詩 <i>s</i>, <i>t</i> は同一の詩とみなされる．
</p>
<!-- end ja only -->
</div>

<h3>Sample Input</h3>
<div>
<pre>
4 64 2
negawakuha hananoshitanite
hananoshitanite harushinan
harushinan sonokisaragino
sonokisaragino mochizukinokoro
sakura
hana
2 15 2
naha naha
naha gachoon
sakura
hana
3 7 2
asakur a
a sakura
asa kura
sakura
hana
9 100 2
a a
a h
a n
h a
h h
h n
n a
n h
n n
sakura
hana
4 2 2
a a
a b
b a
b b
ab
b
4 7 4
i cpc
mi cp
ac mi
cp c
ac
wa
tle
re
0 0 0
</pre>
</div>

<h3>Output for the Sample Input</h3>
<div>
<pre>
1
1
3
715991824
1
1
</pre>
</div>