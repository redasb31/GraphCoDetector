

<h1><font color="#000">Problem A:</font> Luck Manipulator</h1>

<p>
Nathan O. Davis くんは，あるゲームを攻略中であり，非常にレアなアイテムを手に入れようと四苦八苦していた．このレアなアイテムは，カジノのスロットマシーンで特殊な絵柄を一列に揃えたときに手に入れることができる．スロットマシーンには <i>N</i> 個のリールがあり，ボタンを一回押すと現在回転している最も左側のリールが停止する．そのため，このレアアイテムを手に入れるためには <i>N</i> 回ボタンを押す必要がある．また，特殊な絵柄で停止させるためにはあるタイミングでボタンを押す必要がある．ところが，このボタンを押すタイミングは非常にシビアであるため，なかなか上手くいかずに困っていた．そこで，Nathan くんはメモリビューアを利用して，ゲーム中におけるメモリの値を確認しながらゲームを解析することにした．
</p>

<p>
Nathan くんの解析の結果，その特殊な絵柄でリールを停止させるためには，ボタンが押された時に，メモリの 007E0D1F 番地に書き込まれた「乱数」が特定の値になっている必要があることを突き止めた．乱数の値は 1 フレーム毎に線形合同法によって変化しており，またボタンが押されたかどうかの判定は 1 フレーム毎に 1 回行われていることも分かった．ここで，線形合同法とは擬似乱数を生成するための方法の一つであり，以下の式によって値を決定する．
</p>

<p>
<i>x'</i> = (<i>A</i> &times; <i>x</i> + <i>B</i>) mod <i>C</i>
</p>

<p>
ここで，<i>x</i> は現在の乱数の値，<i>x'</i> は次の乱数の値，<i>A</i>, <i>B</i>, <i>C</i> は何らかの定数である．また，<i>y</i> mod <i>z</i> は <i>y</i> を <i>z</i> で割ったときの余りを表す．
</p>

<p>
例えば，2 個のリールを持つスロットマシーンで <i>A</i> = 5，<i>B</i> = 7，<i>C</i> = 11 で，最初の「乱数」の値が 10 であったとする．そして，特殊な絵柄でリールを止めるための条件は，左側のリールが 2，右側のリールが 4 であったとする．このとき，1 フレーム目における乱数の値は (5 &times; 10 + 7) mod 11 = 2 であるため，1 フレーム目にボタンを押せば左側のリールは特殊な絵柄で停止する．続く 2 フレーム目での乱数の値は (5 &times; 2 + 7) mod 11 = 6 であるから，2 フレーム目にボタンを押しても右側のリールは特殊な絵柄では停止しない．続く 3 フレーム目では乱数の値が (5 &times; 6 + 7 ) mod 11 = 4 になるので，3 フレーム目にボタンを押せば右側のリールは特殊な絵柄で停止する．よって，最短 3 フレームで全てのリールを特殊な絵柄で停止されることができ，レアなアイテムを手に入れることができる．
</p>

<p>
あなたの仕事は，最短で何フレーム目に全てのリールを特殊な絵柄で停止させることができるかを求めるプログラムを書いて，Nathan くんがレアなアイテムを手に入れられるよう助けてあげることである．
</p>

<h3>Input</h3>

<p>
入力は複数のデータセットからなる．各データセットは次の形式で与えられる．
</p>

<blockquote>
<i>N</i> <i>A</i> <i>B</i> <i>C</i> <i>X</i><br>
<i>Y</i><sub>1</sub> <i>Y</i><sub>2</sub> ... <i>Y</i><sub>N</sub>
</blockquote>

<p>
最初の行には 5 つの整数 <i>N</i> (1 &le; <i>N</i> &le; 100) ，<i>A</i>, <i>B</i> (0 &le; <i>A</i>, <i>B</i> &le; 10,000)，<i>C</i> (1 &le; <i>C</i> &le; 10,000) ，<i>X</i> (0 &le; <i>X</i> &lt; <i>C</i>) がそれぞれ 1 つの空白文字で区切られて与えられる．ここで，<i>X</i> は最初の乱数の値を表す．続く行では，<i>N</i> 個の整数 <i>Y</i><sub>1</sub>, <i>Y</i><sub>2</sub>, ... , <i>Y</i><sub><i>N</i></sub> (0 &le; <i>Y</i><sub><i>i</i></sub> &le; 10,000) が 1 つの空白文字で区切られて与えられる．これらは，リールを特定の絵柄で止めるための条件を表しており，その第 <i>i</i> 番目の数 <i>Y</i><sub><i>i</i></sub> は，左から <i>i</i> 番目のリールを特殊な絵柄で停止するためには，乱数の値が <i>Y</i><sub><i>i</I></sub> である必要がある，いう意味である．
</p>

<p>
入力の終わりは，空白で区切られた 5 つの 0 を含む 1 行で示される．
</p>

<h3>Output</h3>

<p>
各データセットについて，特殊な絵柄で停止させるために必要となる最短のフレーム数を 1 行に出力せよ．なお，10,000 フレーム以内に停止させることができない場合は，フレーム数の代わりに -1 を出力せよ．出力に余計な空白や改行を含めてはならない．
</p>

<h3>Sample Input</h3>

<pre>
1 5 7 11 10
10
2 5 7 11 10
2 4
2 1 1 256 0
128 255
2 0 0 1 0
1234 5678
2 1 1 100 0
99 98
2 1 1 100 0
99 99
2 1 1 10000 0
1 0
2 1 1 10000 0
2 1
0 0 0 0 0
</pre>

<h3>Output for the Sample Input</h3>

<pre>
0
3
255
-1
198
199
10000
-1
</pre>

